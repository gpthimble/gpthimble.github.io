<!DOCTYPE html>
<html class="has-navbar-fixed-top">
<head>
    <meta charset="utf-8">
<title>Thimble&#39;s Blog</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">


<link href="/en/index.html" rel="alternate" hreflang="en" />
    


<meta name="description" content="">





    <meta property="og:type" content="website">
<meta property="og:title" content="Thimble&#39;s Blog">
<meta property="og:url" content="https://gpthimble.github.io/index.html">
<meta property="og:site_name" content="Thimble&#39;s Blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Thimble">
<meta name="twitter:card" content="summary">





<link rel="icon" href="/favicon.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/css/justifiedGallery.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">


<link rel="stylesheet" href="/css/style.css">


<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script>


    
    
    
    
    
    
    
    
    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=253383822"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', '253383822');
</script>


    


<meta name="generator" content="Hexo 5.2.0"></head>
<body>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/">
                
                    
                    Thimble&#39;s blog
                    
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item "
               href="/archives">归档</a>
            
            <a class="navbar-item "
               href="/categories">分类</a>
            
            <a class="navbar-item "
               href="/tags">标签</a>
            
            <a class="navbar-item "
               href="/about">关于</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            <a class="navbar-item search" title="Search" href="javascript:;">
                <i class="fas fa-search"></i>
            </a>
            
            
            
            <a class="navbar-item" title="GitHub" target="_blank" rel="noopener" href="https://gpthimble.github.com">
                
                <i class="fab fa-github"></i>
                
            </a>
               
            
        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
    
        <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/%E7%BB%84%E7%9B%B8%E8%81%94cache%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/" itemprop="url">组相联cache设计、实现与测试</a>
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            
                <time datetime="2020-11-17T07:52:44.000Z" itemprop="datePublished">11月 17 2020</time>
            
        </span>
        
        
        <span class="column is-narrow">
            
            
            1 小时 read (About 8233 words)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <p>&#x6211;&#x5728;&#x4E0A;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x4E2D;&#xFF0C;&#x63CF;&#x8FF0;&#x4E86;&#x6211;&#x5728;&#x8BBE;&#x8BA1;cache&#x8FC7;&#x7A0B;&#x4E2D;&#x9047;&#x5230;&#x7684;&#x56F0;&#x96BE;&#x4EE5;&#x53CA;&#x4EA7;&#x751F;&#x7684;&#x60F3;&#x6CD5;&#xFF0C;&#x63D0;&#x5230;&#x4E86;fpga&#x7247;&#x4E0A;&#x7684;RAM&#x9690;&#x542B;&#x7684;&#x5BC4;&#x5B58;&#x5668;&#x5F15;&#x8D77;&#x7684;&#x8BBE;&#x8BA1;&#x56F0;&#x96BE;&#xFF0C;cache&#x540C;&#x6B65;&#x7684;&#x95EE;&#x9898;&#x4EE5;&#x53CA;&#x672C;&#x5E73;&#x53F0;&#x76EE;&#x524D;&#x5BF9;cache&#x540C;&#x6B65;&#x673A;&#x5236;&#x7684;&#x76EE;&#x6807;&#x3002;&#x7ECF;&#x8FC7;&#x534A;&#x4E2A;&#x6708;&#x7684;&#x8BBE;&#x8BA1;&#x4E0E;&#x6D4B;&#x8BD5;&#xFF0C;&#x672C;&#x7CFB;&#x7EDF;&#x4E2D;&#x5C06;&#x8981;&#x4F7F;&#x7528;&#x7684;&#x4E24;&#x8DEF;&#x7EC4;&#x76F8;&#x8054;cache&#xFF08;2-way set associative cache&#xFF09;&#x8BBE;&#x8BA1;&#x5B8C;&#x6BD5;&#x5E76;&#x901A;&#x8FC7;&#x6D4B;&#x8BD5;&#x3002;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x4E3B;&#x8981;&#x4ECB;&#x7ECD;&#x6211;&#x7684;&#x8BBE;&#x8BA1;&#x5B9E;&#x73B0;&#x548C;&#x6D4B;&#x8BD5;&#x8FC7;&#x7A0B;&#xFF0C;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x6211;&#x6240;&#x5199;&#x7684;&#x4EE3;&#x7801;&#x7684;&#x6587;&#x6863;&#x4F7F;&#x7528;&#x3002;</p>
<h2 id="cache-&#x8BBE;&#x8BA1;&#x76EE;&#x6807;"><a href="#cache-&#x8BBE;&#x8BA1;&#x76EE;&#x6807;" class="headerlink" title="cache &#x8BBE;&#x8BA1;&#x76EE;&#x6807;"></a>cache &#x8BBE;&#x8BA1;&#x76EE;&#x6807;</h2><ul>
<li>&#x53EA;&#x9700;&#x4E00;&#x4E2A;&#x65F6;&#x949F;&#x5468;&#x671F;&#x5373;&#x53EF;&#x8BA1;&#x7B97;&#x51FA;&#x662F;&#x5426;cache&#x547D;&#x4E2D;&#xFF0C;&#x547D;&#x4E2D;&#x540E;&#x7ACB;&#x523B;&#x901A;&#x77E5;CPU</li>
<li>2&#x8DEF;&#x7EC4;&#x76F8;&#x8054;&#x8BBE;&#x8BA1;</li>
<li>cache&#x5199;&#x7B56;&#x7565;&#x4E3A;&#x5199;&#x900F;&#xFF08;&#x6BCF;&#x5F53;&#x6709;&#x5199;&#x8BF7;&#x6C42;&#xFF0C;&#x540C;&#x65F6;&#x5199;&#x5165;cache&#x548C;&#x5185;&#x5B58;&#xFF09;</li>
<li>cache&#x66FF;&#x6362;&#x7B56;&#x7565;&#x4E3A;&#x968F;&#x673A;&#x66FF;&#x6362;</li>
<li>&#x5141;&#x8BB8;&#x901A;&#x8FC7;&#x6539;&#x5199;&#x53C2;&#x6570;&#x81EA;&#x5B9A;&#x4E49;&#x65E0;&#x9700;&#x7F13;&#x5B58;&#x7684;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#x4F9B;IO&#x548C;DMA&#x8BBE;&#x5907;&#x4F7F;&#x7528;</li>
<li>&#x5141;&#x8BB8;&#x901A;&#x8FC7;&#x6539;&#x5199;&#x53C2;&#x6570;&#x6539;&#x53D8;cache&#x7684;&#x89C4;&#x6A21;</li>
<li>&#x6307;&#x4EE4;&#x548C;&#x6570;&#x636E;cache&#x90FD;&#x662F;&#x672C;&#x6A21;&#x5757;&#x7684;&#x5B9E;&#x4F8B;</li>
<li>&#x591A;&#x4E2A;cache&#x5B9E;&#x4F8B;&#x53EF;&#x4EE5;&#x540C;&#x65F6;&#x8BBF;&#x95EE;&#x7CFB;&#x7EDF;&#x603B;&#x7EBF;</li>
</ul>
<h2 id="&#x7EC4;&#x76F8;&#x8054;cache&#x7684;&#x8BBE;&#x8BA1;&#x4E0E;&#x5B9E;&#x73B0;"><a href="#&#x7EC4;&#x76F8;&#x8054;cache&#x7684;&#x8BBE;&#x8BA1;&#x4E0E;&#x5B9E;&#x73B0;" class="headerlink" title="&#x7EC4;&#x76F8;&#x8054;cache&#x7684;&#x8BBE;&#x8BA1;&#x4E0E;&#x5B9E;&#x73B0;"></a>&#x7EC4;&#x76F8;&#x8054;cache&#x7684;&#x8BBE;&#x8BA1;&#x4E0E;&#x5B9E;&#x73B0;</h2><p>&#x7EC4;&#x76F8;&#x8054;cache&#x5E76;&#x4E0D;&#x662F;&#x9AD8;&#x5927;&#x4E0A;&#x7684;&#x6280;&#x672F;&#xFF0C;&#x5728;&#x8BB8;&#x591A;&#x53C2;&#x8003;&#x4E66;&#x4E2D;&#x90FD;&#x6709;&#x4ECB;&#x7ECD;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x73B0;&#x4EE3;&#x5904;&#x7406;&#x5668;&#x4E2D;&#x5927;&#x91CF;&#x4F7F;&#x7528;&#x3002;&#x4F46;&#x662F;&#x4E92;&#x8054;&#x7F51;&#x4E0A;&#x6709;&#x5173;&#x7EC4;&#x76F8;&#x8054;cache&#x8BBE;&#x8BA1;&#x4E0E;&#x5B9E;&#x73B0;&#x7684;&#x6587;&#x7AE0;&#x5E76;&#x4E0D;&#x591A;&#xFF0C;&#x66F4;&#x591A;&#x7684;&#x662F;&#x5BF9;&#x5176;&#x7406;&#x8BBA;&#x6982;&#x5FF5;&#x7684;&#x63CF;&#x8FF0;&#x3002;&#x770B;&#x8D77;&#x6765;&#x7EC4;&#x76F8;&#x8054;cache&#x662F;&#x5F88;&#x7B80;&#x5355;&#x7684;&#xFF0C;&#x4F46;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x6A21;&#x5757;&#xFF0C;&#x5B9E;&#x73B0;&#x8D77;&#x6765;&#x4E5F;&#x9700;&#x8981;&#x4E0B;&#x70B9;&#x529F;&#x592B;&#x3002;<br>&#x5173;&#x4E8E;&#x7EC4;&#x76F8;&#x8054;cache&#x7684;&#x7406;&#x8BBA;&#xFF0C;&#x5728;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x91CC;&#x6211;&#x5C31;&#x4E0D;&#x8D58;&#x8FF0;&#x4E86;&#xFF0C;&#x76F4;&#x63A5;&#x5207;&#x5165;&#x6B63;&#x9898;&#x3002;<br>&#x5728;&#x672C;&#x5E73;&#x53F0;&#x4E2D;&#x4F7F;&#x7528;&#x7684;cache&#x539F;&#x7406;&#x56FE;&#x5982;&#x4E0B;&#xFF0C;&#x56FE;&#x4E2D;&#x7684;&#x4FE1;&#x53F7;&#x540D;&#x79F0;&#x548C;&#x4EE3;&#x7801;&#x4E2D;&#x7684;&#x4FE1;&#x53F7;&#x540D;&#x79F0;&#x4E00;&#x4E00;&#x5BF9;&#x5E94;&#x3002;<br><img src="/%E7%BB%84%E7%9B%B8%E8%81%94cache%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/cache.JPG" alt="2-way set associative cache"></p>
<p>&#x6574;&#x4E2A;cache&#x4E3B;&#x8981;&#x5206;&#x4E3A;&#x56DB;&#x90E8;&#x5206;&#xFF0C;&#x5206;&#x522B;&#x662F;&#x4E0E;CPU&#x548C;&#x603B;&#x7EBF;&#x7684;&#x63A5;&#x53E3;&#x3001;&#x5185;&#x90E8;&#x7684;&#x5B58;&#x50A8;&#x5668;&#x7EC4;&#x4EE5;&#x53CA;&#x63A7;&#x5236;&#x5355;&#x5143;&#x3002;&#x5728;&#x8FD9;&#x4E2A;&#x5E73;&#x53F0;&#x4E0A;&#xFF0C;&#x6307;&#x4EE4;cache&#x8981;&#x6BD4;&#x6570;&#x636E;cache&#x7B80;&#x5355;&#xFF0C;&#x56E0;&#x4E3A;&#x6307;&#x4EE4;cache&#x662F;&#x53EA;&#x8BFB;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x5982;&#x679C;&#x4E3A;&#x6307;&#x4EE4;cache&#x548C;&#x6570;&#x636E;cache&#x6D89;&#x53CA;&#x4E24;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x6A21;&#x5757;&#x4F1A;&#x51CF;&#x5C11;&#x5BF9;FPGA&#x8D44;&#x6E90;&#x7684;&#x5360;&#x7528;&#x3002;&#x4F46;&#x662F;&#x6211;&#x5077;&#x4E86;&#x4E2A;&#x5C0F;&#x61D2;&#xFF0C;&#x8BA9;&#x4E24;&#x4E2A;cache&#x5171;&#x7528;&#x4E00;&#x4E2A;&#x6A21;&#x5757;&#xFF0C;&#x8FD9;&#x6837;&#x5927;&#x5927;&#x51CF;&#x5C11;&#x4E86;&#x6211;&#x7684;&#x5DE5;&#x4F5C;&#x91CF;&#x3002;</p>
<h3 id="&#x4E0E;CPU&#x7684;&#x63A5;&#x53E3;"><a href="#&#x4E0E;CPU&#x7684;&#x63A5;&#x53E3;" class="headerlink" title="&#x4E0E;CPU&#x7684;&#x63A5;&#x53E3;"></a>&#x4E0E;CPU&#x7684;&#x63A5;&#x53E3;</h3><p>&#x5982;&#x56FE;&#x4E2D;&#x6240;&#x793A;&#xFF0C;cache&#x4E0E;cpu&#x7684;&#x63A5;&#x53E3;&#x5305;&#x62EC;&#xFF1A;</p>
<ul>
<li>CPU_stall &#x4FE1;&#x53F7;&#xFF0C;&#x8BE5;&#x4FE1;&#x53F7;&#x662F;&#x7531;CPU ID&#x7EA7;&#x7684;CU&#x6839;&#x636E;&#x4E24;&#x4E2A;cache&#x7684;&#x72B6;&#x6001;&#x4EA7;&#x751F;&#x7684;&#x53CD;&#x9988;&#x3002;</li>
<li>CPU_Addr &#x603B;&#x7EBF;&#x5BF9;&#x4E8E;&#x6307;&#x4EE4;cache&#x6765;&#x8BF4;&#xFF0C;&#x5E94;&#x8BE5;&#x76F4;&#x63A5;&#x4E0E;NextPC&#x591A;&#x8DEF;&#x5668;&#x7684;&#x8F93;&#x51FA;&#x76F8;&#x8FDE;&#xFF0C;&#x5BF9;&#x4E8E;&#x6570;&#x636E;cache&#x5219;&#x4E0E;EXE&#x7EA7;&#x7684;&#x5730;&#x5740;&#x8BA1;&#x7B97;&#x7ED3;&#x679C;&#x76F4;&#x63A5;&#x76F8;&#x8FDE;&#x3002;&#x76F4;&#x63A5;&#x4E0E;&#x524D;&#x4E00;&#x7EA7;&#x8F93;&#x51FA;&#x800C;&#x4E0D;&#x662F;&#x4E0E;&#x6D41;&#x6C34;&#x7EBF;&#x5BC4;&#x5B58;&#x5668;&#x76F8;&#x8FDE;&#xFF0C;&#x662F;&#x4E3A;&#x4E86;&#x5728;&#x4F7F;&#x7528;&#x677F;&#x8F7D;RAM&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x4ECD;&#x80FD;&#x6EE1;&#x8DB3;&#x4E00;&#x4E2A;&#x5468;&#x671F;&#x5F97;&#x5230;cache&#x547D;&#x4E2D;&#x7ED3;&#x679C;&#x7684;&#x5173;&#x952E;&#x3002;&#x677F;&#x8F7D;RAM&#x4E0A;&#x6709;&#x5185;&#x7F6E;&#x7684;&#x5BC4;&#x5B58;&#x5668;&#xFF0C;&#x5982;&#x679C;&#x5730;&#x5740;&#x8F93;&#x5165;&#x4E0D;&#x4E0E;&#x524D;&#x7EA7;&#x8F93;&#x51FA;&#x76F4;&#x63A5;&#x76F8;&#x8FDE;&#xFF0C;&#x9700;&#x8981;&#x81F3;&#x5C11;&#x4E24;&#x4E2A;&#x5468;&#x671F;&#x624D;&#x53EF;&#x4EE5;&#x77E5;&#x9053;cache&#x547D;&#x4E2D;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x6570;&#x636E;&#x8981;&#x5148;&#x7ECF;&#x8FC7;&#x6D41;&#x6C34;&#x7EBF;&#x5BC4;&#x5B58;&#x5668;&#xFF0C;&#x518D;&#x7ECF;&#x8FC7;&#x677F;&#x8F7D;RAM&#x5185;&#x90E8;&#x5730;&#x5740;&#x5BC4;&#x5B58;&#x5668;&#xFF0C;&#x624D;&#x80FD;&#x8F93;&#x5165;&#x7ED3;&#x679C;&#x3002;</li>
<li>CPU_data &#x603B;&#x7EBF;&#x5BF9;&#x4E8E;&#x6307;&#x4EE4;Cache&#x6765;&#x8BF4;&#x5E94;&#x5F53;&#x5168;&#x90E8;&#x662F;&#x96F6;&#xFF0C;&#x56E0;&#x4E3A;&#x6307;&#x4EE4;cache&#x662F;&#x53EA;&#x8BFB;&#x7684;&#xFF1B;&#x5BF9;&#x4E8E;&#x6570;&#x636E;cache&#x5E94;&#x76F4;&#x63A5;&#x8FDE;&#x63A5;&#x524D;&#x4E00;&#x7EA7;&#x7684;&#x8F93;&#x51FA;&#x3002;</li>
<li>CPU_req &#x4FE1;&#x53F7;&#xFF0C;&#x9AD8;&#x7535;&#x5E73;&#x8868;&#x793A;&#x9700;&#x8981;&#x4ECE;cache&#x83B7;&#x53D6;&#x6570;&#x636E;&#x6216;&#x6307;&#x4EE4;&#x3002;&#x5BF9;&#x4E8E;I cache&#x800C;&#x8A00;&#xFF0C;&#x8BE5;&#x4FE1;&#x53F7;&#x5E94;&#x59CB;&#x7EC8;&#x662F;&#x9AD8;&#x7535;&#x5E73;&#xFF0C;&#x56E0;&#x4E3A;CPU&#x603B;&#x662F;&#x9700;&#x8981;&#x83B7;&#x53D6;&#x65B0;&#x7684;&#x5730;&#x5740;&#xFF1B;&#x800C;&#x5BF9;&#x4E8E;D cache&#xFF0C;&#x8BE5;&#x4FE1;&#x53F7;&#x5E94;&#x4E0E;&#x524D;&#x4E00;&#x7EA7;&#x8F93;&#x51FA;&#x76F8;&#x8FDE;&#xFF0C;&#x7531;CPU&#x7684;ID&#x7EA7;&#x7ED9;&#x51FA;&#x7684;&#x4FE1;&#x53F7;&#x63A7;&#x5236;&#xFF0C;&#x56E0;&#x4E3A;&#x4E0D;&#x662F;&#x6BCF;&#x6761;&#x6307;&#x4EE4;&#x90FD;&#x9700;&#x8981;&#x8BBF;&#x95EE;D cache&#x3002;</li>
<li>CPU_RW &#x4FE1;&#x53F7;&#x6807;&#x5FD7;&#x5F53;&#x524D;&#x8BF7;&#x6C42;&#x662F;&#x8BFB;&#x8BF7;&#x6C42;&#x8FD8;&#x662F;&#x5199;&#x8BF7;&#x6C42;&#x3002;&#x8BE5;&#x4FE1;&#x53F7;&#x5BF9;&#x4E8E;I cache&#x800C;&#x8A00;&#x59CB;&#x7EC8;&#x662F;&#x4F4E;&#x7535;&#x5E73;&#xFF0C;&#x56E0;&#x4E3A;&#x5176;&#x662F;&#x53EA;&#x8BFB;&#x7684;&#x3002;&#x5BF9;&#x4E8E;D cache &#x5E94;&#x76F4;&#x63A5;&#x4E0E;&#x524D;&#x4E00;&#x7EA7;&#x8F93;&#x51FA;&#x76F8;&#x8FDE;&#xFF0C;&#x7531;ID&#x7EA7;&#x63A7;&#x5236;&#x3002;</li>
<li>CPU_clr &#x4FE1;&#x53F7;&#x662F;&#x63A7;&#x5236;cache&#x5185;&#x90E8;&#x7684;valid bits&#x7684;&#x6E05;&#x96F6;&#x4FE1;&#x53F7;&#xFF0C;&#x5982;&#x679C;&#x8BE5;&#x4FE1;&#x53F7;&#x4E3A;&#x9AD8;&#x7535;&#x5E73;&#xFF0C;&#x5219;&#x4E0B;&#x4E00;&#x65F6;&#x949F;&#x4E0A;&#x8DF3;&#x65F6;&#x6E05;&#x9664;&#x6574;&#x4E2A;cache&#x7684;valid bits&#x3002;&#x6211;&#x4F1A;&#x5728;ID&#x7EA7;&#x5B9E;&#x73B0;&#x4E24;&#x4E2A;&#x5206;&#x522B;&#x6E05;&#x96F6;I cache &#x548C;D cache&#x7684;&#x6307;&#x4EE4;&#xFF0C;&#x7528;&#x8FD9;&#x4E2A;&#x6307;&#x4EE4;&#x63D0;&#x4F9B;&#x8F6F;&#x4EF6;&#x63A7;&#x5236;&#x7684;&#x7F13;&#x5B58;&#x540C;&#x6B65;&#x673A;&#x5236;&#x3002;&#x5F53;&#x5B58;&#x5728;&#x81EA;&#x4FEE;&#x6539;&#x4EE3;&#x7801;&#x65F6;&#xFF0C;&#x7CFB;&#x7EDF;&#x7A0B;&#x5E8F;&#x5458;&#x5E94;&#x4F7F;&#x7528;&#x76F8;&#x5E94;&#x7684;cache&#x6E05;&#x96F6;&#x6307;&#x4EE4;&#x3002;</li>
<li>data_o &#x662F;&#x5411;CPU&#x8F93;&#x51FA;&#x7684;&#x51C6;&#x5907;&#x597D;&#x7684;&#x6570;&#x636E;&#x3002;</li>
<li>ready_o &#x4FE1;&#x53F7;&#x8868;&#x793A;cache&#x662F;&#x5426;&#x51C6;&#x5907;&#x597D;&#x3002;<br>&#x5728;&#x8FD9;&#x91CC;&#x503C;&#x5F97;&#x8BF4;&#x660E;&#x7684;&#x662F;&#xFF0C;&#x7531;&#x4E8E;FPGA&#x677F;&#x8F7D;ram&#x4E0A;&#x6709;&#x5185;&#x7F6E;&#x7684;register&#xFF0C;&#x5730;&#x5740;&#x8F93;&#x5165;&#x5FC5;&#x987B;&#x76F4;&#x63A5;&#x4E0E;&#x4E0A;&#x4E00;&#x7EA7;&#x76F8;&#x8FDE;&#xFF0C;&#x8FD9;&#x5728;&#x67D0;&#x79CD;&#x7A0B;&#x5EA6;&#x4E0A;&#x4F1A;&#x5F15;&#x8D77;&#x6D41;&#x6C34;&#x7EBF;&#x5BC4;&#x5B58;&#x5668;&#x8BBE;&#x8BA1;&#x7684;&#x5272;&#x88C2;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x6211;&#x5C06;&#x6240;&#x6709;&#x4E0A;&#x4E00;&#x7EA7;&#x6765;&#x7684;&#x8F93;&#x5165;&#x4FE1;&#x53F7;&#x5168;&#x90E8;&#x8BBE;&#x8BA1;&#x6210;&#x4E0E;cache&#x6A21;&#x5757;&#x76F4;&#x63A5;&#x76F8;&#x8FDE;&#xFF0C;&#x5728;&#x6A21;&#x5757;&#x5185;&#x90E8;&#x5E76;&#x884C;&#x7684;&#x589E;&#x8BBE;&#x5BC4;&#x5B58;&#x5668;&#xFF0C;&#x5C06;&#x4E0E;cache&#x76F8;&#x5173;&#x7684;&#x6D41;&#x6C34;&#x7EBF;&#x5BC4;&#x5B58;&#x5668;&#x653E;&#x7F6E;&#x5728;cache&#x5185;&#x90E8;&#xFF0C;&#x5E76;&#x8BBE;&#x7F6E;&#x4E86;&#x8FD9;&#x4E9B;&#x5BC4;&#x5B58;&#x5668;&#x7684;&#x8F93;&#x51FA;&#x63A5;&#x53E3;&#x5982;addr_reg_o,&#x4F9B;&#x4E0B;&#x4E00;&#x7EA7;&#x6D41;&#x6C34;&#x7EBF;&#x4F7F;&#x7528;&#x3002;</li>
</ul>
<h3 id="&#x4E0E;&#x603B;&#x7EBF;&#x7684;&#x63A5;&#x53E3;"><a href="#&#x4E0E;&#x603B;&#x7EBF;&#x7684;&#x63A5;&#x53E3;" class="headerlink" title="&#x4E0E;&#x603B;&#x7EBF;&#x7684;&#x63A5;&#x53E3;"></a>&#x4E0E;&#x603B;&#x7EBF;&#x7684;&#x63A5;&#x53E3;</h3><p>&#x5728;&#x603B;&#x7EBF;&#x63A7;&#x5236;&#x5668;&#x7684;&#x8BBE;&#x8BA1;&#x65F6;&#x6211;&#x4F7F;&#x7528;&#x4E86;&#x4E09;&#x6001;&#x95E8;&#xFF0C;&#x4F46;&#x662F;&#x5B9E;&#x9645;&#x7EFC;&#x5408;&#x51FA;&#x7684;&#x903B;&#x8F91;&#x4E0D;&#x80FD;&#x8BC6;&#x522B;&#x9AD8;&#x963B;&#x6001;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x8BBE;&#x8BA1;&#x65F6;&#x8981;&#x8003;&#x8651;&#x5BF9;&#x9AD8;&#x963B;&#x6001;&#x4FE1;&#x53F7;&#x7684;&#x5C4F;&#x853D;&#x3002;&#x603B;&#x7EBF;&#x63A5;&#x53E3;&#x5305;&#x542B;&#xFF1A;</p>
<ul>
<li>BUS_addr &#x5730;&#x5740;&#x603B;&#x7EBF;</li>
<li>BUS_data &#x6570;&#x636E;&#x603B;&#x7EBF;</li>
<li>BUS_RW &#x8BFB;&#x5199;&#x6807;&#x5FD7;</li>
<li>BUS_req &#x603B;&#x7EBF;&#x8BF7;&#x6C42;&#x6807;&#x5FD7;&#xFF0C;&#x8BE5;&#x4FE1;&#x53F7;&#x5E94;&#x8FDE;&#x63A5;&#x603B;&#x7EBF;&#x63A7;&#x5236;&#x5668;&#x4E0A;&#x7684;DMA[0:7],&#x6839;&#x636E;DMA&#x7F16;&#x53F7;&#x4E0D;&#x540C;&#x5B9E;&#x73B0;&#x4E0D;&#x540C;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x3002;</li>
<li>BUS_grant &#x603B;&#x7EBF;&#x8BF7;&#x6C42;&#x8BB8;&#x53EF;&#xFF0C;&#x8BE5;&#x4FE1;&#x53F7;&#x4ECE;&#x603B;&#x7EBF;&#x63A7;&#x5236;&#x5668;&#x53D1;&#x6765;&#xFF0C;&#x5F53;&#x603B;&#x7EBF;&#x8BF7;&#x6C42;&#x83B7;&#x5F97;&#x63A7;&#x5236;&#x5668;&#x7684;&#x8BB8;&#x53EF;&#x540E;&#x8BE5;&#x4FE1;&#x53F7;&#x4E3A;&#x9AD8;&#x7535;&#x5E73;&#xFF0C;&#x8BE5;&#x4FE1;&#x53F7;&#x4E3B;&#x8981;&#x53C2;&#x4E0E;&#x603B;&#x7EBF;&#x63A5;&#x53E3;&#x4E09;&#x6001;&#x95E8;&#x7684;&#x63A7;&#x5236;&#x3002;</li>
<li>BUS_ready &#x4FE1;&#x53F7;&#xFF0C;&#x9AD8;&#x7535;&#x5E73;&#x6807;&#x5FD7;&#x603B;&#x7EBF;&#x8BF7;&#x6C42;&#x7ED3;&#x675F;&#x3002;</li>
</ul>
<p>&#x7CFB;&#x7EDF;&#x603B;&#x7EBF;&#x63A5;&#x53E3;&#x8FD9;&#x90E8;&#x5206;&#x7684;&#x4EE3;&#x7801;&#x4E3B;&#x8981;&#x662F;&#x5BF9;&#x603B;&#x7EBF;&#x4E0A;&#x4E09;&#x6001;&#x95E8;&#x7684;&#x63A7;&#x5236;&#xFF0C;&#x903B;&#x8F91;&#x8BBE;&#x8BA1;&#x8981;&#x4FDD;&#x8BC1;&#x603B;&#x7EBF;&#x4E0A;&#x5176;&#x4ED6;&#x8BBE;&#x5907;&#x7684;&#x4FE1;&#x53F7;&#x4E0D;&#x80FD;&#x5E72;&#x6270;&#x672C;&#x8BBE;&#x5907;&#x3002;<br>&#x9996;&#x5148;&#x8981;&#x4FDD;&#x8BC1;&#x5F53;&#x4E14;&#x4EC5;&#x5F53;&#x603B;&#x7EBF;&#x8BF7;&#x6C42;&#x88AB;&#x63A7;&#x5236;&#x5668;&#x5141;&#x8BB8;&#x540E;&#x624D;&#x80FD;&#x5411;&#x603B;&#x7EBF;&#x53D1;&#x9001;&#x6570;&#x636E;&#xFF1A;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">//BUS Interface</span></span><br><span class="line">    <span class="hljs-keyword">assign</span> BUS_addr = BUS_grant ? addr_reg : <span class="hljs-number">32&apos;bz</span>;</span><br><span class="line">    <span class="hljs-keyword">assign</span> BUS_RW = BUS_grant ? CPU_RW_reg : <span class="hljs-number">1&apos;bz</span>;</span><br></pre></td></tr></table></figure>
<p>&#x540C;&#x65F6;&#x4E5F;&#x8981;&#x786E;&#x4FDD;&#x53EA;&#x6536;&#x5230;&#x53D1;&#x9001;&#x7ED9;&#x81EA;&#x5DF1;&#x7684;ready&#x4FE1;&#x53F7;,&#x5728;&#x81EA;&#x5DF1;&#x6CA1;&#x6709;&#x603B;&#x7EBF;&#x8BF7;&#x6C42;&#x65F6;&#x8FC7;&#x6EE4;&#x6389;&#x603B;&#x7EBF;&#x7684;ready&#x4FE1;&#x53F7;&#xFF0C;&#x4FDD;&#x8BC1;ready&#x4FE1;&#x53F7;&#x7EBF;&#x4E0A;&#x7684;&#x9AD8;&#x963B;&#x6001;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x81EA;&#x5DF1;&#x3002;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">wire</span> ready_in = BUS_grant ? BUS_ready : <span class="hljs-number">1&apos;b0</span>;</span><br></pre></td></tr></table></figure>
<p>&#x603B;&#x7EBF;&#x7684;&#x6570;&#x636E;&#x63A5;&#x53E3;&#x662F;&#x53CC;&#x5411;&#x63A5;&#x53E3;&#xFF0C;&#x5411;&#x603B;&#x7EBF;&#x53D1;&#x9001;&#x5199;&#x8BF7;&#x6C42;&#x65F6;&#xFF0C;&#x76F4;&#x63A5;&#x5C06;&#x6570;&#x636E;&#x9001;&#x81F3;&#x6570;&#x636E;&#x603B;&#x7EBF;&#xFF1B;&#x53D1;&#x8D77;&#x8BFB;&#x8BF7;&#x6C42;&#x65F6;&#xFF0C;&#x5E94;&#x8BBE;&#x7F6E;&#x4E3A;&#x9AD8;&#x963B;&#x6001;&#xFF0C;&#x76F4;&#x63A5;&#x4ECE;&#x6570;&#x636E;&#x603B;&#x7EBF;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x3002;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">wire</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] data_to_bus = CPU_RW_reg ? data_reg : <span class="hljs-number">32&apos;bz</span>;</span><br><span class="line"><span class="hljs-keyword">assign</span> BUS_data = BUS_grant ? data_to_bus : <span class="hljs-number">32&apos;bz</span>;</span><br></pre></td></tr></table></figure>
<p>&#x5728;&#x8BFB;cache&#x4E0D;&#x547D;&#x4E2D;&#x3001;&#x5199;&#x5165;&#x6216;&#x8BFB;&#x5199;&#x4E0D;&#x9700;&#x8981;cache&#x7684;&#x5730;&#x5740;&#x65F6;&#xFF0C;&#x624D;&#x5E94;&#x50CF;&#x603B;&#x7EBF;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#xFF0C;&#x5176;&#x4ED6;&#x60C5;&#x51B5;&#x8BA9;&#x51FA;&#x603B;&#x7EBF;&#x7684;&#x63A7;&#x5236;&#x6743;&#x3002;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">assign</span> BUS_req = CPU_req_reg &amp;&amp; ((~CPU_RW_reg &amp;&amp; ~CACHE_HIT_R )</span><br><span class="line">            ||(CPU_RW_reg &amp;&amp; ~ready_reg));</span><br></pre></td></tr></table></figure>
<p>&#x503C;&#x5F97;&#x8BF4;&#x660E;&#x7684;&#x4E00;&#x70B9;&#x662F;&#xFF0C;&#x7531;&#x4E8E;&#x6A21;&#x5757;&#x7684;&#x8F93;&#x5165;&#x90FD;&#x662F;&#x4E0A;&#x4E00;&#x7EA7;&#x7684;&#x76F4;&#x63A5;&#x8F93;&#x5165;&#xFF0C;&#x5BC4;&#x5B58;&#x5668;&#x5728;&#x6A21;&#x5757;&#x7684;&#x5185;&#x90E8;&#xFF0C;&#x800C;&#x4E14;cache&#x7684;ready&#x4FE1;&#x53F7;&#x4E0E;cpu&#x7684;stall&#x4FE1;&#x53F7;&#x76F4;&#x63A5;&#x6709;&#x5173;&#xFF0C;&#x56E0;&#x6B64;&#x63A7;&#x5236;&#x4FE1;&#x53F7;&#x7684;&#x903B;&#x8F91;&#x9700;&#x8981;&#x5C0F;&#x5FC3;&#x8BBE;&#x8BA1;&#xFF0C;&#x907F;&#x514D;&#x51FA;&#x73B0;&#x7EC4;&#x5408;&#x903B;&#x8F91;&#x73AF;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;cache&#x7684;ready&#x4FE1;&#x53F7;&#x5E94;&#x8BE5;&#x53EA;&#x548C;&#x6A21;&#x5757;&#x5185;&#x7684;&#x5BC4;&#x5B58;&#x5668;&#x7684;&#x503C;&#x6709;&#x5173;&#x7CFB;&#xFF0C;&#x4E0D;&#x5E94;&#x5F53;&#x4E0E;stall&#x4FE1;&#x53F7;&#x76F4;&#x63A5;&#x76F8;&#x5173;&#x3002;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x603B;&#x7EBF;&#x63A5;&#x53E3;&#x7684;&#x8BBE;&#x8BA1;&#x9075;&#x5FAA;&#x4E86;&#x8FD9;&#x6837;&#x7684;&#x539F;&#x5219;&#x3002;&#x5F53;&#x603B;&#x7EBF;ready&#x65F6;&#xFF0C;cache&#x5E94;&#x540C;&#x65F6;&#x7ED9;cpu ready&#x4FE1;&#x53F7;&#xFF0C;&#x56E0;&#x6B64;cache&#x7684;ready&#x4FE1;&#x53F7;&#x4E0E;&#x603B;&#x7EBF;&#x7684;&#x72B6;&#x6001;&#x6709;&#x5173;&#xFF0C;&#x603B;&#x7EBF;&#x7684;&#x72B6;&#x6001;&#x4E5F;&#x5E94;&#x8BE5;&#x4EC5;&#x4E0E;&#x5BC4;&#x5B58;&#x5668;&#x4E2D;&#x7684;&#x503C;&#x76F8;&#x5173;&#x3002;&#x5728;&#x603B;&#x7EBF;&#x63A5;&#x53E3;&#x90E8;&#x5206;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x63A7;&#x5236;&#x4FE1;&#x53F7;&#x5747;&#x4F7F;&#x7528;&#x5BC4;&#x5B58;&#x5668;&#x4E2D;&#x7684;&#x503C;&#x800C;&#x4E0D;&#x662F;&#x4E0A;&#x4E00;&#x7EA7;&#x7684;&#x76F4;&#x63A5;&#x8F93;&#x5165;&#x3002;</p>
<h3 id="cache&#x5185;&#x90E8;&#x7684;&#x5B58;&#x50A8;&#x5668;"><a href="#cache&#x5185;&#x90E8;&#x7684;&#x5B58;&#x50A8;&#x5668;" class="headerlink" title="cache&#x5185;&#x90E8;&#x7684;&#x5B58;&#x50A8;&#x5668;"></a>cache&#x5185;&#x90E8;&#x7684;&#x5B58;&#x50A8;&#x5668;</h3><p>&#x5982;&#x56FE;&#x6240;&#x793A;&#xFF0C;cache&#x5185;&#x90E8;&#x5171;&#x6709;&#x4E09;&#x7C7B;&#x5B58;&#x50A8;&#x5668;&#xFF0C;&#x5206;&#x522B;&#x5B58;&#x50A8;TAG&#x3001;&#x6709;&#x6548;&#x4F4D;(valid bits)&#x548C;&#x5B9E;&#x9645;&#x8BF7;&#x6C42;&#x7684;&#x6570;&#x636E;(RAM)&#x3002;<br>&#x8FD9;&#x4E2A;cache&#x6A21;&#x5757;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x6539;&#x5199;&#x53C2;&#x6570;&#x7684;&#x65B9;&#x5F0F;&#x6539;&#x53D8;cache&#x7684;&#x89C4;&#x6A21;&#xFF0C;cache&#x7684;&#x89C4;&#x6A21;&#x7531;&#x7D22;&#x5F15;&#x7684;&#x5BBD;&#x5EA6;INDEX&#x8868;&#x793A;,INDEX&#x9ED8;&#x8BA4;&#x503C;&#x662F;7&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x5185;&#x5B58;&#x5730;&#x5740;&#x51FA;&#x53BB;&#x5B57;&#x5185;&#x5730;&#x5740;&#x4F4E;&#x4E24;&#x4F4D;,[INDEX+1:2]&#x8FD9;&#x4E2A;&#x8303;&#x56F4;&#x4F5C;&#x4E3A;&#x4E03;&#x4F4D;&#x7684;&#x7D22;&#x5F15;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x7D22;&#x5F15;cache_lines = 2&lt;&lt; (INDEX -1) &#x884C;&#xFF0C;&#x5728;TAG&#x4E2D;&#x5B58;&#x50A8;&#x7684;TAG&#x5C3A;&#x5BF8;&#x4E3A;tag_size = 32-2- INDEX&#x3002;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">//Number of Lines in each group.</span></span><br><span class="line">    <span class="hljs-keyword">localparam</span> cache_lines = <span class="hljs-number">2</span>&lt;&lt; (INDEX -<span class="hljs-number">1</span>);</span><br><span class="line">    <span class="hljs-keyword">localparam</span> tag_size = <span class="hljs-number">32</span>-<span class="hljs-number">2</span>- INDEX;</span><br><span class="line"><span class="hljs-comment">//default size of the cache is two 512 bytes (128 lines) set, total size is 1KB.</span></span><br><span class="line">    <span class="hljs-keyword">parameter</span> INDEX=<span class="hljs-number">7</span>;</span><br><span class="line">    <span class="hljs-keyword">parameter</span> WIDTH=<span class="hljs-number">32</span>;</span><br></pre></td></tr></table></figure>
<p>&#x6240;&#x8C13;2&#x8DEF;&#x7EC4;&#x76F8;&#x8054;&#xFF0C;&#x610F;&#x601D;&#x662F;&#x6BCF;&#x4E2A;index&#x53EF;&#x4EE5;&#x7D22;&#x5F15;&#x4E24;&#x7EC4;&#x5185;&#x5BB9;&#xFF0C;&#x5206;&#x522B;&#x5B58;&#x653E;&#x5728;A&#x3001;B&#x4E24;&#x7EC4;TAG&#x3001;valid bits&#x548C;RAM&#x4E2D;&#xFF0C;&#x540C;&#x65F6;&#x5BF9;&#x6BD4;&#x4E24;&#x7EC4;&#x7684;TAG&#x548C;Valid bits&#xFF0C;&#x5F97;&#x5230;cache&#x547D;&#x4E2D;&#x7ED3;&#x679C;&#x3002;&#x5BF9;&#x6BD4;&#x76F4;&#x63A5;&#x955C;&#x50CF;&#x7684;&#x597D;&#x5904;&#x662F;&#x81EA;&#x7531;&#x5EA6;&#x66F4;&#x5927;&#x4E00;&#x4E9B;&#xFF0C;&#x5F53;&#x8BFB;&#x53D6;&#x5230;&#x4E24;&#x4E2A;index&#x76F8;&#x540C;&#x7684;&#x5185;&#x5B58;&#x5730;&#x5740;&#x65F6;&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A;&#x6570;&#x636E;&#x90FD;&#x53EF;&#x4EE5;&#x5B58;&#x653E;&#x5728;cache&#x4E2D;&#xFF0C;&#x800C;&#x5728;&#x76F4;&#x63A5;&#x955C;&#x50CF;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6B64;&#x65F6;&#x5C31;&#x4F1A;&#x53D1;&#x751F;cache&#x66FF;&#x6362;&#x3002;<br>&#x9996;&#x5148;&#x5B9A;&#x4E49;index&#x548C;tag&#xFF1A;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">//vector index is for indexing the whole cache.</span></span><br><span class="line"><span class="hljs-keyword">wire</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] addr = CPU_stall ? addr_reg : CPU_addr;</span><br><span class="line"><span class="hljs-keyword">wire</span> [INDEX-<span class="hljs-number">1</span>:<span class="hljs-number">0</span>] index = addr[INDEX+<span class="hljs-number">1</span> :<span class="hljs-number">2</span>];</span><br><span class="line"><span class="hljs-keyword">wire</span> [INDEX-<span class="hljs-number">1</span>:<span class="hljs-number">0</span>] index_reg = addr_reg[INDEX+<span class="hljs-number">1</span> :<span class="hljs-number">2</span>];</span><br><span class="line"><span class="hljs-comment">//vector tag is used to determined if there&apos;s a cache hit, if not, new tag is written</span></span><br><span class="line"><span class="hljs-comment">//in the tag storage. </span></span><br><span class="line"><span class="hljs-keyword">wire</span> [tag_size-<span class="hljs-number">1</span>:<span class="hljs-number">0</span>] tag_reg = addr_reg [<span class="hljs-number">31</span>:INDEX+<span class="hljs-number">2</span>];</span><br></pre></td></tr></table></figure>
<p>&#x7136;&#x540E;&#x5B9A;&#x4E49;TAG&#x3001;Valid bits&#x548C;RAM&#x4E09;&#x4E2A;&#x5B58;&#x50A8;&#x5668;&#x3002;&#x4EE5;&#x5176;&#x4E2D;A&#x7EC4;&#x4E3A;&#x4F8B;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">//Memory for TAG_A.</span></span><br><span class="line"><span class="hljs-keyword">reg</span> [tag_size-<span class="hljs-number">1</span> : <span class="hljs-number">0</span>] TAG_A [<span class="hljs-number">0</span> : cache_lines-<span class="hljs-number">1</span>];</span><br><span class="line"><span class="hljs-keyword">reg</span> [tag_size-<span class="hljs-number">1</span> : <span class="hljs-number">0</span>] TAG_A_out;</span><br><span class="line"><span class="hljs-keyword">always</span> @(<span class="hljs-keyword">posedge</span> clk)</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-keyword">if</span> (WE_A) </span><br><span class="line">        TAG_A [index_reg] = tag_reg;</span><br><span class="line">    TAG_A_out = TAG_A [index];</span><br><span class="line"><span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">//valid bits for group A.</span></span><br><span class="line"><span class="hljs-keyword">reg</span> VALID_A_out ;</span><br><span class="line"><span class="hljs-keyword">always</span> @(<span class="hljs-keyword">posedge</span> clk)</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-keyword">if</span> (clr || cache_clr)</span><br><span class="line">        VALID_A = <span class="hljs-number">32&apos;b0</span>;</span><br><span class="line">    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (WE_A) </span><br><span class="line">        VALID_A[index_reg] =<span class="hljs-number">1</span>;</span><br><span class="line">    VALID_A_out = VALID_A[index];</span><br><span class="line"><span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">//memory for group A.</span></span><br><span class="line"><span class="hljs-keyword">reg</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] RAM_A [<span class="hljs-number">0</span> : cache_lines-<span class="hljs-number">1</span>];</span><br><span class="line"><span class="hljs-keyword">reg</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] RAM_A_out;</span><br><span class="line"><span class="hljs-keyword">always</span> @(<span class="hljs-keyword">posedge</span> clk)</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-keyword">if</span> (WE_A)</span><br><span class="line">        RAM_A[index_reg] = RAM_in;</span><br><span class="line"></span><br><span class="line">    RAM_A_out = RAM_A[index];</span><br><span class="line"><span class="hljs-keyword">end</span></span><br></pre></td></tr></table></figure>
<p>&#x8FD9;&#x91CC;&#x6709;&#x4E00;&#x4E9B;&#x7EC6;&#x8282;&#x503C;&#x5F97;&#x8BF4;&#x660E;&#x3002;index&#x4FE1;&#x53F7;&#x662F;&#x5BF9;addr&#x7684;&#x622A;&#x53D6;&#xFF0C;addr&#x6839;&#x636E;&#x5F53;&#x524D;cpu&#x7684;&#x72B6;&#x6001;&#x9009;&#x62E9;&#x76F4;&#x63A5;&#x4ECE;&#x4E0A;&#x4E00;&#x7EA7;&#x6D41;&#x6C34;&#x8F93;&#x5165;&#x7684;&#x5730;&#x5740;&#x6216;&#x662F;&#x5185;&#x90E8;&#x5BC4;&#x5B58;&#x7684;&#x5730;&#x5740;&#x3002;index_reg&#x662F;&#x4ECE;&#x5185;&#x90E8;&#x7684;&#x5730;&#x5740;&#x5BC4;&#x5B58;&#x5668;&#x622A;&#x53D6;&#x7684;&#x3002;&#x540C;&#x65F6;&#x4F7F;&#x7528;&#x4E24;&#x4E2A;&#x4FE1;&#x53F7;&#x662F;&#x5B9E;&#x73B0;&#x5355;&#x4E2A;&#x5468;&#x671F;&#x8BA1;&#x7B97;&#x662F;&#x5426;cache&#x547D;&#x4E2D;&#x7684;&#x5173;&#x952E;&#x3002;&#x5728;&#x4E0A;&#x8FF0;&#x7684;&#x4E09;&#x4E2A;&#x5B58;&#x50A8;&#x5668;&#x4E2D;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6240;&#x6709;&#x7684;&#x8BFB;&#x63A5;&#x53E3;&#x7684;&#x7D22;&#x5F15;&#x90FD;&#x4F7F;&#x7528;index&#xFF0C;&#x8FD9;&#x5C31;&#x4FDD;&#x8BC1;&#x4E86;&#x5728;&#x7B2C;&#x4E00;&#x4E2A;&#x65F6;&#x949F;&#x5468;&#x671F;&#x4E0A;&#x8DF3;&#xFF0C;&#x5B58;&#x50A8;&#x5668;&#x5C31;&#x5DF2;&#x7ECF;&#x5C06;&#x65B0;&#x8BFB;&#x53D6;&#x7ED3;&#x679C;&#x3002;&#x800C;&#x5BF9;&#x8FD9;&#x4E9B;&#x5B58;&#x50A8;&#x7684;&#x4FEE;&#x6539;&#x4EC5;&#x5F53;cache&#x4E0D;&#x547D;&#x4E2D;&#x6216;&#x8005;&#x5199;&#x900F;&#x65F6;&#x624D;&#x53D1;&#x751F;&#xFF0C;&#x56E0;&#x6B64;&#x5199;&#x5165;&#x6700;&#x65E9;&#x5E94;&#x8BE5;&#x53D1;&#x751F;&#x5728;&#x4E0B;&#x4E00;&#x5468;&#x671F;&#x4E0A;&#x8FB9;&#x6CBF;&#xFF08;&#x56E0;&#x4E3A;&#x603B;&#x7EBF;&#x4E0A;&#x7684;&#x8BBE;&#x5907;&#x7684;&#x54CD;&#x5E94;&#x65F6;&#x95F4;&#x4E0D;&#x540C;&#xFF0C;&#x5982;&#x679C;&#x603B;&#x7EBF;&#x4E0A;&#x7684;&#x8BBE;&#x5907;&#x80FD;&#x591F;&#x5728;&#x5F53;&#x524D;&#x5468;&#x671F;&#x5185;&#x76F8;&#x5E94;&#xFF0C;&#x5C31;&#x662F;&#x6240;&#x8C13;&#x7684;&#x6700;&#x65E9;&#x7684;&#x60C5;&#x51B5;&#xFF09;&#xFF0C;&#x800C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x4E0A;&#x4E00;&#x7EA7;&#x6D41;&#x6C34;&#x8F93;&#x51FA;&#x7684;&#x4FE1;&#x53F7;&#x5DF2;&#x7ECF;&#x53D1;&#x751F;&#x6539;&#x53D8;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x5E76;&#x4E0D;&#x80FD;&#x963B;&#x6B62;&#x8FD9;&#x79CD;&#x6539;&#x53D8;&#x53D1;&#x751F;&#xFF0C;&#x56E0;&#x6B64;&#x6240;&#x6709;&#x7684;&#x5199;&#x5165;&#x4FE1;&#x53F7;&#x90FD;&#x5E94;&#x8BE5;&#x4F7F;&#x7528;&#x5185;&#x90E8;&#x5BC4;&#x5B58;&#x5668;&#x7684;&#x8F93;&#x51FA;&#xFF08;&#x8FD9;&#x4E2A;&#x5185;&#x90E8;&#x5BC4;&#x5B58;&#x5668;&#x5C31;&#x662F;&#x6D41;&#x6C34;&#x7EBF;&#x5BC4;&#x5B58;&#x5668;&#xFF09;&#x3002;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x4F7F;&#x7528;stall&#x4FE1;&#x53F7;&#x6765;&#x533A;&#x5206;cpu&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x5982;&#x679C;&#x6B64;&#x65F6;stall&#x4FE1;&#x53F7;&#x4E3A;&#x4F4E;&#x7535;&#x5E73;&#xFF0C;&#x8FD9;&#x8BF4;&#x660E;cpu&#x5728;&#x5904;&#x7406;&#x65B0;&#x6307;&#x4EE4;&#xFF0C;index&#x7684;&#x503C;&#x662F;&#x76F4;&#x63A5;&#x4ECE;&#x4E0A;&#x4E00;&#x7EA7;&#x622A;&#x53D6;&#x7684;&#xFF0C;&#x4F7F;&#x7528;index&#x63D0;&#x4F9B;&#x7684;&#x7D22;&#x5F15;&#x8BFB;&#x53D6;cache&#x5185;&#x90E8;&#x5B58;&#x50A8;&#x5224;&#x65AD;&#x662F;&#x5426;&#x547D;&#x4E2D;&#xFF0C;&#x82E5;&#x4E0D;&#x547D;&#x4E2D;&#xFF0C;&#x5219;&#x7B49;&#x5F85;&#x603B;&#x7EBF;&#x54CD;&#x5E94;&#xFF0C;&#x540C;&#x65F6;&#x901A;&#x8FC7;ready&#x4FE1;&#x53F7;&#x4F7F;cpu&#x6682;&#x505C;&#xFF0C;&#x6B64;&#x65F6;stall&#x4FE1;&#x53F7;&#x4E3A;&#x9AD8;&#x7535;&#x5E73;&#xFF0C;&#x6B64;&#x540E;&#x7684;&#x5468;&#x671F;&#x76F4;&#x5230;&#x7F13;&#x5B58;&#x51C6;&#x5907;&#x597D;&#xFF0C;&#x8BFB;&#x8BF7;&#x6C42;&#x7684;&#x7D22;&#x5F15;index&#x90FD;&#x88AB;stall&#x4FE1;&#x53F7;&#x9009;&#x62E9;&#x6210;&#x5185;&#x90E8;&#x7684;&#x5BC4;&#x5B58;&#x5668;&#x8F93;&#x51FA;&#xFF0C;&#x53EF;&#x786E;&#x4FDD;&#x5728;&#x4E0A;&#x4E00;&#x8BF7;&#x6C42;&#x6CA1;&#x5B8C;&#x6210;&#x65F6;&#x7EE7;&#x7EED;&#x8BFB;&#x53D6;&#x4E0A;&#x4E00;&#x7D22;&#x5F15;&#x3002;<br>&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x4E86;&#x963B;&#x585E;&#x8D4B;&#x503C;&#x8BED;&#x53E5;&#xFF0C;&#x5BF9;&#x4E8E;&#x540C;&#x65F6;&#x5199;&#x5165;&#x548C;&#x8BFB;&#x53D6;&#x540C;&#x4E00;&#x4E2A;&#x5730;&#x5740;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x8BFB;&#x53D6;&#x7684;&#x7ED3;&#x679C;&#x662F;&#x5199;&#x5165;&#x7684;&#x65B0;&#x503C;&#xFF0C;&#x7EFC;&#x5408;&#x7684;&#x7ED3;&#x679C;&#x4F1A;&#x52A0;&#x5165;&#x4E00;&#x4E9B;&#x6570;&#x636E;&#x65C1;&#x8DEF;&#x6765;&#x7B26;&#x5408;&#x6211;&#x4EEC;&#x5B9A;&#x4E49;&#x7684;&#x884C;&#x4E3A;&#x3002;&#x603B;&#x662F;&#x8BFB;&#x53D6;&#x65B0;&#x503C;&#x5728;&#x6211;&#x7684;&#x8BBE;&#x8BA1;&#x4E2D;&#x662F;&#x5FC5;&#x8981;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x5F53;&#x603B;&#x7EBF;&#x51C6;&#x5907;&#x597D;&#x65F6;&#xFF0C;&#x5F53;&#x524D;cache&#x4E5F;&#x51C6;&#x5907;&#x597D;&#xFF0C;&#x800C;&#x6B64;&#x65F6;&#x53E6;&#x4E00;&#x4E2A;cache&#x53EF;&#x80FD;&#x5C1A;&#x672A;&#x51C6;&#x5907;&#x597D;&#x6B63;&#x5728;&#x8BF7;&#x6C42;&#x603B;&#x7EBF;&#xFF0C;&#x56E0;&#x6B64;cpu&#x8981;&#x7EE7;&#x7EED;&#x7B49;&#x5F85;&#x3002;&#x6B64;&#x65F6;&#x4E0B;&#x4E00;&#x4E2A;&#x65F6;&#x949F;&#x4E0A;&#x8FB9;&#x6CBF;&#xFF0C;&#x5F53;&#x524D;cache&#x5C06;&#x65B0;&#x7684;TAG&#x3001;Valid bit&#x548C;RAM&#x5199;&#x5165;cache&#xFF0C;&#x4F46;&#x662F;&#x603B;&#x7EBF;&#x4E0A;&#x7684;ready&#x4FE1;&#x53F7;&#x968F;&#x5373;&#x6D88;&#x5931;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5728;&#x8FD9;&#x4E2A;&#x65F6;&#x949F;&#x4E0A;&#x8FB9;&#x6CBF;&#x76F4;&#x63A5;&#x53D6;&#x5F97;cache&#x547D;&#x4E2D;&#x4FE1;&#x53F7;&#xFF0C;&#x8BA9;cpu&#x7B49;&#x5F85;&#x65F6;&#x4E0D;&#x9519;&#x8FC7;&#x8FD9;&#x6B21;&#x8BF7;&#x6C42;&#x7684;cache&#x4FE1;&#x53F7;&#x3002;&#x603B;&#x662F;&#x8BFB;&#x53D6;&#x65B0;&#x503C;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x5728;&#x603B;&#x7EBF;&#x51C6;&#x5907;&#x597D;&#x540E;&#x7684;&#x4E0B;&#x4E00;&#x4E2A;&#x65F6;&#x949F;&#x4E0A;&#x8FB9;&#x6CBF;&#x5C31;&#x80FD;&#x8F93;&#x51FA;cache&#x547D;&#x4E2D;&#x4FE1;&#x53F7;&#x3002;<br>&#x5BF9;&#x4E8E;valid bits&#xFF0C;&#x7531;&#x4E8E;&#x5B58;&#x5728;&#x7740;&#x6E05;&#x96F6;&#x4FE1;&#x53F7;&#xFF0C;&#x7531;&#x4E8E;altera&#x7684;&#x677F;&#x8F7D;&#x5B58;&#x50A8;&#x4E0D;&#x652F;&#x6301;&#x6E05;&#x96F6;&#x4FE1;&#x53F7;&#xFF0C;&#x6240;&#x4EE5;&#x5B83;&#x4F1A;&#x88AB;&#x7EFC;&#x5408;&#x6210;&#x5BC4;&#x5B58;&#x5668;&#x3002;&#x800C;&#x5176;&#x4ED6;&#x4E24;&#x5757;&#x5B58;&#x50A8;&#x4F1A;&#x88AB;&#x7EFC;&#x5408;&#x6210;&#x5B58;&#x50A8;&#x5668;&#xFF0C;&#x4F7F;&#x7528;&#x7247;&#x4E0A;&#x7684;RAM&#x8D44;&#x6E90;&#x3002;&#x6211;&#x6240;&#x8BBE;&#x60F3;&#x7684;&#x8BBE;&#x8BA1;&#x76EE;&#x6807;&#x662F;&#x4E0D;&#x7528;&#x5546;&#x4E1A;IP&#xFF0C;&#x4E0E;FPGA&#x65E0;&#x5173;&#xFF0C;&#x4F7F;&#x7528;&#x6807;&#x51C6;&#x7684;&#x786C;&#x4EF6;&#x63CF;&#x8FF0;&#x8BED;&#x8A00;&#x8BBE;&#x8BA1;&#xFF0C;&#x5728;&#x6CA1;&#x6709;&#x7247;&#x4E0A;RAM&#x8D44;&#x6E90;&#x7684;FPGA&#x4E0A;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x4ECD;&#x7136;&#x80FD;&#x591F;&#x7EFC;&#x5408;&#xFF0C;&#x4E0D;&#x8FC7;&#x8981;&#x6D88;&#x8017;&#x5927;&#x91CF;&#x7684;&#x5BC4;&#x5B58;&#x5668;&#x8D44;&#x6E90;&#x3002;<br>valid bits&#x7684;&#x8BFB;&#x51FA;&#x5E94;&#x8BE5;&#x662F;&#x5BC4;&#x5B58;&#x5668;&#x800C;&#x4E0D;&#x662F;assign&#x8FDE;&#x7EED;&#x8D4B;&#x503C;&#xFF0C;&#x56E0;&#x4E3A;valid bit&#x7684;&#x8F93;&#x51FA;&#x76F4;&#x63A5;&#x5173;&#x7CFB;&#x5230;ready&#x4FE1;&#x53F7;&#xFF0C;&#x800C;index&#x4E0E;stall&#x4FE1;&#x53F7;&#x6709;&#x5173;&#xFF0C;&#x5982;&#x679C;&#x4F7F;&#x7528;&#x8FDE;&#x7EED;&#x8D4B;&#x503C;&#xFF0C;&#x4F1A;&#x4EA7;&#x751F;&#x7EC4;&#x5408;&#x903B;&#x8F91;&#x5FAA;&#x73AF;&#x3002;</p>
<h4 id="&#x9488;&#x5BF9;&#x4E0D;&#x9700;cache&#x7684;&#x5730;&#x5740;&#x8303;&#x56F4;&#x7684;&#x7279;&#x6B8A;&#x8BBE;&#x8BA1;"><a href="#&#x9488;&#x5BF9;&#x4E0D;&#x9700;cache&#x7684;&#x5730;&#x5740;&#x8303;&#x56F4;&#x7684;&#x7279;&#x6B8A;&#x8BBE;&#x8BA1;" class="headerlink" title="&#x9488;&#x5BF9;&#x4E0D;&#x9700;cache&#x7684;&#x5730;&#x5740;&#x8303;&#x56F4;&#x7684;&#x7279;&#x6B8A;&#x8BBE;&#x8BA1;"></a>&#x9488;&#x5BF9;&#x4E0D;&#x9700;cache&#x7684;&#x5730;&#x5740;&#x8303;&#x56F4;&#x7684;&#x7279;&#x6B8A;&#x8BBE;&#x8BA1;</h4><p>&#x6211;&#x6240;&#x8BBE;&#x8BA1;&#x7684;CPU&#x91C7;&#x7528;memory mapped IO&#x8BBE;&#x8BA1;&#xFF0C;IO&#x4F7F;&#x7528;&#x8BBF;&#x5B58;&#x6307;&#x4EE4;&#x6765;&#x63A7;&#x5236;&#x3002;&#x5728;&#x4E0D;&#x63D0;&#x4F9B;&#x989D;&#x5916;&#x7684;&#x786C;&#x4EF6;&#x7F13;&#x5B58;&#x540C;&#x6B65;&#x673A;&#x5236;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;IO&#x6240;&#x4F7F;&#x7528;&#x7684;&#x5730;&#x5740;&#x8303;&#x56F4;&#x4F1A;&#x4EA7;&#x751F;cache&#x540C;&#x6B65;&#x95EE;&#x9898;&#x3002;&#x6211;&#x91C7;&#x53D6;MIPS&#x7684;&#x505A;&#x6CD5;&#xFF0C;&#x5728;&#x4E0D;&#x9700;&#x8981;cache&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x4E2D;&#x7ED5;&#x8FC7;cache&#x3002;<br>&#x5177;&#x4F53;&#x505A;&#x6CD5;&#x5E76;&#x4E0D;&#x590D;&#x6742;&#x3002;<br>&#x9996;&#x5148;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x5BC4;&#x5B58;&#x5668;NO_CACHE&#x5224;&#x65AD;&#x5F53;&#x524D;&#x8BF7;&#x6C42;&#x7684;&#x5730;&#x5740;&#x662F;&#x5426;&#x5728;&#x4E0D;&#x9700;&#x8981;cache&#x7684;&#x8303;&#x56F4;,&#x8BE5;&#x5BC4;&#x5B58;&#x5668;&#x4EC5;&#x5728;&#x83B7;&#x53D6;&#x65B0;&#x8BF7;&#x6C42;&#x65F6;&#x66F4;&#x65B0;&#x3002;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">reg</span> NO_CACHE;</span><br><span class="line"><span class="hljs-keyword">always</span>@(<span class="hljs-keyword">posedge</span> clk)</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-keyword">if</span> (clr) </span><br><span class="line">        NO_CACHE &lt;= <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (~ CPU_stall) </span><br><span class="line">        NO_CACHE &lt;= (addr &lt;= no_cache_end) &amp;&amp; (addr &gt;=no_cache_start);</span><br><span class="line"><span class="hljs-keyword">end</span></span><br></pre></td></tr></table></figure>
<p>&#x7136;&#x540E;&#x5F15;&#x5165;&#x7EC4;C&#x4F5C;&#x4E3A;&#x4F5C;&#x4E3A;&#x8FD9;no cache&#x533A;&#x57DF;&#x7684;&#x7F13;&#x5B58;&#x3002;&#x8BBE;&#x8BA1;&#x8FD9;&#x7EC4;&#x7F13;&#x5B58;&#x662F;&#x5FC5;&#x8981;&#x7684;&#xFF0C;&#x539F;&#x56E0;&#x4E0A;&#x9762;&#x5DF2;&#x7ECF;&#x4ECB;&#x7ECD;&#x4E86;&#x3002;&#x56E0;&#x4E3A;&#x6BCF;&#x6B21;&#x5BF9;&#x8FD9;&#x4E00;&#x5730;&#x5740;&#x8303;&#x56F4;&#x7684;&#x8BF7;&#x6C42;&#x90FD;&#x662F;cache&#x4E0D;&#x547D;&#x4E2D;&#xFF0C;&#x90FD;&#x9700;&#x8981;&#x4ECE;&#x603B;&#x7EBF;&#x4E0A;&#x83B7;&#x53D6;&#x6570;&#x636E;&#x3002;&#x603B;&#x7EBF;&#x4E0A;&#x7684;&#x6570;&#x636E;&#x4EC5;&#x4EC5;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x5468;&#x671F;&#x5373;&#x603B;&#x7EBF;ready&#x7684;&#x90A3;&#x4E2A;&#x5468;&#x671F;&#x3002;&#x5982;&#x679C;CPU&#x5728;&#x8FD9;&#x4E2A;&#x5468;&#x671F;&#x7531;&#x4E8E;&#x5176;&#x4ED6;&#x7684;&#x539F;&#x56E0;stall&#xFF0C;CPU&#x5C31;&#x4F1A;&#x9519;&#x8FC7;&#x603B;&#x7EBF;&#x4E0A;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x5728;&#x8FD9;&#x5F15;&#x5165;&#x989D;&#x5916;&#x7684;&#x4E00;&#x7EC4;C&#xFF0C;C&#x7EC4;&#x6CA1;&#x6709;TAG&#xFF0C;valid bits&#x53EA;&#x6709;&#x4E00;&#x4F4D;&#xFF0C;RAM&#x4E5F;&#x53EA;&#x6709;&#x4E00;&#x884C;&#xFF0C;&#x5728;&#x603B;&#x7EBF;ready&#x540E;&#xFF0C;&#x540C;&#x5176;&#x4ED6;&#x7EC4;&#x4E00;&#x6837;&#xFF0C;&#x5C06;&#x603B;&#x7EBF;&#x6765;&#x7684;&#x6570;&#x636E;&#x5199;&#x5165;&#x5230;RAM&#x540C;&#x65F6;&#x66F4;&#x65B0;valid bits&#xFF0C;&#x4E3A;CPU&#x63D0;&#x4F9B;cache&#x547D;&#x4E2D;&#x4FE1;&#x53F7;&#x3002;<br>&#x9664;&#x6B64;&#x4E4B;&#x5916;&#xFF0C;&#x7ED5;&#x8FC7;cache&#x7684;&#x673A;&#x5236;&#x4E5F;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x76F4;&#x63A5;&#x5728;&#x6BCF;&#x6B21;&#x65B0;&#x8BF7;&#x6C42;&#x53D1;&#x751F;&#x65F6;&#xFF0C;&#x5C06;C&#x7EC4;&#x7684;valid bit&#x6E05;&#x96F6;&#x5373;&#x53EF;&#x5B9E;&#x73B0;&#x6BCF;&#x6B21;&#x5BF9;no cache&#x533A;&#x57DF;&#x7684;&#x8BBF;&#x95EE;&#x90FD;&#x4E0D;&#x547D;&#x4E2D;&#x3002;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">reg</span> VALID_C;</span><br><span class="line"><span class="hljs-keyword">always</span> @(<span class="hljs-keyword">posedge</span> clk)</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-keyword">if</span> ((~CPU_stall) || clr )</span><br><span class="line">        VALID_C &lt;= <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (WE_C) </span><br><span class="line">        VALID_C &lt;= <span class="hljs-number">1</span>;</span><br><span class="line"><span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">reg</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] RAM_C;</span><br><span class="line"><span class="hljs-keyword">always</span> @(<span class="hljs-keyword">posedge</span> clk)</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-keyword">if</span> (WE_C)</span><br><span class="line">        RAM_C &lt;= RAM_in;</span><br><span class="line"><span class="hljs-keyword">end</span></span><br></pre></td></tr></table></figure>
<p>&#x5F15;&#x5165;C&#x7EC4;&#x7684;&#x597D;&#x5904;&#x662F;&#x5728;&#x63D0;&#x4F9B;&#x76EE;&#x6807;&#x529F;&#x80FD;&#x7684;&#x540C;&#x65F6;&#xFF0C;&#x7B80;&#x5316;&#x4E86;&#x63A7;&#x5236;&#x5355;&#x5143;&#x7684;&#x8BBE;&#x8BA1;&#xFF0C;&#x63A7;&#x5236;&#x5355;&#x5143;&#x53EA;&#x9700;&#x8981;&#x6839;&#x636E;NO_CACHE&#x5BC4;&#x5B58;&#x5668;&#x7684;&#x7ED3;&#x679C;&#x9009;&#x62E9;&#x76F8;&#x5E94;&#x7684;&#x4FE1;&#x53F7;&#x5373;&#x53EF;&#x3002;</p>
<h4 id="&#x5404;&#x7EC4;&#x7684;&#x66F4;&#x65B0;&#x4FE1;&#x53F7;"><a href="#&#x5404;&#x7EC4;&#x7684;&#x66F4;&#x65B0;&#x4FE1;&#x53F7;" class="headerlink" title="&#x5404;&#x7EC4;&#x7684;&#x66F4;&#x65B0;&#x4FE1;&#x53F7;"></a>&#x5404;&#x7EC4;&#x7684;&#x66F4;&#x65B0;&#x4FE1;&#x53F7;</h4><p>WE_A, WE_B, WE_C&#x4E3A;&#x4E09;&#x4E2A;&#x7EC4;&#x7684;&#x66F4;&#x65B0;&#x4FE1;&#x53F7;&#x3002;&#x8BE5;&#x4FE1;&#x53F7;&#x7531;cache&#x63A7;&#x5236;&#x5668;&#x8BA1;&#x7B97;&#xFF0C;&#x6BCF;&#x6B21;&#x66F4;&#x65B0;&#x53EA;&#x6709;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x6709;&#x6548;&#x3002;</p>
<h3 id="cache&#x63A7;&#x5236;&#x5668;&#x7684;&#x8BBE;&#x8BA1;&#x4E0E;&#x5B9E;&#x73B0;"><a href="#cache&#x63A7;&#x5236;&#x5668;&#x7684;&#x8BBE;&#x8BA1;&#x4E0E;&#x5B9E;&#x73B0;" class="headerlink" title="cache&#x63A7;&#x5236;&#x5668;&#x7684;&#x8BBE;&#x8BA1;&#x4E0E;&#x5B9E;&#x73B0;"></a>cache&#x63A7;&#x5236;&#x5668;&#x7684;&#x8BBE;&#x8BA1;&#x4E0E;&#x5B9E;&#x73B0;</h3><p>cache&#x63A7;&#x5236;&#x5668;&#x4E3B;&#x8981;&#x89E3;&#x51B3;&#x4E09;&#x65B9;&#x9762;&#x7684;&#x95EE;&#x9898;&#xFF1A;</p>
<ol>
<li>&#x547D;&#x4E2D;&#x4FE1;&#x53F7;&#x7684;&#x903B;&#x8F91;</li>
<li>&#x4E0D;&#x547D;&#x4E2D;&#x65F6;&#x7684;cache&#x66FF;&#x6362;</li>
<li>&#x5199;&#x5165;cache&#x7684;&#x5185;&#x5BB9;&#x548C;&#x5411;CPU&#x8F93;&#x51FA;&#x7684;&#x5185;&#x5BB9;&#x7684;&#x9009;&#x62E9;</li>
</ol>
<h4 id="cache&#x547D;&#x4E2D;&#x4FE1;&#x53F7;ready-o"><a href="#cache&#x547D;&#x4E2D;&#x4FE1;&#x53F7;ready-o" class="headerlink" title="cache&#x547D;&#x4E2D;&#x4FE1;&#x53F7;ready_o"></a>cache&#x547D;&#x4E2D;&#x4FE1;&#x53F7;ready_o</h4><p>&#x4E0A;&#x6587;&#x4E2D;&#x6211;&#x5DF2;&#x63D0;&#x5230;&#xFF0C;BUS&#x4E0A;&#x7684;&#x6570;&#x636E;&#x53EA;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x5468;&#x671F;&#xFF0C;&#x4F46;&#x662F;CPU&#x53EF;&#x80FD;&#x5728;&#x8FD9;&#x4E2A;&#x5468;&#x671F;&#x56E0;&#x4E3A;&#x5176;&#x4ED6;&#x539F;&#x56E0;&#x6682;&#x505C;&#x3002;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x5FC5;&#x987B;&#x5728;&#x603B;&#x7EBF;&#x5C31;&#x7EEA;&#x65F6;&#x5C06;&#x6570;&#x636E;&#x4FDD;&#x5B58;&#x5728;cache&#x5185;&#x90E8;&#x3002;&#x8FD9;&#x6837;&#x7684;&#x64CD;&#x4F5C;&#x81EA;&#x7136;&#x5E94;&#x8BE5;&#x5305;&#x542B;BUS&#x7684;ready&#x4FE1;&#x53F7;&#x3002;<br>&#x5F15;&#x5165;&#x4E00;&#x4E2A;&#x5BC4;&#x5B58;&#x5668;ready_reg&#x4FDD;&#x5B58;&#x4ECE;&#x603B;&#x7EBF;&#x4E0A;&#x63A5;&#x6536;&#x7684;&#x5C31;&#x7EEA;&#x4FE1;&#x53F7;, &#x8BE5;&#x5BC4;&#x5B58;&#x5668;&#x5728;&#x65B0;&#x8BF7;&#x6C42;&#x5230;&#x6765;&#x65F6;&#x6E05;&#x96F6;&#x3002;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">reg</span> ready_reg;</span><br><span class="line"><span class="hljs-keyword">always</span> @(<span class="hljs-keyword">posedge</span> clk)</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-keyword">if</span> (~CPU_stall)</span><br><span class="line">        ready_reg &lt;= <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (CPU_req_reg &amp;&amp; ready_in)</span><br><span class="line">        ready_reg &lt;= <span class="hljs-number">1</span>;</span><br><span class="line"><span class="hljs-keyword">end</span></span><br></pre></td></tr></table></figure>
<p>&#x9488;&#x5BF9;&#x4E09;&#x4E2A;&#x7EC4;&#xFF0C;&#x6BCF;&#x4E2A;&#x7EC4;&#x90FD;&#x8981;&#x6709;&#x5355;&#x72EC;&#x7684;&#x547D;&#x4E2D;&#x4FE1;&#x53F7;&#x3002;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">wire</span> HIT_A = tag_reg == TAG_A_out &amp;&amp; VALID_A_out;</span><br><span class="line"><span class="hljs-keyword">wire</span> HIT_B = tag_reg == TAG_B_out &amp;&amp; VALID_B_out;</span><br><span class="line"><span class="hljs-keyword">wire</span> HIT_C = VALID_C;</span><br></pre></td></tr></table></figure>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5728;AB&#x4E24;&#x7EC4;&#x7684;&#x547D;&#x4E2D;&#x4FE1;&#x53F7;&#x6BD4;&#x5BF9;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x4F7F;&#x7528;&#x7684;&#x5168;&#x90E8;&#x662F;&#x7ECF;&#x8FC7;&#x5BC4;&#x5B58;&#x5668;&#x540C;&#x6B65;&#x7684;&#x503C;&#xFF0C;&#x8FD9;&#x907F;&#x514D;&#x4E86;&#x4ECE;cpu_stall&#x5230;ready_o&#x4E4B;&#x95F4;&#x7684;&#x7EC4;&#x5408;&#x903B;&#x8F91;&#x73AF;&#x3002;<br>&#x6709;&#x4E86;&#x5404;&#x7EC4;&#x7684;&#x547D;&#x4E2D;&#x4FE1;&#x53F7;&#x540E;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x4E3A;&#x8BFB;&#x8BF7;&#x6C42;&#x8BBE;&#x7F6E;&#x547D;&#x4E2D;&#x4FE1;&#x53F7;&#x3002;&#x82E5;&#x8BF7;&#x6C42;&#x5728;no cache&#x8303;&#x56F4;&#xFF0C;&#x5219;&#x4EE5;HIT_C&#x4E3A;&#x51C6;&#xFF0C;&#x5426;&#x5219;&#x4E0E;AB&#x7684;&#x6216;&#x4E3A;&#x51C6;&#x3002;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">wire</span> CACHE_HIT_R = NO_CACHE ? HIT_C : (HIT_A || HIT_B);</span><br></pre></td></tr></table></figure>
<p>&#x6700;&#x7EC8;&#x7684;&#x547D;&#x4E2D;&#x4FE1;&#x53F7;ready_o&#x8FD8;&#x4E0E;&#x4E00;&#x4E9B;&#x5176;&#x4ED6;&#x7684;&#x4FE1;&#x53F7;&#x76F8;&#x5173;&#xFF1A;</p>
<ul>
<li>&#x5982;&#x679C;&#x6B64;&#x65F6;&#x5E76;&#x6CA1;&#x6709;&#x8BF7;&#x6C42;cache&#xFF08;cpu_req_reg == 0)&#xFF0C;&#x5219;&#x5E94;&#x76F4;&#x63A5;&#x7ED9;&#x51FA;&#x547D;&#x4E2D;&#x4FE1;&#x53F7;&#xFF0C;&#x901A;&#x77E5;CPU&#x7EE7;&#x7EED;&#x5DE5;&#x4F5C;&#x3002;</li>
<li>&#x5982;&#x679C;&#x662F;&#x5199;&#x8BF7;&#x6C42;&#xFF0C;&#x5219;&#x547D;&#x4E2D;&#x4FE1;&#x53F7;&#x5E94;&#x662F;&#x603B;&#x7EBF;&#x5C31;&#x7EEA;&#x4FE1;&#x53F7;&#x4E0E;ready_reg&#x7684;&#x903B;&#x8F91;&#x6216;&#x3002;</li>
<li>&#x5982;&#x679C;&#x662F;&#x8BFB;&#x8BF7;&#x6C42;&#xFF0C;&#x5219;&#x547D;&#x4E2D;&#x4FE1;&#x53F7;&#x5E94;&#x662F;&#x603B;&#x7EBF;&#x5C31;&#x7EEA;&#x4FE1;&#x53F7;&#x4E0E;&#x8BFB;&#x547D;&#x4E2D;&#x4FE1;&#x53F7;(CACHE_HIT_R)&#x7684;&#x903B;&#x8F91;&#x6216;&#x3002;<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">always</span> @(*)</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-keyword">if</span> (~CPU_req_reg)</span><br><span class="line">        ready_o &lt;= <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (CPU_RW_reg) </span><br><span class="line">        ready_o &lt;= (CPU_req_reg &amp;&amp; ready_in) || ready_reg;</span><br><span class="line">    <span class="hljs-keyword">else</span> </span><br><span class="line">        ready_o &lt;= (CPU_req_reg &amp;&amp; ready_in) || CACHE_HIT_R;</span><br><span class="line"><span class="hljs-keyword">end</span></span><br></pre></td></tr></table></figure>
&#x603B;&#x7EBF;&#x5C31;&#x7EEA;&#x4FE1;&#x53F7;&#x4F7F;&#x7528;&#x8BF7;&#x6C42;&#x4FE1;&#x53F7;&#x8FDB;&#x884C;&#x8FC7;&#x6EE4;&#xFF0C;&#x9632;&#x6B62;&#x9AD8;&#x963B;&#x6001;&#x7684;ready&#x5E72;&#x6270;&#x3002;</li>
</ul>
<h4 id="cache&#x66FF;&#x6362;&#x63A7;&#x5236;"><a href="#cache&#x66FF;&#x6362;&#x63A7;&#x5236;" class="headerlink" title="cache&#x66FF;&#x6362;&#x63A7;&#x5236;"></a>cache&#x66FF;&#x6362;&#x63A7;&#x5236;</h4><p>&#x5F53;&#x8BFB;&#x4E0D;&#x547D;&#x4E2D;&#x6216;&#x6709;&#x5199;&#x8BF7;&#x6C42;&#x65F6;&#xFF0C;&#x8981;&#x8FDB;&#x884C;cache&#x7684;&#x66F4;&#x65B0;&#x3002;Cache&#x7684;&#x66F4;&#x65B0;&#x673A;&#x5236;&#x4E3B;&#x8981;&#x89E3;&#x51B3;&#x4E24;&#x4E2A;&#x95EE;&#x9898;&#xFF1A;</p>
<ol>
<li>&#x4F55;&#x65F6;&#x66F4;&#x65B0;&#xFF1F;</li>
<li>&#x66F4;&#x65B0;&#x90A3;&#x4E00;&#x7EC4;&#xFF1F;</li>
</ol>
<p>&#x7B2C;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x975E;&#x5E38;&#x7B80;&#x5355;&#xFF0C;&#x5F53;&#x4E14;&#x4EC5;&#x5F53;&#x603B;&#x7EBF;&#x4E0A;&#x6570;&#x636E;&#x51C6;&#x5907;&#x597D;&#x7684;&#x65F6;&#x5019;&#x66F4;&#x65B0;cache&#xFF0C;&#x56E0;&#x4E3A;&#x6240;&#x6709;&#x7684;&#x4E0D;&#x547D;&#x4E2D;&#x90FD;&#x9700;&#x8981;&#x8BF7;&#x6C42;&#x603B;&#x7EBF;&#x3002;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">wire</span> need_update = BUS_grant &amp;&amp; ready_in;</span><br></pre></td></tr></table></figure>

<p>&#x7B2C;&#x4E8C;&#x4E2A;&#x95EE;&#x9898;&#x7A0D;&#x5FAE;&#x590D;&#x6742;&#x4E00;&#x4E9B;&#x3002;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x968F;&#x673A;&#x66FF;&#x6362;&#x7B56;&#x7565;&#xFF0C;&#x9996;&#x5148;&#x8981;&#x8BBE;&#x8BA1;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x968F;&#x673A;&#x6570;&#x4EA7;&#x751F;&#x5668;&#x3002;&#x8FD9;&#x91CC;&#x6211;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x8BA1;&#x6570;&#x5668;&#x4F5C;&#x4E3A;&#x968F;&#x673A;&#x6570;&#x4EA7;&#x751F;&#x5668;&#x3002;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">reg</span> random;</span><br><span class="line"><span class="hljs-keyword">always</span> @(<span class="hljs-keyword">posedge</span> clk)</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    random &lt;= random+ <span class="hljs-number">1&apos;b1</span>;</span><br><span class="line"><span class="hljs-keyword">end</span></span><br></pre></td></tr></table></figure>
<p>&#x5BF9;&#x4E8E;&#x4E0D;&#x9700;&#x8981;cache&#x7684;&#x5730;&#x5740;&#x8303;&#x56F4;&#xFF0C;&#x5904;&#x7406;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#x3002;&#x56E0;&#x4E3A;&#x7EC4;C&#x53EA;&#x6709;&#x4E00;&#x884C;&#xFF0C;&#x56E0;&#x6B64;&#x76F4;&#x63A5;&#x66FF;&#x6362;&#x5373;&#x53EF;&#x3002;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">assign</span> WE_C = NO_CACHE &amp;&amp; need_update;</span><br></pre></td></tr></table></figure>
<p>&#x5BF9;&#x4E8E;&#x6B63;&#x5E38;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x5904;&#x7406;&#x7A0D;&#x5FAE;&#x9EBB;&#x70E6;&#x4E00;&#x4E9B;&#xFF0C;&#x5E76;&#x4E0D;&#x662F;&#x5F88;&#x591A;&#x8BFB;&#x8005;&#x60F3;&#x8C61;&#x7684;&#x76F4;&#x63A5;&#x5229;&#x7528;&#x4E0A;&#x9762;&#x63CF;&#x8FF0;&#x7684;&#x968F;&#x673A;&#x6570;&#x4EA7;&#x751F;&#x5668;&#x3002;<br>&#x8003;&#x8651;&#x8FD9;&#x6837;&#x7684;&#x51E0;&#x79CD;&#x60C5;&#x51B5;&#xFF1A;</p>
<ul>
<li>&#x5982;&#x679C;&#x4E00;&#x884C;&#x5185;&#x7684;&#x4E24;&#x7EC4;&#x69FD;&#x4F4D;&#xFF0C;&#x6709;&#x4E00;&#x4E2A;&#x662F;&#x7A7A;&#x7684;&#x5E94;&#x8BE5;&#xFF0C;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5F80;&#x7A7A;&#x7684;&#x7EC4;&#x586B;&#x5199;&#x6570;&#x636E;&#x5417;&#xFF1F;<br>  &#x5F88;&#x9057;&#x61BE;&#x7B54;&#x6848;&#x662F;&#x5426;&#x5B9A;&#x7684;&#x3002;</li>
<li>&#x5982;&#x679C;&#x4E24;&#x7EC4;&#x90FD;&#x662F;&#x6EE1;&#x7684;&#xFF0C;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x968F;&#x673A;&#x66FF;&#x6362;&#x5417;&#xFF1F;<br>   &#x5F88;&#x9057;&#x61BE;&#x7B54;&#x6848;&#x8FD8;&#x662F;&#x5426;&#x5B9A;&#x7684;&#x3002;</li>
</ul>
<p>&#x4E3A;&#x4EC0;&#x4E48;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x968F;&#x5373;&#x66FF;&#x6362;&#x5462;&#xFF1F;&#x8FD9;&#x91CC;&#x6709;&#x4E00;&#x79CD;&#x7279;&#x6B8A;&#x60C5;&#x51B5;&#xFF1A;<br>&#x5982;&#x679C;&#x4E24;&#x7EC4;&#x90FD;&#x662F;&#x6EE1;&#x7684;&#xFF0C;A&#x5185;&#x5B58;&#x653E;&#x5730;&#x5740;0&#x7684;&#x7F13;&#x5B58;&#xFF0C;B&#x5185;&#x5B58;&#x653E;&#x5730;&#x5740;8&#x7684;&#x7F13;&#x5B58;&#x3002;&#x6B64;&#x65F6;&#x6211;&#x9700;&#x8981;&#x5411;&#x5730;&#x5740;0&#x518D;&#x6B21;&#x5199;&#x5165;&#x65B0;&#x503C;&#x3002;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#x80FD;&#x4F7F;&#x7528;&#x968F;&#x673A;&#x66FF;&#x6362;&#x5417;&#xFF1F;&#x7B54;&#x6848;&#x5F53;&#x7136;&#x662F;&#x5426;&#x5B9A;&#x7684;&#x3002;&#x6211;&#x4EEC;&#x5E94;&#x8BE5;&#x4F18;&#x5148;&#x66FF;&#x6362;TAG&#x76F8;&#x540C;&#x7684;&#x7EC4;&#x3002;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#x5E94;&#x5F53;&#x5C06;&#x5BF9;&#x5730;&#x5740;0&#x5199;&#x5165;&#x7684;&#x65B0;&#x503C;&#x76F4;&#x63A5;&#x653E;&#x5165;&#x539F;&#x6765;&#x5C31;&#x5B58;&#x653E;&#x5730;&#x5740;0&#x7684;&#x7EC4;A&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x968F;&#x673A;&#x66FF;&#x6362;&#x7EC4;B&#x3002;&#x8FD9;&#x6837;&#x505A;&#x9664;&#x4E86;&#x6709;&#x6027;&#x80FD;&#x4F18;&#x52BF;&#x4EE5;&#x5916;&#xFF0C;&#x8FD8;&#x4FDD;&#x8BC1;&#x4E86;cache&#x4E0D;&#x53D1;&#x751F;&#x610F;&#x5916;&#x5730;&#x9519;&#x8BEF;&#x3002;&#x5982;&#x679C;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x968F;&#x5373;&#x66FF;&#x6362;&#x66FF;&#x6362;&#x6389;&#x4E86;B&#x7EC4;&#xFF0C;&#x5219;cache&#x5185;&#x4F1A;&#x6709;&#x4E24;&#x6761;&#x5173;&#x4E8E;&#x5730;&#x5740;0&#x7684;&#x8BB0;&#x5F55;&#xFF0C;&#x5728;&#x6CA1;&#x6709;&#x989D;&#x5916;&#x7684;&#x63AA;&#x65BD;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x8FD9;&#x5C31;&#x76F4;&#x63A5;&#x5F15;&#x8D77;&#x4E86;&#x9519;&#x8BEF;&#xFF01;CPU&#x4E0D;&#x77E5;&#x9053;&#x90A3;&#x4E2A;&#x6570;&#x636E;&#x662F;&#x6B63;&#x786E;&#x7684;&#x3002;<br>&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x786E;&#x5B9A;&#x4E86;&#x4F7F;&#x7528;&#x968F;&#x673A;&#x66FF;&#x6362;&#x65F6;&#x7684;&#x7B56;&#x7565;&#xFF1A;</p>
<ul>
<li>&#x82E5;cache&#x5185;&#x5DF2;&#x7ECF;&#x5B58;&#x653E;&#x6709;&#x8BE5;&#x5730;&#x5740;&#x7684;&#x8BB0;&#x5F55;&#xFF0C;&#x76F4;&#x63A5;&#x66FF;&#x6362;&#x8FD9;&#x4E00;&#x7EC4;&#xFF0C;&#x4E0D;&#x4F7F;&#x7528;&#x968F;&#x673A;&#x66FF;&#x6362;&#x3002;</li>
<li>&#x5426;&#x5219;&#x518D;&#x770B;&#x662F;&#x5426;&#x6709;&#x7A7A;&#x95F2;&#x7684;&#x7EC4;&#xFF0C;&#x5982;&#x6709;&#x5219;&#x653E;&#x5165;&#x7A7A;&#x95F2;&#x7EC4;&#xFF0C;&#x5426;&#x5219;&#x4F7F;&#x7528;&#x968F;&#x5373;&#x66FF;&#x6362;&#x3002;<br>&#x4FE1;&#x53F7;WE_A,WE_B&#x5B9E;&#x73B0;&#x4E86;&#x4E0A;&#x8FF0;&#x903B;&#x8F91;&#xFF1A;<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">reg</span> [<span class="hljs-number">1</span>:<span class="hljs-number">0</span>] group_sel;</span><br><span class="line"><span class="hljs-keyword">always</span> @(*)</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-comment">//replace group with the same tag first.</span></span><br><span class="line">    <span class="hljs-keyword">if</span> (TAG_A_out == tag_reg)</span><br><span class="line">        group_sel &lt;= <span class="hljs-number">2&apos;b01</span>;</span><br><span class="line">    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (TAG_B_out ==tag_reg)</span><br><span class="line">        group_sel &lt;= <span class="hljs-number">2&apos;b10</span>;</span><br><span class="line">    <span class="hljs-comment">//if both group is empty or valid, randomly choose one group.</span></span><br><span class="line">    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (VALID_A_out == VALID_B_out)</span><br><span class="line">        group_sel &lt;= random ? <span class="hljs-number">2&apos;b01</span> : <span class="hljs-number">2&apos;b10</span>;</span><br><span class="line">    <span class="hljs-comment">//if only one group is empty, choose the empty group.</span></span><br><span class="line">    <span class="hljs-keyword">else</span></span><br><span class="line">        group_sel &lt;= VALID_A_out ? <span class="hljs-number">2&apos;b10</span> : <span class="hljs-number">2&apos;b01</span>;</span><br><span class="line"><span class="hljs-keyword">end</span></span><br><span class="line"><span class="hljs-comment">//only when requested address is in cache range, WE_A or WE_B can be active.</span></span><br><span class="line"><span class="hljs-keyword">assign</span> WE_A = (~NO_CACHE) &amp;&amp; need_update &amp;&amp; group_sel[<span class="hljs-number">0</span>];</span><br><span class="line"><span class="hljs-keyword">assign</span> WE_B = (~NO_CACHE) &amp;&amp; need_update &amp;&amp; group_sel[<span class="hljs-number">1</span>];</span><br></pre></td></tr></table></figure>
&#x9700;&#x8981;&#x7559;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x7684;&#x63A7;&#x5236;&#x4FE1;&#x53F7;&#x4E5F;&#x90FD;&#x662F;&#x7ECF;&#x8FC7;&#x5BC4;&#x5B58;&#x5668;&#x540C;&#x6B65;&#x8FC7;&#x7684;&#xFF0C;&#x8FD9;&#x6837;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x7EC4;&#x5408;&#x903B;&#x8F91;&#x73AF;&#x3002;</li>
</ul>
<h4 id="&#x5411;cache&#x5185;&#x5199;&#x5165;&#x7684;&#x6570;&#x636E;&#x548C;&#x5BF9;CPU&#x8F93;&#x51FA;&#x7684;&#x6570;&#x636E;&#x9009;&#x62E9;"><a href="#&#x5411;cache&#x5185;&#x5199;&#x5165;&#x7684;&#x6570;&#x636E;&#x548C;&#x5BF9;CPU&#x8F93;&#x51FA;&#x7684;&#x6570;&#x636E;&#x9009;&#x62E9;" class="headerlink" title="&#x5411;cache&#x5185;&#x5199;&#x5165;&#x7684;&#x6570;&#x636E;&#x548C;&#x5BF9;CPU&#x8F93;&#x51FA;&#x7684;&#x6570;&#x636E;&#x9009;&#x62E9;"></a>&#x5411;cache&#x5185;&#x5199;&#x5165;&#x7684;&#x6570;&#x636E;&#x548C;&#x5BF9;CPU&#x8F93;&#x51FA;&#x7684;&#x6570;&#x636E;&#x9009;&#x62E9;</h4><p>&#x6211;&#x4EEC;&#x9700;&#x8981;&#x6839;&#x636E;&#x8BFB;&#x3001;&#x5199;&#x8BF7;&#x6C42;&#x7684;&#x4E0D;&#x540C;&#x4EE5;&#x53CA;&#x603B;&#x7EBF;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x9009;&#x62E9;&#x5411;cache&#x5185;&#x5199;&#x5165;&#x7684;&#x6570;&#x636E;RAM_in&#x548C;&#x5411;CPU&#x8F93;&#x51FA;&#x7684;&#x4FE1;&#x53F7;data_o.<br>&#x5BF9;&#x4E8E;RAM_in&#x3002;&#x8BFB;&#x8BF7;&#x6C42;&#x65F6;&#xFF0C;&#x5E94;&#x9009;&#x62E9;&#x603B;&#x7EBF;&#x4E0A;&#x7684;&#x6570;&#x636E;BUS_data;&#x5199;&#x8BF7;&#x6C42;&#x65F6;&#x5E94;&#x9009;&#x62E9;CPU&#x4ECE;&#x4E0A;&#x4E00;&#x7EA7;&#x6D41;&#x6C34;&#x7EBF;&#x8F93;&#x5165;&#x7684;&#x6570;&#x636E;data_reg.</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">assign</span> RAM_in = CPU_RW_reg ? data_reg : BUS_data;</span><br></pre></td></tr></table></figure>

<p>&#x5BF9;&#x4E8E;data_o&#x3002;&#x82E5;&#x662F;&#x5199;&#x8BF7;&#x6C42;&#xFF0C;&#x5219;&#x4E0D;&#x9700;&#x8981;&#x5411;cpu&#x8F93;&#x51FA;&#x6570;&#x636E;&#xFF1B;&#x82E5;&#x662F;&#x8BFB;&#x8BF7;&#x6C42;&#xFF0C;&#x5F53;&#x603B;&#x7EBF;&#x51C6;&#x5907;&#x5C31;&#x7EEA;&#x65F6;&#xFF0C;&#x603B;&#x662F;&#x9009;&#x62E9;&#x603B;&#x7EBF;&#x4E0A;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x82E5;&#x9519;&#x8FC7;&#x4E86;&#x603B;&#x7EBF;&#x7684;&#x5C31;&#x7EEA;&#x4FE1;&#x53F7;&#xFF0C;&#x5219;&#x6309;&#x7167;&#x5404;&#x7EC4;&#x7684;&#x547D;&#x4E2D;&#x60C5;&#x51B5;&#xFF0C;&#x9009;&#x62E9;&#x5404;&#x7EC4;&#x7684;RAM&#x4F5C;&#x4E3A;&#x8F93;&#x51FA;&#x3002;&#x5176;&#x5B9E;&#x73B0;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">always</span>@(*)</span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    <span class="hljs-keyword">if</span> (CPU_RW_reg)</span><br><span class="line">        data_o &lt;= <span class="hljs-number">32&apos;b0</span>;</span><br><span class="line">    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ready_in)</span><br><span class="line">        data_o &lt;= BUS_data;</span><br><span class="line">    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (NO_CACHE)</span><br><span class="line">        data_o &lt;= RAM_C_out;</span><br><span class="line">    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (HIT_A)</span><br><span class="line">        data_o &lt;= RAM_A_out;</span><br><span class="line">    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (HIT_B)</span><br><span class="line">        data_o &lt;= RAM_B_out;</span><br><span class="line">    <span class="hljs-keyword">else</span></span><br><span class="line">        data_o &lt;= <span class="hljs-number">32&apos;b0</span>;</span><br><span class="line"><span class="hljs-keyword">end</span></span><br></pre></td></tr></table></figure>

<p>&#x81F3;&#x6B64;&#x8FD9;&#x4E2A;&#x7B26;&#x5408;&#x4E0A;&#x6587;&#x6240;&#x8FF0;&#x7684;&#x8BBE;&#x8BA1;&#x76EE;&#x6807;&#x7684;cache&#x6A21;&#x5757;&#x8BBE;&#x8BA1;&#x5B8C;&#x6BD5;&#x4E86;&#x3002;&#x63A5;&#x4E0B;&#x6765;&#x662F;&#x7E41;&#x7410;&#x7684;&#x6D4B;&#x8BD5;&#x5DE5;&#x4F5C;&#x3002;</p>
<h2 id="&#x7EC4;&#x76F8;&#x8054;cache&#x7684;&#x4EFF;&#x771F;&#x3001;&#x6D4B;&#x8BD5;"><a href="#&#x7EC4;&#x76F8;&#x8054;cache&#x7684;&#x4EFF;&#x771F;&#x3001;&#x6D4B;&#x8BD5;" class="headerlink" title="&#x7EC4;&#x76F8;&#x8054;cache&#x7684;&#x4EFF;&#x771F;&#x3001;&#x6D4B;&#x8BD5;"></a>&#x7EC4;&#x76F8;&#x8054;cache&#x7684;&#x4EFF;&#x771F;&#x3001;&#x6D4B;&#x8BD5;</h2><p>&#x4ECE;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x7684;&#x7BC7;&#x5E45;&#x6765;&#x770B;&#xFF0C;&#x8FD9;&#x7EDD;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x7CFB;&#x7EDF;&#xFF0C;&#x56E0;&#x6B64;&#x5176;&#x6D4B;&#x8BD5;&#x4E5F;&#x9700;&#x8981;&#x4ED4;&#x7EC6;&#x8003;&#x91CF;&#x3002;&#x672C;&#x6587;&#x5F00;&#x5934;&#x6240;&#x63CF;&#x8FF0;&#x7684;&#x8BBE;&#x8BA1;&#x76EE;&#x6807;&#x5E94;&#x5F53;&#x5168;&#x90E8;&#x5305;&#x542B;&#x5728;&#x6D4B;&#x8BD5;&#x4E2D;&#x3002;&#x7ECF;&#x8FC7;&#x6211;&#x7684;&#x601D;&#x8003;&#xFF0C;&#x786E;&#x5B9A;&#x4E86;&#x6D4B;&#x8BD5;&#x7684;&#x6D41;&#x7A0B;&#xFF1A;&#x5BF9;&#x4E8E;&#x529F;&#x80FD;&#x6D4B;&#x8BD5;&#xFF0C;&#x5747;&#x91C7;&#x7528;&#x5355;&#x4E2A;cache&#x5B9E;&#x4F8B;&#xFF1B;&#x5728;&#x901A;&#x8FC7;&#x4E86;&#x529F;&#x80FD;&#x6D4B;&#x8BD5;&#x540E;&#xFF0C;&#x4F7F;&#x7528;&#x591A;&#x4E2A;cache&#x5B9E;&#x4F8B;&#x6D4B;&#x8BD5;&#x5176;&#x8054;&#x5408;&#x8BBF;&#x95EE;&#x603B;&#x7EBF;&#x3002;&#x8FD9;&#x6837;&#x505A;&#x662F;&#x5408;&#x7406;&#x7684;&#xFF0C;&#x786E;&#x4FDD;&#x5355;&#x4E2A;cache&#x529F;&#x80FD;&#x6B63;&#x5E38;&#xFF0C;&#x591A;&#x4E2A;cache&#x8054;&#x5408;&#x8BBF;&#x5B58;&#x6B63;&#x5E38;&#x5373;&#x53EF;&#x8BF4;&#x660E;&#x8FBE;&#x5230;&#x4E86;&#x8BBE;&#x8BA1;&#x76EE;&#x6807;&#x3002;</p>
<h3 id="&#x9488;&#x5BF9;&#x5355;&#x4E2A;cache&#x7684;&#x529F;&#x80FD;&#x6D4B;&#x8BD5;"><a href="#&#x9488;&#x5BF9;&#x5355;&#x4E2A;cache&#x7684;&#x529F;&#x80FD;&#x6D4B;&#x8BD5;" class="headerlink" title="&#x9488;&#x5BF9;&#x5355;&#x4E2A;cache&#x7684;&#x529F;&#x80FD;&#x6D4B;&#x8BD5;"></a>&#x9488;&#x5BF9;&#x5355;&#x4E2A;cache&#x7684;&#x529F;&#x80FD;&#x6D4B;&#x8BD5;</h3><p>&#x9996;&#x5148;&#x51C6;&#x5907;&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;&#x3002;<br>&#x5148;&#x5B9A;&#x4E49;&#x603B;&#x7EBF;&#x4FE1;&#x53F7;&#xFF1A;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">wire</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] BUS_addr, BUS_data;</span><br><span class="line"><span class="hljs-keyword">wire</span> BUS_req, BUS_ready, BUS_RW;</span><br><span class="line"><span class="hljs-keyword">wire</span> [<span class="hljs-number">7</span>:<span class="hljs-number">0</span>] DMA, grant;</span><br></pre></td></tr></table></figure>
<p>&#x7136;&#x540E;&#x5B9E;&#x4F8B;&#x5316;&#x5355;&#x4E2A;cache&#x548C;&#x6A21;&#x62DF;&#x7684;&#x5185;&#x5B58;&#x63A7;&#x5236;&#x5668;&#xFF0C;&#x5B9E;&#x4F8B;&#x5316;&#x603B;&#x7EBF;&#x63A7;&#x5236;&#x5668;&#xFF0C;&#x5E76;&#x5C06;&#x4ED6;&#x4EEC;&#x8FDE;&#x63A5;&#x5230;&#x603B;&#x7EBF;&#x4E0A;&#x3002;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">//hook up the bus controller</span></span><br><span class="line">bus_control bus_control_0 (DMA,grant,BUS_req, BUS_ready,clk);</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">//hook up the simulated memory</span></span><br><span class="line">dummy_slave memory(clk,BUS_addr,BUS_data,BUS_req,BUS_ready,BUS_RW);</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">//hook up the simulated instruction cache</span></span><br><span class="line">cache I_cache (CPU_stall,next_pc , data[i] , <span class="hljs-number">1&apos;b1</span>, rw[i], <span class="hljs-number">1&apos;b0</span>, CPU_data, CPU_ready, PC,</span><br><span class="line">                BUS_addr, BUS_data, DMA[<span class="hljs-number">0</span>], BUS_RW, grant[<span class="hljs-number">0</span>], BUS_ready, clr, clk,</span><br><span class="line">                we_a,we_b,we_c,needupdate,tag,hitA,hitB,RAM_A_out);</span><br></pre></td></tr></table></figure>
<p>&#x53EF;&#x4EE5;&#x6CE8;&#x610F;&#x5230;&#x8FD9;&#x4E2A;cache&#x5B9E;&#x4F8B;&#x662F;&#x8FDE;&#x63A5;&#x5728;DMA[0]&#x4E0A;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x4ED6;&#x5177;&#x6709;&#x6700;&#x9AD8;&#x7684;&#x603B;&#x7EBF;&#x4F18;&#x5148;&#x7EA7;&#x3002;<br>&#x8BBE;&#x7F6E;&#x6A21;&#x62DF;&#x7684;CPU_stall&#x4FE1;&#x53F7;:</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">wire</span> CPU_stall = clr ? <span class="hljs-number">0</span>: ~(CPU_ready &amp;&amp; <span class="hljs-number">1</span>);</span><br></pre></td></tr></table></figure>
<p>&#x7136;&#x540E;&#x5C31;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E0D;&#x540C;&#x7684;&#x9884;&#x8BBE;&#x8BF7;&#x6C42;&#x5E8F;&#x5217;&#x6765;&#x6D4B;&#x8BD5;cache&#x7684;&#x529F;&#x80FD;&#x3002;</p>
<h4 id="&#x521D;&#x6B65;&#x6D4B;&#x8BD5;"><a href="#&#x521D;&#x6B65;&#x6D4B;&#x8BD5;" class="headerlink" title="&#x521D;&#x6B65;&#x6D4B;&#x8BD5;"></a>&#x521D;&#x6B65;&#x6D4B;&#x8BD5;</h4><p>&#x6D4B;&#x8BD5;&#x4E86;cache&#x7684;&#x57FA;&#x672C;&#x529F;&#x80FD;:</p>
<ul>
<li>&#x8BFB;&#x4E0D;&#x547D;&#x4E2D;&#x3001;&#x8BFB;&#x547D;&#x4E2D;</li>
<li>&#x5199;&#x4E0D;&#x547D;&#x4E2D;&#xFF0C;&#x8FDE;&#x7EED;&#x5199;&#x4E0D;&#x547D;&#x4E2D;&#xFF0C;&#x5199;&#x540E;&#x8BFB;&#x547D;&#x4E2D;</li>
<li>&#x8BFB;&#x5199;no cache&#x8303;&#x56F4;<br>&#x4F7F;&#x7528;&#x5982;&#x4E0B;&#x7684;&#x6D4B;&#x8BD5;&#x5E8F;&#x5217;<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">reg</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] address [<span class="hljs-number">0</span>:<span class="hljs-number">7</span>] ;</span><br><span class="line"><span class="hljs-keyword">initial</span></span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    address[<span class="hljs-number">0</span>]= <span class="hljs-number">0</span> ;</span><br><span class="line">    address[<span class="hljs-number">1</span>]= <span class="hljs-number">4</span> ;</span><br><span class="line">    address[<span class="hljs-number">2</span>]= <span class="hljs-number">0</span> ; <span class="hljs-comment">//cache hit</span></span><br><span class="line">    address[<span class="hljs-number">3</span>]= <span class="hljs-number">16</span> ;<span class="hljs-comment">//write</span></span><br><span class="line">    address[<span class="hljs-number">4</span>]= <span class="hljs-number">16</span> ;<span class="hljs-comment">//read</span></span><br><span class="line">    address[<span class="hljs-number">5</span>]= <span class="hljs-number">8</span> ; <span class="hljs-comment">//read in no cache zone</span></span><br><span class="line">    address[<span class="hljs-number">6</span>]= <span class="hljs-number">8</span> ; <span class="hljs-comment">//write in no cache zone</span></span><br><span class="line">    address[<span class="hljs-number">7</span>]= <span class="hljs-number">8</span> ; <span class="hljs-comment">//read in no cache zone</span></span><br><span class="line"><span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">reg</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] data [<span class="hljs-number">0</span>:<span class="hljs-number">7</span>];</span><br><span class="line"><span class="hljs-keyword">initial</span></span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    data[<span class="hljs-number">0</span>]= <span class="hljs-number">32&apos;hab2112a</span> ;</span><br><span class="line">    data[<span class="hljs-number">1</span>]= <span class="hljs-number">32&apos;hab2112b</span> ;</span><br><span class="line">    data[<span class="hljs-number">2</span>]= <span class="hljs-number">32&apos;hab2112c</span> ;</span><br><span class="line">    data[<span class="hljs-number">3</span>]= <span class="hljs-number">32&apos;hab21123</span> ;</span><br><span class="line">    data[<span class="hljs-number">4</span>]= <span class="hljs-number">32&apos;hab21124</span> ;</span><br><span class="line">    data[<span class="hljs-number">5</span>]= <span class="hljs-number">32&apos;hab21128</span> ;</span><br><span class="line">    data[<span class="hljs-number">6</span>]= <span class="hljs-number">32&apos;hab21129</span> ;</span><br><span class="line">    data[<span class="hljs-number">7</span>]= <span class="hljs-number">32&apos;hab21121</span> ;</span><br><span class="line"><span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">reg</span> [<span class="hljs-number">7</span>:<span class="hljs-number">0</span>] rw;</span><br><span class="line"><span class="hljs-keyword">initial</span></span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    rw[<span class="hljs-number">0</span>]= <span class="hljs-number">0</span> ;</span><br><span class="line">    rw[<span class="hljs-number">1</span>]= <span class="hljs-number">0</span> ;</span><br><span class="line">    rw[<span class="hljs-number">2</span>]= <span class="hljs-number">0</span> ;</span><br><span class="line">    rw[<span class="hljs-number">3</span>]= <span class="hljs-number">1</span> ;</span><br><span class="line">    rw[<span class="hljs-number">4</span>]= <span class="hljs-number">0</span> ;</span><br><span class="line">    rw[<span class="hljs-number">5</span>]= <span class="hljs-number">0</span> ;</span><br><span class="line">    rw[<span class="hljs-number">6</span>]= <span class="hljs-number">1</span> ;</span><br><span class="line">    rw[<span class="hljs-number">7</span>]= <span class="hljs-number">0</span> ;</span><br><span class="line"><span class="hljs-keyword">end</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>&#x6D4B;&#x8BD5;&#x7ED3;&#x679C;&#x5982;&#x56FE;&#xFF1A;<br><img src="/%E7%BB%84%E7%9B%B8%E8%81%94cache%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/basic_test_1.png" alt="&#x5355;&#x4E2A;cache&#x6D4B;&#x8BD5;1"><br>&#x4ECE;&#x56FE;&#x4E2D;&#x53EF;&#x89C1;&#xFF1A;<br>&#x8BFB;&#x53D6;0&#xFF0C;110ns&#x6570;&#x636E;&#x51C6;&#x5907;&#x5B8C;&#x6BD5;&#xFF0C;130ns&#x8FDB;&#x5165;&#x4E0B;&#x4E2A;&#x8BF7;&#x6C42;&#xFF0C;&#x6B64;&#x6B21;&#x8BF7;&#x6C42;&#x672A;&#x547D;&#x4E2D;&#x3002;<br>&#x8BFB;&#x53D6;4&#xFF0C;210ns&#x6570;&#x636E;&#x51C6;&#x5907;&#x5B8C;&#x6BD5;&#xFF0C;230ns&#x8FDB;&#x5165;&#x4E0B;&#x4E2A;&#x8BF7;&#x6C42;&#xFF0C;&#x6B64;&#x6B21;&#x8BF7;&#x6C42;&#x672A;&#x547D;&#x4E2D;&#x3002;<br>&#x8BFB;&#x53D6;0&#xFF0C;&#x6B64;&#x6B21;&#x8BF7;&#x6C42;&#x547D;&#x4E2D;&#xFF0C;&#x6570;&#x636E;&#x5728;&#x4E00;&#x5468;&#x671F;&#x5185;&#x51C6;&#x5907;&#x5B8C;&#x6BD5;&#xFF0C;&#x603B;&#x7EBF;&#x7A7A;&#x95F2;&#xFF0C;250ns&#x8FDB;&#x5165;&#x4E0B;&#x4E2A;&#x8BF7;&#x6C42;&#x3002;<br>&#x5199;&#x5165;16&#xFF0C;&#x5199;&#x8BF7;&#x6C42;&#x603B;&#x662F;&#x672A;&#x547D;&#x4E2D;&#xFF0C;330ns&#x5199;&#x5165;&#x5B8C;&#x6BD5;&#xFF0C;350ns&#x8FDB;&#x5165;&#x4E0B;&#x4E00;&#x4E2A;&#x8BF7;&#x6C42;&#x3002;<br>&#x8BFB;&#x53D6;16&#xFF0C;&#x5199;&#x540E;&#x8BFB;&#x547D;&#x4E2D;&#xFF0C;&#x6570;&#x636E;&#x5728;&#x4E00;&#x5468;&#x671F;&#x5185;&#x51C6;&#x5907;&#x5B8C;&#x6BD5;&#xFF0C;&#x603B;&#x7EBF;&#x7A7A;&#x95F2;&#xFF0C;370ns&#x8FDB;&#x5165;&#x4E0B;&#x4E2A;&#x8BF7;&#x6C42;&#x3002;</p>
<p><img src="/%E7%BB%84%E7%9B%B8%E8%81%94cache%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/basic_test_2.png" alt="&#x5355;&#x4E2A;cache&#x6D4B;&#x8BD5;2"><br>&#x4ECE;&#x56FE;&#x4E2D;&#x53EF;&#x89C1;&#xFF1A;<br>&#x8BFB;&#x53D6;8&#xFF0C;&#x8BF7;&#x6C42;no cache&#x8303;&#x56F4;&#xFF0C;&#x603B;&#x662F;&#x4E0D;&#x547D;&#x4E2D;&#xFF0C;450ns&#x6570;&#x636E;&#x51C6;&#x5907;&#x597D;&#xFF0C;470ns&#x8FDB;&#x5165;&#x4E0B;&#x4E2A;&#x8BF7;&#x6C42;&#x3002;<br>&#x5199;&#x5165;8&#xFF0C;&#x8BF7;&#x6C42;no cache&#x8303;&#x56F4;&#xFF0C;&#x603B;&#x662F;&#x4E0D;&#x547D;&#x4E2D;&#xFF0C;550ns&#x6570;&#x636E;&#x51C6;&#x5907;&#x597D;&#xFF0C;570ns&#x8FDB;&#x5165;&#x4E0B;&#x4E2A;&#x8BF7;&#x6C42;&#x3002;<br>&#x8BFB;&#x53D6;8&#xFF0C;&#x8BF7;&#x6C42;no cache&#x8303;&#x56F4;&#xFF0C;&#x603B;&#x662F;&#x4E0D;&#x547D;&#x4E2D;&#xFF0C;650ns&#x6570;&#x636E;&#x51C6;&#x5907;&#x597D;&#xFF0C;670ns&#x8FDB;&#x5165;&#x4E0B;&#x4E2A;&#x8BF7;&#x6C42;&#x3002;<br>&#x8FD9;&#x4E00;&#x6BB5;&#x6D4B;&#x8BD5;&#x4E86;&#x6709;&#x9650;&#x7684;&#x7F13;&#x5B58;&#x540C;&#x6B65;&#x673A;&#x5236;&#x3002;<br>&#x540E;&#x7EED;&#x4E09;&#x4E2A;&#x8BF7;&#x6C42;&#x8BFB;&#x53D6;0&#xFF0C;4&#xFF0C;0&#x5747;&#x547D;&#x4E2D;&#x3002;<br>&#x57FA;&#x7840;&#x529F;&#x80FD;&#x6D4B;&#x8BD5;&#x5B8C;&#x6BD5;&#x3002;</p>
<h4 id="&#x66FF;&#x6362;&#x7B56;&#x7565;&#x6D4B;&#x8BD5;"><a href="#&#x66FF;&#x6362;&#x7B56;&#x7565;&#x6D4B;&#x8BD5;" class="headerlink" title="&#x66FF;&#x6362;&#x7B56;&#x7565;&#x6D4B;&#x8BD5;"></a>&#x66FF;&#x6362;&#x7B56;&#x7565;&#x6D4B;&#x8BD5;</h4><p>&#x66FF;&#x6362;&#x7B56;&#x7565;&#x7684;&#x6D4B;&#x8BD5;&#x7A0D;&#x5FAE;&#x7E41;&#x7410;&#x4E00;&#x4E9B;&#x3002;&#x7ECF;&#x8FC7;&#x601D;&#x8003;&#x6211;&#x51B3;&#x5B9A;&#x5148;&#x5C06;cache&#x7684;&#x89C4;&#x6A21;&#x7F29;&#x5C0F;&#xFF0C;&#x7F29;&#x5C0F;&#x5230;&#x6700;&#x5C0F;&#x3002;&#x5F53;cache&#x89C4;&#x6A21;&#x7F29;&#x5230;&#x5F88;&#x5C0F;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C31;&#x5F88;&#x5BB9;&#x6613;&#x5236;&#x9020;cache&#x66FF;&#x6362;&#x7684;&#x6A21;&#x62DF;&#xFF0C;&#x7136;&#x540E;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;&#x3002;<br>&#x5C06;&#x53C2;&#x6570;INDEX&#x6539;&#x4E3A;1&#xFF0C;&#x6B64;&#x65F6;cache&#x7684;&#x89C4;&#x6A21;&#x4E3A;&#x4E24;&#x7EC4;&#xFF0C;&#x6BCF;&#x7EC4;&#x4E24;&#x884C;&#x3002;&#x7136;&#x540E;&#x6267;&#x884C;&#x5E8F;&#x5217;&#xFF1A;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">reg</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] address [<span class="hljs-number">0</span>:<span class="hljs-number">7</span>] ;</span><br><span class="line"><span class="hljs-keyword">initial</span></span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    address[<span class="hljs-number">0</span>]= <span class="hljs-number">0</span> ;</span><br><span class="line">    address[<span class="hljs-number">1</span>]= <span class="hljs-number">4</span> ;</span><br><span class="line">    address[<span class="hljs-number">2</span>]= <span class="hljs-number">28</span> ; </span><br><span class="line">    address[<span class="hljs-number">3</span>]= <span class="hljs-number">8</span> ;</span><br><span class="line">    address[<span class="hljs-number">4</span>]= <span class="hljs-number">16</span> ;</span><br><span class="line">    address[<span class="hljs-number">5</span>]= <span class="hljs-number">4</span> ; </span><br><span class="line">    address[<span class="hljs-number">6</span>]= <span class="hljs-number">4</span> ; </span><br><span class="line">    address[<span class="hljs-number">7</span>]= <span class="hljs-number">4</span> ; </span><br><span class="line"><span class="hljs-keyword">end</span></span><br><span class="line"><span class="hljs-keyword">reg</span> [<span class="hljs-number">7</span>:<span class="hljs-number">0</span>] rw;</span><br><span class="line"><span class="hljs-keyword">initial</span></span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    rw[<span class="hljs-number">0</span>]= <span class="hljs-number">0</span> ;</span><br><span class="line">    rw[<span class="hljs-number">1</span>]= <span class="hljs-number">0</span> ;</span><br><span class="line">    rw[<span class="hljs-number">2</span>]= <span class="hljs-number">0</span> ;</span><br><span class="line">    rw[<span class="hljs-number">3</span>]= <span class="hljs-number">0</span> ;</span><br><span class="line">    rw[<span class="hljs-number">4</span>]= <span class="hljs-number">0</span> ;</span><br><span class="line">    rw[<span class="hljs-number">5</span>]= <span class="hljs-number">1</span> ;</span><br><span class="line">    rw[<span class="hljs-number">6</span>]= <span class="hljs-number">1</span> ;</span><br><span class="line">    rw[<span class="hljs-number">7</span>]= <span class="hljs-number">0</span> ;</span><br><span class="line"><span class="hljs-keyword">end</span></span><br></pre></td></tr></table></figure>
<p>&#x4EFF;&#x771F;&#x7ED3;&#x679C;&#x5982;&#x56FE;:<br><img src="/%E7%BB%84%E7%9B%B8%E8%81%94cache%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/replace_policy_test_1.png" alt="&#x66FF;&#x6362;&#x7B56;&#x7565;&#x6D4B;&#x8BD5;1"><br><img src="/%E7%BB%84%E7%9B%B8%E8%81%94cache%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/replace_policy_test_2.png" alt="&#x66FF;&#x6362;&#x7B56;&#x7565;&#x6D4B;&#x8BD5;2"><br><img src="/%E7%BB%84%E7%9B%B8%E8%81%94cache%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/replace_policy_test_3.png" alt="&#x66FF;&#x6362;&#x7B56;&#x7565;&#x6D4B;&#x8BD5;3"></p>
<p>&#x5206;&#x6790;&#x4E0A;&#x8FF0;&#x5E8F;&#x5217;&#x7684;&#x8FC7;&#x7A0B;&#xFF1A;</p>
<table>
<thead>
<tr>
<th>&#x65F6;&#x523B;</th>
<th>120ns</th>
<th>220ns</th>
<th>320ns</th>
<th>420ns</th>
<th>520ns</th>
<th>620ns</th>
<th>720ns</th>
</tr>
</thead>
<tbody><tr>
<td>&#x8BF7;&#x6C42;</td>
<td>0</td>
<td>4</td>
<td>28</td>
<td>8</td>
<td>16</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>TAG</td>
<td>0</td>
<td>0</td>
<td>11</td>
<td>1</td>
<td>10</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>INDEX</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>&#x884C;/&#x7EC4;</td>
<td>0A</td>
<td>1A</td>
<td>1B</td>
<td>0B</td>
<td>0B</td>
<td>1A</td>
<td>1A</td>
</tr>
<tr>
<td>&#x7B56;&#x7565;</td>
<td>TAG&#x76F8;&#x540C;&#x7EC4;</td>
<td>TAG&#x76F8;&#x540C;&#x7EC4;</td>
<td>&#x7A7A;&#x7684;&#x7EC4;</td>
<td>&#x7A7A;&#x7684;&#x7EC4;</td>
<td>&#x6EE1;&#xFF0C;&#x968F;&#x673A;</td>
<td>&#x6EE1;&#xFF0C;&#x968F;&#x673A;</td>
<td>TAG&#x76F8;&#x540C;&#x7EC4;</td>
</tr>
</tbody></table>
<p>&#x7531;&#x4EFF;&#x771F;&#x7ED3;&#x679C;&#x53EF;&#x77E5;&#xFF0C;&#x66FF;&#x6362;&#x7B56;&#x7565;&#x901A;&#x8FC7;&#x6D4B;&#x8BD5;&#x3002;</p>
<h3 id="&#x591A;&#x4E2A;cache&#x7684;&#x8054;&#x5408;&#x8BBF;&#x5B58;&#x6D4B;&#x8BD5;"><a href="#&#x591A;&#x4E2A;cache&#x7684;&#x8054;&#x5408;&#x8BBF;&#x5B58;&#x6D4B;&#x8BD5;" class="headerlink" title="&#x591A;&#x4E2A;cache&#x7684;&#x8054;&#x5408;&#x8BBF;&#x5B58;&#x6D4B;&#x8BD5;"></a>&#x591A;&#x4E2A;cache&#x7684;&#x8054;&#x5408;&#x8BBF;&#x5B58;&#x6D4B;&#x8BD5;</h3><p>&#x5355;&#x4E2A;cache&#x7684;&#x529F;&#x80FD;&#x6D4B;&#x8BD5;&#x5B8C;&#xFF0C;&#x8FBE;&#x5230;&#x8BBE;&#x8BA1;&#x76EE;&#x6807;&#x540E;&#xFF0C;&#x5C31;&#x8981;&#x6D4B;&#x8BD5;&#x591A;&#x4E2A;cache&#x8054;&#x5408;&#x8BBF;&#x95EE;&#x603B;&#x7EBF;&#x7684;&#x6D4B;&#x8BD5;&#x3002;&#x8FD9;&#x4E2A;&#x6D4B;&#x8BD5;&#x4E0D;&#x5355;&#x6D4B;&#x8BD5;cache&#x529F;&#x80FD;&#xFF0C;&#x8FD8;&#x8981;&#x6D4B;&#x8BD5;&#x603B;&#x7EBF;&#x7684;&#x529F;&#x80FD;&#x3002;<br>&#x9996;&#x5148;&#x5C06;&#x4E24;&#x4E2A;cache&#x5B9E;&#x4F8B;&#x5206;&#x522B;&#x4F5C;&#x4E3A;I cache &#x548C;D cache&#x8FDE;&#x63A5;&#x5728;&#x603B;&#x7EBF;&#x548C;&#x603B;&#x7EBF;&#x63A7;&#x5236;&#x5668;&#x4E0A;&#xFF1A;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">//hook up the simulated instruction cache</span></span><br><span class="line">cache I_cache (CPU_stall,next_pc , <span class="hljs-number">32&apos;b0</span> , <span class="hljs-number">1&apos;b1</span>, <span class="hljs-number">1&apos;b0</span>, <span class="hljs-number">1&apos;b0</span>, CPU_data, CPU_ready, PC,</span><br><span class="line">                BUS_addr, BUS_data, DMA[<span class="hljs-number">0</span>], BUS_RW, grant[<span class="hljs-number">0</span>], BUS_ready, clr, clk,</span><br><span class="line">                we_a,we_b,we_c,needupdate,tag,hitA,hitB,RAM_A_out);</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">//hook up the simulated data cache</span></span><br><span class="line">cache D_cache (CPU_stall,exe_address[i],data[i], exe_req[i], rw[i],<span class="hljs-number">1&apos;b0</span>,mem_o,mem_ready,,</span><br><span class="line">                BUS_addr,BUS_data,DMA[<span class="hljs-number">1</span>],BUS_RW, grant[<span class="hljs-number">1</span>],BUS_ready ,clr,clk);</span><br></pre></td></tr></table></figure>
<p>D_cache&#x63A5;&#x5728;DMA[1]&#x4E0A;&#xFF0C;&#x8868;&#x660E;&#x6307;&#x4EE4;cache&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x6BD4;&#x6570;&#x636E;cache&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x8981;&#x9AD8;&#x3002;<br>&#x7136;&#x540E;&#x8BBE;&#x7F6E;&#x5408;&#x9002;&#x7684;CPU_stall&#x4FE1;&#x53F7;&#xFF1A;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">wire</span> CPU_stall = clr ? <span class="hljs-number">0</span>: ~(CPU_ready &amp;&amp; mem_ready);</span><br></pre></td></tr></table></figure>
<p>&#x6700;&#x540E;&#x52A0;&#x8F7D;&#x6A21;&#x62DF;&#x7684;&#x6D4B;&#x8BD5;&#x8BF7;&#x6C42;&#xFF1A;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">//for I cache</span></span><br><span class="line"><span class="hljs-keyword">reg</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] address [<span class="hljs-number">0</span>:<span class="hljs-number">7</span>] ;</span><br><span class="line"><span class="hljs-keyword">initial</span></span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    address[<span class="hljs-number">0</span>]= <span class="hljs-number">0</span> ;</span><br><span class="line">    address[<span class="hljs-number">1</span>]= <span class="hljs-number">4</span> ;</span><br><span class="line">    address[<span class="hljs-number">2</span>]= <span class="hljs-number">0</span> ; </span><br><span class="line">    address[<span class="hljs-number">3</span>]= <span class="hljs-number">4</span> ;</span><br><span class="line">    address[<span class="hljs-number">4</span>]= <span class="hljs-number">8</span> ;</span><br><span class="line">    address[<span class="hljs-number">5</span>]= <span class="hljs-number">16</span> ; </span><br><span class="line">    address[<span class="hljs-number">6</span>]= <span class="hljs-number">0</span> ; </span><br><span class="line">    address[<span class="hljs-number">7</span>]= <span class="hljs-number">4</span> ; </span><br><span class="line"><span class="hljs-keyword">end</span></span><br><span class="line"><span class="hljs-comment">//for D cache</span></span><br><span class="line"><span class="hljs-keyword">reg</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] exe_address [<span class="hljs-number">0</span>:<span class="hljs-number">7</span>];</span><br><span class="line"><span class="hljs-keyword">initial</span></span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    exe_address[<span class="hljs-number">0</span>]= <span class="hljs-number">0</span> ;</span><br><span class="line">    exe_address[<span class="hljs-number">1</span>]= <span class="hljs-number">20</span>;</span><br><span class="line">    exe_address[<span class="hljs-number">2</span>]= <span class="hljs-number">0</span> ;</span><br><span class="line">    exe_address[<span class="hljs-number">3</span>]= <span class="hljs-number">20</span>;</span><br><span class="line">    exe_address[<span class="hljs-number">4</span>]= <span class="hljs-number">20</span>;</span><br><span class="line">    exe_address[<span class="hljs-number">5</span>]= <span class="hljs-number">24</span>;</span><br><span class="line">    exe_address[<span class="hljs-number">6</span>]= <span class="hljs-number">24</span>;</span><br><span class="line">    exe_address[<span class="hljs-number">7</span>]= <span class="hljs-number">24</span>;</span><br><span class="line"><span class="hljs-keyword">end</span></span><br><span class="line"><span class="hljs-keyword">reg</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] exe_req [<span class="hljs-number">0</span>:<span class="hljs-number">7</span>];</span><br><span class="line"><span class="hljs-keyword">initial</span></span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    exe_req[<span class="hljs-number">0</span>]=<span class="hljs-number">0</span>;</span><br><span class="line">    exe_req[<span class="hljs-number">1</span>]=<span class="hljs-number">1</span>;</span><br><span class="line">    exe_req[<span class="hljs-number">2</span>]=<span class="hljs-number">0</span>;</span><br><span class="line">    exe_req[<span class="hljs-number">3</span>]=<span class="hljs-number">1</span>;</span><br><span class="line">    exe_req[<span class="hljs-number">4</span>]=<span class="hljs-number">1</span>;</span><br><span class="line">    exe_req[<span class="hljs-number">5</span>]=<span class="hljs-number">1</span>;</span><br><span class="line">    exe_req[<span class="hljs-number">6</span>]=<span class="hljs-number">1</span>;</span><br><span class="line">    exe_req[<span class="hljs-number">7</span>]=<span class="hljs-number">1</span>;</span><br><span class="line"><span class="hljs-keyword">end</span></span><br><span class="line"><span class="hljs-keyword">reg</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] data [<span class="hljs-number">0</span>:<span class="hljs-number">7</span>];</span><br><span class="line"><span class="hljs-keyword">initial</span></span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    data[<span class="hljs-number">0</span>]= <span class="hljs-number">32&apos;hab2112a</span> ;</span><br><span class="line">    data[<span class="hljs-number">1</span>]= <span class="hljs-number">32&apos;hab2112b</span> ;</span><br><span class="line">    data[<span class="hljs-number">2</span>]= <span class="hljs-number">32&apos;hab2112c</span> ;</span><br><span class="line">    data[<span class="hljs-number">3</span>]= <span class="hljs-number">32&apos;hab21123</span> ;</span><br><span class="line">    data[<span class="hljs-number">4</span>]= <span class="hljs-number">32&apos;hab21124</span> ;</span><br><span class="line">    data[<span class="hljs-number">5</span>]= <span class="hljs-number">32&apos;hab21128</span> ;</span><br><span class="line">    data[<span class="hljs-number">6</span>]= <span class="hljs-number">32&apos;hab21129</span> ;</span><br><span class="line">    data[<span class="hljs-number">7</span>]= <span class="hljs-number">32&apos;hab21121</span> ;</span><br><span class="line"><span class="hljs-keyword">end</span></span><br><span class="line"><span class="hljs-keyword">reg</span> [<span class="hljs-number">7</span>:<span class="hljs-number">0</span>] rw;</span><br><span class="line"><span class="hljs-keyword">initial</span></span><br><span class="line"><span class="hljs-keyword">begin</span></span><br><span class="line">    rw[<span class="hljs-number">0</span>]= <span class="hljs-number">0</span> ;</span><br><span class="line">    rw[<span class="hljs-number">1</span>]= <span class="hljs-number">1</span> ;</span><br><span class="line">    rw[<span class="hljs-number">2</span>]= <span class="hljs-number">0</span> ;</span><br><span class="line">    rw[<span class="hljs-number">3</span>]= <span class="hljs-number">1</span> ;</span><br><span class="line">    rw[<span class="hljs-number">4</span>]= <span class="hljs-number">0</span> ;</span><br><span class="line">    rw[<span class="hljs-number">5</span>]= <span class="hljs-number">0</span> ;</span><br><span class="line">    rw[<span class="hljs-number">6</span>]= <span class="hljs-number">1</span> ;</span><br><span class="line">    rw[<span class="hljs-number">7</span>]= <span class="hljs-number">0</span> ;</span><br><span class="line"><span class="hljs-keyword">end</span></span><br></pre></td></tr></table></figure>
<p>&#x4EFF;&#x771F;&#x7ED3;&#x679C;&#x5982;&#x56FE;:<br><img src="/%E7%BB%84%E7%9B%B8%E8%81%94cache%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2cache_test_1.png" alt="&#x8054;&#x5408;&#x8BBF;&#x5B58;&#x6D4B;&#x8BD5;1"><br>0-130ns:<br>    I cache&#x672A;&#x547D;&#x4E2D;&#x8BBF;&#x95EE;&#x603B;&#x7EBF;&#xFF0C;D cache&#x65E0;&#x8BF7;&#x6C42;&#xFF0C;130nsCPU&#x51C6;&#x5907;&#x597D;&#x63A5;&#x6536;&#x4E0B;&#x4E00;&#x4E2A;&#x8BF7;&#x6C42;&#x3002;<br>130ns-330ns:<br>    I cache&#x672A;&#x547D;&#x4E2D;&#x4F18;&#x5148;&#x8BBF;&#x95EE;&#x603B;&#x7EBF;&#xFF0C;230ns&#x8BBF;&#x95EE;&#x5B8C;&#x6210;&#x8F6E;&#x5230;D cache&#x8BBF;&#x95EE;&#x603B;&#x7EBF;&#xFF0C;330ns CPU&#x51C6;&#x5907;&#x597D;&#x63A5;&#x6536;&#x4E0B;&#x4E00;&#x4E2A;&#x8BF7;&#x6C42;&#x3002;<br>330ns-350ns:<br>    I cache&#x548C;Dcache&#x5747;&#x547D;&#x4E2D;&#xFF0C;&#x603B;&#x7EBF;&#x7A7A;&#x95F2;&#xFF0C;350ns CPU&#x51C6;&#x5907;&#x597D;&#x63A5;&#x6536;&#x4E0B;&#x4E00;&#x4E2A;&#x8BF7;&#x6C42;&#x3002;<br><img src="/%E7%BB%84%E7%9B%B8%E8%81%94cache%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2cache_test_2.png" alt="&#x8054;&#x5408;&#x8BBF;&#x5B58;&#x6D4B;&#x8BD5;2"><br>350ns-450ns&#xFF1A;<br>    I cache&#x672A;&#x547D;&#x4E2D; &#x8BBF;&#x95EE;&#x603B;&#x7EBF;&#xFF0C;D cache&#x547D;&#x4E2D;&#xFF0C;450ns CPU&#x51C6;&#x5907;&#x597D;&#x63A5;&#x6536;&#x4E0B;&#x4E00;&#x4E2A;&#x8BF7;&#x6C42;&#x3002;<br>450ns-650ns:<br>    I cache&#x672A;&#x547D;&#x4E2D;&#x4F18;&#x5148;&#x8BBF;&#x95EE;&#x603B;&#x7EBF;&#xFF0C;550ns&#x8BBF;&#x95EE;&#x5B8C;&#x6210;&#x8F6E;&#x5230;D cache&#x8BBF;&#x95EE;&#x603B;&#x7EBF;&#xFF0C;650ns CPU&#x51C6;&#x5907;&#x597D;&#x63A5;&#x6536;&#x4E0B;&#x4E00;&#x4E2A;&#x8BF7;&#x6C42;&#x3002;<br><img src="/%E7%BB%84%E7%9B%B8%E8%81%94cache%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2cache_test_3.png" alt="&#x8054;&#x5408;&#x8BBF;&#x5B58;&#x6D4B;&#x8BD5;3"><br>650ns-850ns:<br>    I cache&#x672A;&#x547D;&#x4E2D;&#x4F18;&#x5148;&#x8BBF;&#x95EE;&#x603B;&#x7EBF;&#xFF0C;750ns&#x8BBF;&#x95EE;&#x5B8C;&#x6210;&#x8F6E;&#x5230;D cache&#x8BBF;&#x95EE;&#x603B;&#x7EBF;&#xFF0C;850ns CPU&#x51C6;&#x5907;&#x597D;&#x63A5;&#x6536;&#x4E0B;&#x4E00;&#x4E2A;&#x8BF7;&#x6C42;&#x3002;<br>850ns-950ns:<br>    I cache&#x547D;&#x4E2D;&#xFF0C; D cache&#x672A;&#x547D;&#x4E2D;&#xFF0C;&#x8BBF;&#x95EE;&#x603B;&#x7EBF;&#xFF0C;950ns&#x8BBF;&#x95EE;&#x5B8C;&#x6210;&#xFF0C;CPU&#x51C6;&#x5907;&#x597D;&#x3002;<br>950ns-970ns:<br>    I cache&#x3001;D cache&#x5747;&#x547D;&#x4E2D;&#xFF0C;CPU&#x5728;&#x4E00;&#x4E2A;&#x5468;&#x671F;&#x5185;&#x51C6;&#x5907;&#x597D;&#x3002;<br>970ns-990ns:<br>    I cache&#x3001;D cache&#x5747;&#x547D;&#x4E2D;&#xFF0C;CPU&#x5728;&#x4E00;&#x4E2A;&#x5468;&#x671F;&#x5185;&#x51C6;&#x5907;&#x597D;&#x3002;</p>
<p>&#x7531;&#x4EFF;&#x771F;&#x7ED3;&#x679C;&#x53EF;&#x77E5;&#xFF0C;&#x4E24;&#x4E2A;cache&#x53EF;&#x4EE5;&#x6309;&#x7167;&#x4F18;&#x5148;&#x7EA7;&#x5171;&#x540C;&#x8BBF;&#x95EE;&#x7CFB;&#x7EDF;&#x603B;&#x7EBF;&#xFF0C;&#x800C;&#x4E14;cache&#x7684;&#x5B58;&#x5728;&#x5BF9;CPU&#x7684;&#x6027;&#x80FD;&#x63D0;&#x5347;&#x5F88;&#x6709;&#x5E2E;&#x52A9;&#x3002;&#x6211;&#x4EEC;&#x603B;&#x7EBF;&#x4E0A;&#x6302;&#x7684;&#x6A21;&#x62DF;&#x5185;&#x5B58;&#x63A7;&#x5236;&#x5668;&#x9700;&#x8981;5&#x4E2A;&#x5468;&#x671F;100ns&#x4E8B;&#x4EF6;&#x624D;&#x80FD;&#x5C06;&#x6570;&#x636E;&#x51C6;&#x5907;&#x597D;&#x3002;30-990ns&#x7684;&#x65F6;&#x95F4;&#x5185;&#xFF0C;&#x5171;48&#x4E2A;&#x65F6;&#x949F;&#x5468;&#x671F;&#xFF0C;&#x5171;&#x5B8C;&#x6210;&#x4E86;9&#x6761;&#x6307;&#x4EE4;&#x3002;&#x82E5;cache&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x6BCF;&#x6761;&#x6307;&#x4EE4;&#x9700;&#x8981;10&#x4E2A;&#x5468;&#x671F;&#x624D;&#x80FD;&#x5B8C;&#x6210;&#xFF0C;&#x6700;&#x591A;&#x624D;&#x80FD;&#x6267;&#x884C;4.8&#x6761;&#x3002;</p>
<h2 id="&#x5DF2;&#x77E5;&#x95EE;&#x9898;"><a href="#&#x5DF2;&#x77E5;&#x95EE;&#x9898;" class="headerlink" title="&#x5DF2;&#x77E5;&#x95EE;&#x9898;"></a>&#x5DF2;&#x77E5;&#x95EE;&#x9898;</h2><p>&#x6211;&#x7684;&#x603B;&#x7EBF;&#x8BBE;&#x5907;&#x548C;&#x603B;&#x7EBF;&#x63A7;&#x5236;&#x5668;&#x4E0D;&#x77E5;&#x9053;&#x5982;&#x4F55;&#x89E3;&#x51B3;&#x5BF9;&#x8BBE;&#x5907;&#x4E2D;&#x6CA1;&#x6709;&#x7684;&#x5730;&#x5740;&#x7684;&#x8BBF;&#x95EE;&#x3002;<br>&#x5982;&#x679C;&#x8BBF;&#x95EE;&#x7684;&#x5730;&#x5740;&#x4E0D;&#x5728;&#x8BBE;&#x5907;&#x7684;&#x8303;&#x56F4;&#x5185;&#xFF0C;&#x7CFB;&#x7EDF;&#x5C31;&#x4F1A;&#x51FA;&#x73B0;&#x5F02;&#x5E38;&#x3002;<br>&#x76EE;&#x524D;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF1A;&#x65E0;&#xFF0C;&#x7A0B;&#x5E8F;&#x4E0D;&#x5E94;&#x8BBF;&#x95EE;&#x4E0D;&#x5728;&#x8BBE;&#x5907;&#x8303;&#x56F4;&#x5185;&#x7684;&#x5730;&#x5740;&#x3002;</p>
<h2 id="&#x5C0F;&#x7ED3;"><a href="#&#x5C0F;&#x7ED3;" class="headerlink" title="&#x5C0F;&#x7ED3;"></a>&#x5C0F;&#x7ED3;</h2><p>&#x6211;&#x5728;&#x5B9E;&#x73B0;&#x8FC7;&#x7A0B;&#x4E2D;&#x9047;&#x5230;&#x7684;&#x6700;&#x5927;&#x7684;&#x95EE;&#x9898;&#x83AB;&#x8FC7;&#x4E8E;&#x7EC4;&#x5408;&#x903B;&#x8F91;&#x73AF;&#x3002;&#x56E0;&#x4E3A;FPGA&#x7247;&#x4E0A;&#x5B58;&#x50A8;&#x7684;&#x7279;&#x6027;&#xFF08;&#x9690;&#x542B;&#x7684;&#x5BC4;&#x5B58;&#x5668;&#xFF09;&#xFF0C;&#x6211;&#x5FC5;&#x987B;&#x5728;&#x6A21;&#x5757;&#x7684;&#x67D0;&#x4E9B;&#x8F93;&#x5165;&#x4E0A;&#x76F4;&#x63A5;&#x7ED5;&#x8FC7;&#x6D41;&#x6C34;&#x7EBF;&#x5BC4;&#x5B58;&#x5668;&#xFF0C;&#x5E76;&#x4F9D;&#x636E;CPU_stall&#x8FDB;&#x884C;&#x9009;&#x62E9;&#xFF0C;&#x8FD9;&#x5C31;&#x975E;&#x5E38;&#x5BB9;&#x6613;&#x5F15;&#x5165;&#x4ECE;CPU_stall&#x4FE1;&#x53F7;&#x5230;ready_o&#x4FE1;&#x53F7;&#x4E4B;&#x95F4;&#x7684;&#x903B;&#x8F91;&#x73AF;&#x3002;&#x6211;&#x5728;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x4E0A;&#x82B1;&#x4E86;&#x5F88;&#x957F;&#x65F6;&#x95F4;&#x8FDB;&#x884C;&#x8C03;&#x8BD5;&#xFF0C;&#x6700;&#x540E;&#x603B;&#x7ED3;&#x51FA;&#xFF0C;&#x53EA;&#x5728;&#x7247;&#x4E0A;RAM&#x7684;&#x5730;&#x5740;&#x8F93;&#x5165;&#x4E0A;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x7531;stall&#x4FE1;&#x53F7;&#x9009;&#x62E9;&#x7684;&#x8F93;&#x5165;&#xFF0C;&#x5176;&#x4F59;&#x7684;&#x63A7;&#x5236;&#x7535;&#x8DEF;&#x5747;&#x8981;&#x4F7F;&#x7528;&#x7ECF;&#x8FC7;&#x5BC4;&#x5B58;&#x5668;&#x540C;&#x6B65;&#x7684;&#x8F93;&#x5165;&#x3002;&#x56E0;&#x4E3A;&#x7247;&#x4E0A;ram&#x8BFB;&#x53D6;&#x7ED3;&#x679C;&#x662F;&#x7531;&#x5BC4;&#x5B58;&#x5668;&#x540C;&#x6B65;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x8FD9;&#x6837;&#x7ED5;&#x8FC7;&#x6D41;&#x6C34;&#x7EBF;&#x5BC4;&#x5B58;&#x5668;&#x4E0D;&#x4F1A;&#x5F15;&#x8D77;&#x7EC4;&#x5408;&#x903B;&#x8F91;&#x73AF;&#x3002;<br>&#x7EC4;&#x76F8;&#x8054;cache&#x5728;&#x5404;&#x79CD;&#x6559;&#x79D1;&#x4E66;&#x4E2D;&#x90FD;&#x6709;&#x63D0;&#x53CA;&#xFF0C;&#x4F46;&#x5176;&#x7BC7;&#x5E45;&#x5F80;&#x5F80;&#x4E0D;&#x957F;&#xFF0C;&#x5F80;&#x5F80;&#x5E76;&#x4E0D;&#x80FD;&#x63CF;&#x8FF0;&#x5176;&#x5177;&#x4F53;&#x5B9E;&#x73B0;&#x3002;&#x6211;&#x505A;&#x8FD9;&#x4EF6;&#x4E8B;&#xFF0C;&#x5199;&#x8FD9;&#x4E9B;&#x6587;&#x7AE0;&#xFF0C;&#x4E00;&#x662F;&#x6EE1;&#x8DB3;&#x81EA;&#x5DF1;&#x7684;&#x6B32;&#x671B;&#xFF0C;&#x4E8C;&#x662F;&#x5E0C;&#x671B;&#x80FD;&#x591F;&#x901A;&#x8FC7;&#x52A8;&#x624B;&#x5B9E;&#x8DF5;&#x6765;&#x586B;&#x8865;&#x7406;&#x8BBA;&#x548C;&#x5B9E;&#x8DF5;&#x4E4B;&#x95F4;&#x5DE8;&#x5927;&#x7684;&#x9E3F;&#x6C9F;&#xFF0C;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x7684;&#x7BC7;&#x5E45;&#x5C31;&#x5F88;&#x80FD;&#x8BF4;&#x660E;&#x95EE;&#x9898;&#x3002;<br>&#x7EC4;&#x76F8;&#x8054;cache&#x8BBE;&#x8BA1;&#x5B8C;&#x4E4B;&#x540E;&#xFF0C;&#x6211;&#x7684;&#x6B32;&#x671B;&#x518D;&#x4E00;&#x6B21;&#x81A8;&#x80C0;&#x4E86;&#x3002;&#x662F;&#x5426;&#x52A0;&#x5165;&#x5206;&#x652F;&#x9884;&#x6D4B;&#xFF0C;&#x64A4;&#x6389;&#x6709;&#x4E9B;&#x8FC7;&#x65F6;&#x7684;&#x5EF6;&#x65F6;&#x69FD;&#xFF1F;&#x662F;&#x5426;&#x53EF;&#x80FD;&#x5B9E;&#x73B0;&#x7B80;&#x5355;&#x7684;&#x8D85;&#x6807;&#x91CF;&#x6D41;&#x6C34;&#x7EBF;&#xFF1F;&#x8FD9;&#x4E9B;&#x8FD8;&#x662F;&#x7B49;&#x5230;&#x6574;&#x4F53;&#x8BBE;&#x8BA1;&#x5B8C;&#x518D;&#x8BF4;&#x5427;&#x3002;</p>

    
    </div>
    
    
</article>






    <script src='https://unpkg.com/mermaid@8.8.0/dist/mermaid.min.js'></script>
    <script>
      if (window.mermaid) {
        mermaid.initialize({theme: 'forest'});
      }
    </script>
  

  
    
        <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/Cache%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/" itemprop="url">Cache设计与实现 I</a>
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            
                <time datetime="2020-10-26T02:15:25.000Z" itemprop="datePublished">10月 26 2020</time>
            
        </span>
        
        
        <span class="column is-narrow">
            
            
            32 分钟 read (About 4809 words)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <p>&#x672C;&#x4EE5;&#x4E3A;cache&#x7684;&#x8BBE;&#x8BA1;&#x5E76;&#x4E0D;&#x590D;&#x6742;&#xFF0C;&#x4F46;&#x5B9E;&#x9645;&#x8BBE;&#x8BA1;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x6211;&#x9047;&#x5230;&#x4E86;&#x4E0D;&#x5C11;&#x95EE;&#x9898;&#xFF0C;&#x54EA;&#x6015;&#x7A0D;&#x5FAE;&#x8003;&#x8651;&#x4E00;&#x4E0B;&#x6027;&#x80FD;&#x95EE;&#x9898;&#xFF0C;cache&#x7684;&#x8BBE;&#x8BA1;&#x7684;&#x590D;&#x6742;&#x5EA6;&#x5C31;&#x4F1A;&#x63D0;&#x9AD8;&#x5F88;&#x591A;&#x3002;cache&#x7684;&#x590D;&#x6742;&#x4E0E;cpu&#x6307;&#x4EE4;&#x89E3;&#x7801;&#x7EA7;&#x7684;&#x590D;&#x6742;&#x4E0D;&#x540C;&#xFF0C;CPU&#x6307;&#x4EE4;&#x89E3;&#x7801;&#x7EA7;&#x7684;&#x4FE1;&#x53F7;&#x8F83;&#x591A;&#xFF0C;&#x4F46;&#x8FD9;&#x4E9B;&#x4FE1;&#x53F7;&#x4E4B;&#x95F4;&#x5E76;&#x6CA1;&#x6709;&#x592A;&#x591A;&#x7684;&#x5173;&#x8054;&#xFF0C;&#x66F4;&#x591A;&#x7684;&#x662F;&#x4E00;&#x79CD;&#x7EB5;&#x5411;&#x7684;&#x903B;&#x8F91;&#x5173;&#x7CFB;&#xFF0C;&#x4E00;&#x6761;&#x6307;&#x4EE4;&#x5BF9;&#x5E94;&#x4E00;&#x79CD;&#x4FE1;&#x53F7;&#x7EC4;&#x5408;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x8BBE;&#x8BA1;&#x548C;&#x5206;&#x6790;&#x8FC7;&#x7A0B;&#x4E2D;&#x5E76;&#x6CA1;&#x6709;&#x592A;&#x591A;&#x590D;&#x6742;&#x95EE;&#x9898;&#x3002;&#x4F46;cache&#x4E2D;&#x7684;&#x4FE1;&#x53F7;&#x7684;&#x903B;&#x8F91;&#x5173;&#x7CFB;&#x66F4;&#x590D;&#x6742;&#xFF0C;&#x66F4;&#x96BE;&#x7406;&#x6E05;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x82B1;&#x8D39;&#x4E86;&#x5927;&#x91CF;&#x7684;&#x7CBE;&#x529B;&#x53BB;&#x8BBE;&#x8BA1;&#x3002;&#x6211;&#x5F15;&#x5165;cache&#x7684;&#x672C;&#x610F;&#x5E76;&#x4E0D;&#x662F;&#x5355;&#x7EAF;&#x4E3A;&#x4E86;&#x6027;&#x80FD;&#xFF0C;&#x6700;&#x4E3B;&#x8981;&#x7684;&#x539F;&#x56E0;&#x662F;cpu&#x5185;&#x90E8;&#x91C7;&#x7528;&#x7C7B;&#x4F3C;&#x54C8;&#x5F17;&#x67B6;&#x6784;&#xFF0C;&#x9700;&#x8981;&#x5206;&#x79BB;&#x7684;&#x6307;&#x4EE4;&#x548C;&#x6570;&#x636E;&#x5B58;&#x50A8;&#xFF0C;&#x5F15;&#x5165;cache&#x53EF;&#x4EE5;&#x5728;CPU&#x89C6;&#x89D2;&#x6784;&#x6210;&#x5206;&#x79BB;&#x7684;&#x6307;&#x4EE4;&#x548C;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x3002;&#x4F46;&#x4EBA;&#x7684;&#x91CE;&#x5FC3;&#x603B;&#x662F;&#x8D8A;&#x6765;&#x8D8A;&#x5927;&#xFF0C;&#x5F53;&#x4F60;&#x4E86;&#x89E3;&#x4E86;&#x7B80;&#x5355;&#x7684;cache&#x5982;&#x4F55;&#x8BBE;&#x8BA1;&#x4E4B;&#x540E;&#xFF0C;&#x603B;&#x662F;&#x60F3;&#x80FD;&#x4E0D;&#x80FD;&#x518D;&#x4E00;&#x6B21;&#x63D0;&#x9AD8;&#x6027;&#x80FD;&#xFF0C;&#x54EA;&#x6015;&#x63D0;&#x9AD8;&#x4E00;&#x70B9;&#x70B9;&#x3002;&#x4E8E;&#x662F;&#x6211;&#x539F;&#x672C;&#x8BA1;&#x5212;&#x7684;&#x76F4;&#x63A5;&#x6620;&#x50CF;&#x7684;cache&#x5C31;&#x53D8;&#x6210;&#x4E86;&#x73B0;&#x5728;&#x8BBE;&#x8BA1;&#x7684;2&#x8DEF;&#x7EC4;&#x76F8;&#x8054;cache&#x3002;Cache&#x7684;&#x8BBE;&#x8BA1;&#x662F;&#x76EE;&#x524D;&#x6211;&#x5728;&#x6574;&#x4E2A;&#x7CFB;&#x7EDF;&#x8BBE;&#x8BA1;&#x8FC7;&#x7A0B;&#x4E2D;&#x9047;&#x5230;&#x7684;<strong>&#x6700;&#x6709;&#x6311;&#x6218;&#x6027;</strong>&#x7684;&#x5DE5;&#x4F5C;&#x3002;</p>
<h2 id="Cache-&#x8BBE;&#x8BA1;&#x65F6;&#x9047;&#x5230;&#x7684;&#x95EE;&#x9898;"><a href="#Cache-&#x8BBE;&#x8BA1;&#x65F6;&#x9047;&#x5230;&#x7684;&#x95EE;&#x9898;" class="headerlink" title="Cache &#x8BBE;&#x8BA1;&#x65F6;&#x9047;&#x5230;&#x7684;&#x95EE;&#x9898;"></a>Cache &#x8BBE;&#x8BA1;&#x65F6;&#x9047;&#x5230;&#x7684;&#x95EE;&#x9898;</h2><h3 id="Altera&#x7247;&#x4E0A;&#x5B58;&#x50A8;&#x63A5;&#x53E3;&#x4E0A;&#x9690;&#x542B;&#x7684;&#x5BC4;&#x5B58;&#x5668;"><a href="#Altera&#x7247;&#x4E0A;&#x5B58;&#x50A8;&#x63A5;&#x53E3;&#x4E0A;&#x9690;&#x542B;&#x7684;&#x5BC4;&#x5B58;&#x5668;" class="headerlink" title="Altera&#x7247;&#x4E0A;&#x5B58;&#x50A8;&#x63A5;&#x53E3;&#x4E0A;&#x9690;&#x542B;&#x7684;&#x5BC4;&#x5B58;&#x5668;"></a>Altera&#x7247;&#x4E0A;&#x5B58;&#x50A8;&#x63A5;&#x53E3;&#x4E0A;&#x9690;&#x542B;&#x7684;&#x5BC4;&#x5B58;&#x5668;</h3><p>&#x6211;&#x5728;cache&#x8BBE;&#x8BA1;&#x4E2D;&#x9047;&#x5230;&#x7684;&#x95EE;&#x9898;&#x4E4B;&#x4E00;&#x662F;&#x5173;&#x4E8E;FPGA&#x7247;&#x4E0A;&#x8D44;&#x6E90;&#x7684;&#x95EE;&#x9898;&#xFF0C;Altera&#x7247;&#x4E0A;&#x5B58;&#x50A8;&#x4E2D;&#x51E0;&#x6761;&#x8F93;&#x5165;&#x7684;&#x5730;&#x5740;&#x7EBF;&#x548C;&#x6570;&#x636E;&#x7EBF;&#x90FD;&#x662F;&#x5FC5;&#x987B;registered&#x7684;&#xFF0C;&#x8FD9;&#x5C31;&#x610F;&#x5473;&#x7740;&#x5982;&#x679C;&#x4F7F;&#x7528;&#x7247;&#x4E0A;&#x7684;&#x5B58;&#x50A8;&#x5B9E;&#x73B0;cache&#xFF0C;IF&#x7EA7;PC&#x5BC4;&#x5B58;&#x5668;&#x5B9E;&#x9645;&#x4E0A;&#x5E94;&#x8BE5;&#x9690;&#x542B;&#x5728;I-cache&#x6A21;&#x5757;&#x5185;&#x90E8;&#xFF0C;EXE&#x548C;MEM&#x7EA7;&#x7684;&#x6D41;&#x6C34;&#x7EBF;&#x5BC4;&#x5B58;&#x5668;&#x4E2D;&#x5305;&#x542B;&#x5185;&#x5B58;&#x5730;&#x5740;&#x3001;&#x6570;&#x636E;&#x548C;&#x63A7;&#x5236;&#x7684;&#x90E8;&#x5206;&#x4E5F;&#x5E94;&#x8BE5;&#x9690;&#x542B;&#x5728;D-cache&#x7684;&#x5185;&#x90E8;&#xFF0C;&#x8FD9;&#x5B9E;&#x9645;&#x4E0A;&#x7ED9;&#x6A21;&#x5757;&#x5316;&#x8BBE;&#x8BA1;&#x5E26;&#x6765;&#x4E86;&#x56F0;&#x96BE;&#x3002;&#xFF08;Quartus II Handbook Version 9.1 Volume 1: Design and Synthesis, Chapter 6: Recommended HDL Coding Styles, Inferring Memory Function from HDL Code&#xFF09;&#x5982;&#x679C;&#x5728;cpu&#x8BBE;&#x8BA1;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x5FFD;&#x7565;&#x8FD9;&#x9690;&#x542B;&#x7684;&#x5BC4;&#x5B58;&#x5668;&#xFF0C;&#x4F1A;&#x989D;&#x5916;&#x5F15;&#x5165;&#x81F3;&#x5C11;&#x4E00;&#x4E2A;&#x5468;&#x671F;&#x7684;&#x65F6;&#x5EF6;&#x3002;&#x4F46;cache&#x7684;&#x8BBE;&#x8BA1;&#x76EE;&#x6807;&#x662F;&#x8981;&#x6C42;&#x5728;&#x547D;&#x4E2D;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5FC5;&#x987B;&#x5728;&#x4E00;&#x4E2A;&#x5468;&#x671F;&#x7ED9;&#x51FA;&#x6570;&#x636E;&#x548C;&#x6307;&#x4EE4;&#xFF0C;&#x6240;&#x4EE5;&#x9690;&#x542B;&#x7684;&#x5BC4;&#x5B58;&#x5668;&#x5FC5;&#x987B;&#x52A0;&#x5165;&#x8003;&#x8651;&#x3002;</p>
<h3 id="Cache&#x7684;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;"><a href="#Cache&#x7684;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;" class="headerlink" title="Cache&#x7684;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;"></a>Cache&#x7684;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;</h3><p>&#x53E6;&#x5916;Altera&#x7684;&#x7247;&#x4E0A;&#x5B58;&#x50A8;&#x4E0D;&#x652F;&#x6301;&#x6E05;&#x96F6;&#xFF08;Quartus II Handbook Version 9.1 Volume 1: Design and Synthesis, Chapter 6: Recommended HDL Coding Styles, Inferring Memory Function from HDL Code&#xFF09;&#xFF0C;&#x8FD9;&#x7ED9;&#x5B9E;&#x73B0;cache&#x6E05;&#x96F6;&#x6307;&#x4EE4;&#x5E26;&#x6765;&#x4E86;&#x56F0;&#x96BE;&#xFF1A;&#x5982;&#x679C;&#x4F7F;&#x7528;&#x7247;&#x4E0A;&#x5B58;&#x50A8;&#x6765;&#x5B9E;&#x73B0;cache&#xFF0C;&#x4E0D;&#x80FD;&#x6E05;&#x96F6;&#x4F7F;&#x5F97;&#x5B9E;&#x73B0;cache&#x6E05;&#x96F6;&#x6307;&#x4EE4;&#x6709;&#x56F0;&#x96BE;&#xFF0C;&#x800C;&#x5982;&#x679C;&#x6CA1;&#x6709;cache&#x6E05;&#x96F6;&#x6307;&#x4EE4;&#xFF0C;&#x7F13;&#x5B58;&#x540C;&#x6B65;&#x7684;&#x95EE;&#x9898;&#x5C31;&#x9700;&#x8981;&#x5B8C;&#x5168;&#x7531;&#x786C;&#x4EF6;&#x89E3;&#x51B3;&#x3002;&#x8FD9;&#x53C8;&#x8BA9;&#x6211;&#x601D;&#x8003;&#x662F;&#x5426;&#x5F15;&#x5165;&#x603B;&#x7EBF;&#x76D1;&#x542C;&#xFF08;bus snooping&#xFF09;&#x3002;&#x6709;&#x4EBA;&#x8BA4;&#x4E3A;&#x6211;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x5355;&#x6838;&#x5FC3;&#x5355;&#x7EA7;cache&#x7684;&#x7CFB;&#x7EDF;&#x4E0D;&#x9700;&#x8981;&#x8003;&#x8651;cache&#x4E00;&#x81F4;&#x6027;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x8FD9;&#x6837;&#x7684;&#x60F3;&#x6CD5;&#x4E0D;&#x5B8C;&#x5168;&#x6B63;&#x786E;&#x3002;&#x8003;&#x8651;&#x8FD9;&#x4E24;&#x79CD;&#x60C5;&#x51B5;&#xFF1A;&#x4E00;&#x662F;&#x81EA;&#x4FEE;&#x6539;&#x4EE3;&#x7801;&#xFF08;Self-Modifying code&#xFF09;&#x95EE;&#x9898;&#xFF0C;&#x8BBE;&#x60F3;&#x6709;&#x4E00;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5728;&#x7CFB;&#x7EDF;&#x4E0A;&#x8FD0;&#x884C;&#xFF0C;&#x5C06;&#x67D0;&#x4E2A;&#x7A0B;&#x5E8F;&#x6307;&#x4EE4;&#x4ECE;&#x786C;&#x76D8;&#x52A0;&#x8F7D;&#x5230;&#x5185;&#x5B58;&#xFF0C;&#x6267;&#x884C;&#x4E00;&#x7CFB;&#x5217;LW&#x64CD;&#x4F5C;&#x3002;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x4ECE;&#x786C;&#x76D8;&#x8BFB;&#x53D6;&#x4E00;&#x4E32;&#x6307;&#x4EE4;&#xFF0C;&#x653E;&#x5165;&#x5185;&#x5B58;&#x7684;&#x67D0;&#x4E00;&#x4F4D;&#x7F6E;&#xFF0C;&#x6070;&#x597D;&#x8986;&#x76D6;&#x4E86;&#x4E4B;&#x524D;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x6307;&#x4EE4;&#x3002;&#x6B64;&#x65F6;&#x82E5;I-cache&#x5DF2;&#x7ECF;&#x7F13;&#x5B58;&#x8FC7;&#x8FD9;&#x4E00;&#x533A;&#x57DF;&#xFF0C;I-cache&#x6839;&#x672C;&#x4E0D;&#x77E5;&#x9053;LW&#x6307;&#x4EE4;&#x5DF2;&#x7ECF;&#x4FEE;&#x6539;&#x4E86;&#x8FD9;&#x90E8;&#x5206;&#x5185;&#x5B58;&#x6570;&#x636E;&#xFF0C;&#x8FD9;&#x5C31;&#x4F1A;&#x5F15;&#x8D77;cache&#x4E00;&#x81F4;&#x6027;&#x7684;&#x95EE;&#x9898;&#x3002;&#x5F53;CPU&#x8DF3;&#x8F6C;&#x5230;&#x8FD9;&#x4E2A;&#x533A;&#x57DF;&#xFF0C;I-cache&#x8BA4;&#x4E3A;&#x547D;&#x4E2D;&#xFF0C;&#x5B9E;&#x9645;&#x6267;&#x884C;&#x7684;&#x662F;&#x65E7;&#x6307;&#x4EE4;&#x800C;&#x4E0D;&#x662F;&#x6211;&#x4EEC;&#x901A;&#x8FC7;LW&#x8F7D;&#x5165;&#x7684;&#x65B0;&#x6307;&#x4EE4;&#x3002;&#x4E8C;&#x662F;DMA&#x95EE;&#x9898;&#xFF0C;&#x5F53;&#x603B;&#x7EBF;&#x4E0A;&#x6709;DMA&#x8BF7;&#x6C42;&#x53D1;&#x751F;&#x65F6;&#xFF0C;DMA&#x8BBE;&#x5907;&#x76F4;&#x63A5;&#x4FEE;&#x6539;&#x67D0;&#x4E9B;&#x533A;&#x57DF;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x800C;Cache&#x5E76;&#x4E0D;&#x77E5;&#x9053;&#xFF0C;&#x8FD9;&#x540C;&#x6837;&#x4F1A;&#x5F15;&#x8D77;&#x7F13;&#x5B58;&#x4E00;&#x81F4;&#x6027;&#x95EE;&#x9898;&#x3002;</p>
<h4 id="&#x5BF9;&#x4E8E;DMA"><a href="#&#x5BF9;&#x4E8E;DMA" class="headerlink" title="&#x5BF9;&#x4E8E;DMA"></a>&#x5BF9;&#x4E8E;DMA</h4><p>&#x7B2C;&#x4E8C;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;MIPS&#x5904;&#x7406;&#x5668;&#x91C7;&#x53D6;&#x4E00;&#x79CD;&#x7B80;&#x5355;&#x7C97;&#x66B4;&#x7684;&#x529E;&#x6CD5;&#x6765;&#x89E3;&#x51B3;&#xFF0C;&#x5C31;&#x662F;&#x5728;&#x5185;&#x5B58;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#x4E2D;&#x5355;&#x72EC;&#x5212;&#x51FA;&#x6765;&#x4E00;&#x90E8;&#x5206;&#x4E0D;&#x88AB;cache&#x7D22;&#x5F15;&#xFF0C;&#x6BCF;&#x5F53;&#x5904;&#x7406;&#x5668;&#x8BD5;&#x56FE;&#x83B7;&#x53D6;&#x8FD9;&#x4E2A;&#x5730;&#x5740;&#x8303;&#x56F4;&#x5185;&#x7684;&#x6570;&#x636E;&#x6216;&#x6307;&#x4EE4;&#x65F6;&#xFF0C;&#x90FD;&#x7ED5;&#x8FC7;cache&#xFF0C;&#x4ECE;&#x5185;&#x5B58;&#x4E0A;&#x8BF7;&#x6C42;&#x3002;&#x4F46;&#x662F;&#x7B2C;&#x4E00;&#x79CD;&#x60C5;&#x51B5;&#x8981;&#x9EBB;&#x70E6;&#x4E00;&#x4E9B;&#xFF0C;&#x56E0;&#x4E3A;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x8981;&#x9891;&#x7E41;&#x7684;&#x5C06;&#x7A0B;&#x5E8F;&#x7684;&#x6307;&#x4EE4;&#x5199;&#x5165;&#x5185;&#x5B58;&#xFF0C;&#x6211;&#x4EEC;&#x4E0D;&#x80FD;&#x603B;&#x662F;&#x628A;&#x80FD;&#x81EA;&#x6211;&#x4FEE;&#x6539;&#x7684;&#x6307;&#x4EE4;&#x90E8;&#x5206;&#x653E;&#x5165;&#x8FD9;&#x4E2A;&#x7ED5;&#x8FC7;cache&#x7684;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#x5185;&#xFF0C;&#x8FD9;&#x6837;&#x7684;&#x8BDD;&#x5927;&#x90E8;&#x5206;&#x7A0B;&#x5E8F;&#x90FD;&#x5F97;&#x4E0D;&#x5230;cache&#x7684;&#x901F;&#x5EA6;&#x4F18;&#x52BF;&#xFF0C;&#x8FD8;&#x4E0D;&#x5982;&#x4E0D;&#x5F15;&#x5165;cache&#x3002;</p>
<h4 id="&#x81EA;&#x4FEE;&#x6539;&#x4EE3;&#x7801;-&#xFF08;Self-Modifying-Code&#xFF09;"><a href="#&#x81EA;&#x4FEE;&#x6539;&#x4EE3;&#x7801;-&#xFF08;Self-Modifying-Code&#xFF09;" class="headerlink" title="&#x81EA;&#x4FEE;&#x6539;&#x4EE3;&#x7801; &#xFF08;Self-Modifying Code&#xFF09;"></a>&#x81EA;&#x4FEE;&#x6539;&#x4EE3;&#x7801; &#xFF08;Self-Modifying Code&#xFF09;</h4><p>&#x5982;&#x4F55;&#x641E;&#x5B9A;&#x8FD9;&#x7B2C;&#x4E8C;&#x79CD;&#x60C5;&#x51B5;&#xFF1F;&#x662F;&#x76F4;&#x63A5;&#x5728;&#x786C;&#x4EF6;&#x4E0A;&#x63D0;&#x4F9B;&#x7F13;&#x5B58;&#x4E00;&#x81F4;&#x6027;&#x7684;&#x652F;&#x6301;&#xFF1F;&#x8FD8;&#x662F;&#x52A0;&#x5165;&#x4E00;&#x4E9B;&#x7F13;&#x5B58;&#x540C;&#x6B65;&#x6307;&#x4EE4;&#x5728;&#x5FC5;&#x8981;&#x7684;&#x65F6;&#x5019;&#x7531;&#x7CFB;&#x7EDF;&#x8F6F;&#x4EF6;&#x7F16;&#x5199;&#x8005;&#x5BF9;cache&#x8FDB;&#x884C;&#x7BA1;&#x7406;&#xFF0C;&#x5982;&#x5728;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x52A0;&#x8F7D;&#x65B0;&#x8FDB;&#x7A0B;&#x7684;&#x65F6;&#x5019;&#x624B;&#x52A8;&#x6E05;&#x7A7A;I-cache&#xFF1F;&#x6211;&#x53C2;&#x8003;&#x4E86;&#x4E00;&#x4E9B;&#x8D44;&#x6599;&#x3002;</p>
<p>&#x663E;&#x7136;&#x4E0D;&#x540C;&#x5E73;&#x53F0;&#x5BF9;&#x81EA;&#x4FEE;&#x6539;&#x4EE3;&#x7801;&#x5E26;&#x6765;&#x7684;&#x7F13;&#x5B58;&#x4E0D;&#x4E00;&#x81F4;&#x95EE;&#x9898;&#x7684;&#x5904;&#x7406;&#x65B9;&#x5F0F;&#x4E0D;&#x540C;&#x3002;</p>
<p>X86&#x5E73;&#x53F0;&#x7684;cache&#x4E00;&#x81F4;&#x6027;&#x673A;&#x5236;&#x6BD4;&#x8F83;&#x590D;&#x6742;&#xFF0C;&#x4ECE;&#x67D0;&#x79CD;&#x610F;&#x4E49;&#x4E0A;&#x8BB2;&#xFF0C;&#x53EA;&#x8981;&#x4F7F;&#x7528;&#x8005;&#x6B63;&#x5E38;&#x4F7F;&#x7528;&#x5904;&#x7406;&#x5668;&#xFF0C;cache&#x5BF9;&#x7A0B;&#x5E8F;&#x5458;&#x5B8C;&#x5168;&#x900F;&#x660E;&#x3002;</p>
<p><a target="_blank" rel="noopener" href="https://forum.osdev.org/viewtopic.php?f=13&amp;t=32232">osdev</a>&#x4E0A;&#x6709;&#x4EBA;&#x8BA8;&#x8BBA;&#x8FD9;&#x4E00;&#x70B9;&#xFF1A;</p>
<blockquote>
<p>Everything (including DMA) on 80x86 is cache coherent; except for the following cases &gt;(where you have deliberately &#x201C;weakened&#x201D; cache coherency for performance reasons or broken cache coherency):</p>
<ul>
<li>You&#x2019;re using the &#x201C;write-combining&#x201D; caching type in the MTRRs and/or PAT. In this case writes that are sitting in a CPU&#x2019;s write-combining buffer won&#x2019;t be seen by other hardware.</li>
<li>You&#x2019;re using non-temporal stores. In this case writes that are sitting in a CPU&#x2019;s write-combining buffer won&#x2019;t be seen by other hardware.</li>
<li>You&#x2019;ve seriously messed things up (e.g. used the &#x201C;INVD&#x201D; instruction at CPL=0).</li>
</ul>
<p>All hardware trickery (e.g. eDRAM caches, etc) is designed to uphold this.</p>
</blockquote>
<p>&#x5728;&#x770B;minix&#x4EE3;&#x7801;&#x7684;&#x65F6;&#x5019;&#x6211;&#x5C31;&#x610F;&#x8BC6;&#x5230;&#x4E86;&#x8FD9;&#x4E00;&#x70B9;&#x3002;&#x6211;&#x770B;&#x5B8C;&#x6574;&#x4E2A;&#x542F;&#x52A8;&#x5668;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x91CC;&#x9762;&#x914D;&#x5408;BIOS&#x4E2D;&#x65AD;&#x8FDB;&#x884C;&#x4E86;&#x5927;&#x91CF;DMA&#x64CD;&#x4F5C;&#xFF0C;&#x4ECE;&#x78C1;&#x76D8;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x5230;&#x5185;&#x5B58;&#xFF0C;&#x4ECE;&#x6765;&#x6CA1;&#x6709;&#x5728;&#x4EE3;&#x7801;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#x51FA;&#x73B0;&#x7BA1;&#x7406;cache&#x7684;&#x6307;&#x4EE4;&#x3002;&#x81EA;&#x4FEE;&#x6539;&#x4EE3;&#x7801;&#x5728;Bootloader&#x4E2D;&#x4E5F;&#x662F;&#x968F;&#x5904;&#x53EF;&#x89C1;&#xFF0C;&#x7B2C;&#x4E00;&#x5904;&#x5C31;&#x51FA;&#x73B0;&#x5728;master boot record&#x7684;&#x5F00;&#x5934;&#xFF0C;&#x5C06;BIOS&#x4ECE;MBR&#x78C1;&#x76D8;&#x7B2C;&#x4E00;&#x6247;&#x533A;&#x7684;&#x4E3B;&#x542F;&#x52A8;&#x8BB0;&#x5F55;&#xFF08;Master boot record&#xFF09;512&#x5B57;&#x8282;&#x7684;&#x4EE3;&#x7801;&#x901A;&#x8FC7;BIOS&#x4E2D;&#x65AD;&#x62F7;&#x8D1D;&#x5230;&#x5185;&#x5B58;&#x540E;&#xFF0C;<a target="_blank" rel="noopener" href="http://www.os-forum.com/minix/boot/masterboot.php#">&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;</a>&#x5C06;&#x81EA;&#x8EAB;&#x590D;&#x5236;&#x5230;&#x5176;&#x4ED6;&#x7684;&#x533A;&#x57DF;&#xFF0C;&#x5E76;&#x8DF3;&#x8F6C;&#x5230;&#x8FD9;&#x91CC;&#x3002;&#x8FD9;&#x4E8B;&#x5F88;&#x5178;&#x578B;&#x7684;&#x81EA;&#x4FEE;&#x6539;&#x4EE3;&#x7801;&#x3002;</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">! Code from minix 3.1 master boot record: masterboot.s (line 46-53).</span><br><span class="line">! Copy this code to safety, then jump to it.</span><br><span class="line">	mov	si, sp			! si = start of this code</span><br><span class="line">	push	si			! Also where we&apos;ll return to eventually</span><br><span class="line">	mov	di, #BUFFER		! Buffer area</span><br><span class="line">	mov	cx, #512/2		! One sector</span><br><span class="line">	cld</span><br><span class="line">  rep	movs</span><br><span class="line">	jmpf	BUFFER+migrate, 0	! To safety</span><br></pre></td></tr></table></figure>

<p>&#x53EF;&#x4EE5;&#x6E05;&#x695A;&#x7684;&#x770B;&#x5230;&#xFF0C;&#x5728;&#x7F16;&#x5199;X86&#x6C47;&#x7F16;&#x7A0B;&#x5E8F;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x7A0B;&#x5E8F;&#x5458;&#x4E0D;&#x9700;&#x8981;&#x8003;&#x8651;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x662F;&#x81EA;&#x4FEE;&#x6539;&#x4EE3;&#x7801;&#x800C;&#x5F15;&#x8D77;&#x7684;&#x7F13;&#x5B58;&#x95EE;&#x9898;&#x3002;&#x53EF;&#x662F;&#x4E8B;&#x5B9E;&#x4E0A;&#xFF0C;&#x5728;rep movs&#x6267;&#x884C;&#x65F6;&#xFF0C;&#x540E;&#x7EED;&#x7684;&#x6307;&#x4EE4;&#x5DF2;&#x7ECF;&#x52A0;&#x8F7D;&#x8FDB;&#x5165;&#x6D41;&#x6C34;&#x7EBF;&#x4E86;&#x3002;&#x663E;&#x7136;&#x6D41;&#x6C34;&#x7EBF;&#x4E2D;&#x7684;&#x65E7;&#x6307;&#x4EE4;&#x9700;&#x8981;&#x88AB;&#x5E9F;&#x5F03;&#x3002;</p>
<p>&#x67E5;&#x770B;X86&#x7CFB;&#x7EDF;&#x7F16;&#x7A0B;&#x624B;&#x518C;&#xFF08;Intel software developer&#x2019;s manual Volume 3A: System Programming Guide 11-18&#xFF09; 11.6 Self-Modifying Code , &#x53EF;&#x4EE5;&#x770B;&#x5230;&#x4ECE;&#x5954;&#x817E;&#x56DB;&#x5F00;&#x59CB;&#xFF0C;x86&#x5904;&#x7406;&#x5668;&#x5DF2;&#x7ECF;&#x5728;&#x6D41;&#x6C34;&#x7EBF;&#x548C;cache&#x786C;&#x4EF6;&#x4E0A;&#x505A;&#x4E86;&#x4E00;&#x81F4;&#x6027;&#x673A;&#x5236;&#xFF0C;&#x53EA;&#x8981;&#x662F;&#x4F7F;&#x7528;&#x540C;&#x4E00;&#x7269;&#x7406;&#x5730;&#x5740;&#x8BBF;&#x95EE;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x786C;&#x4EF6;&#x63D0;&#x4F9B;&#x4E00;&#x81F4;&#x6027;&#x652F;&#x6301;&#x3002;X86&#x4E0D;&#x4EC5;&#x5728;cache&#x4E2D;&#x5B9E;&#x73B0;&#x4E86;&#x5199;&#x8BF7;&#x6C42;&#x76D1;&#x542C;&#xFF0C;&#x800C;&#x4E14;&#x8FD8;&#x5728;&#x6D41;&#x6C34;&#x7EBF;&#x4E2D;&#x5E9F;&#x5F03;&#x5DF2;&#x7ECF;&#x9884;&#x53D6;&#x7684;&#x6307;&#x4EE4;&#x3002;</p>
<blockquote>
<h4 id="11-6-Self-Modifying-Code"><a href="#11-6-Self-Modifying-Code" class="headerlink" title="11.6 Self-Modifying Code"></a>11.6 Self-Modifying Code</h4><p>A write to a memory location in a code segment that is currently cached in the processor causes the associated cache line (or lines) to be invalidated. This check is based on the physical address of the instruction. In addition, the P6 family and Pentium processors check whether a write to a code segment may modify an instruction that has been prefetched for execution. If the write affects a prefetched instruction, the prefetch queue is invalidated. This latter check is based on the linear address of the instruction. For the Pentium 4 and Intel Xeon processors, a write or a snoop of an instruction in a code segment, where the target instruction is already decoded and resident in the trace cache, invalidates the entire trace cache. The latter behavior means that programs that self-modify code can cause severe degradation of performance when run on the Pentium 4 and Intel Xeon processors.</p>
<p>In practice, the check on linear addresses should not create compatibility problems among IA-32 processors. Appli- cations that include self-modifying code use the same linear address for modifying and fetching the instruction. Systems software, such as a debugger, that might possibly modify an instruction using a different linear address than that used to fetch the instruction, will execute a serializing operation, such as a CPUID instruction, before the modified instruction is executed, which will automatically resynchronize the instruction cache and prefetch queue. (See Section 8.1.3, &#x201C;Handling Self- and Cross-Modifying Code,&#x201D; for more information about the use of self-modifying code.)</p>
</blockquote>
<p>&#x5404;&#x4E2A;&#x5E73;&#x53F0;&#x5BF9;&#x81EA;&#x4FEE;&#x6539;&#x4EE3;&#x7801;&#x7684;&#x652F;&#x6301;&#x4E0D;&#x540C;&#x3002;</p>
<p><a target="_blank" rel="noopener" href="https://blog.senr.io/blog/why-is-my-perfectly-good-shellcode-not-working-cache-coherency-on-mips-and-arm">&#x8FD9;&#x7BC7;&#x535A;&#x5BA2;</a>&#x5BF9;&#x8DEF;&#x7531;&#x5668;&#x4E2D;&#x5E7F;&#x6CDB;&#x4F7F;&#x7528;&#x7684;MIPS&#x5904;&#x7406;&#x5668;&#x8FDB;&#x884C;&#x4E86;&#x6D4B;&#x8BD5;&#xFF0C;&#x53D1;&#x73B0;&#x5176;&#x5E76;&#x6CA1;&#x6709;&#x5B9E;&#x73B0;&#x81EA;&#x4FEE;&#x6539;&#x4EE3;&#x7801;&#x7684;&#x7F13;&#x5B58;&#x540C;&#x6B65;&#x673A;&#x5236;&#x3002;&#x7531;Stackoverflow&#x4E0A;&#x7684;<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/10989403/how-is-x86-instruction-cache-synchronized">&#x8BA8;&#x8BBA;</a>,PowerPC&#x4E5F;&#x6CA1;&#x6709;&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#x673A;&#x5236;&#xFF0C;&#x8981;&#x6C42;&#x7CFB;&#x7EDF;&#x8F6F;&#x4EF6;&#x8BBE;&#x8BA1;&#x8005;&#x4ECE;&#x8F6F;&#x4EF6;&#x5C42;&#x9762;&#x7EF4;&#x62A4;&#x7F13;&#x5B58;&#x7684;&#x4E00;&#x81F4;&#x6027;&#x3002;</p>
<blockquote>
<p>3.3.1.2.1 Self-Modifying Code</p>
<p>When a processor modifies any memory location that can contain an instruction, software must ensure that the instruction cache is made consistent with data memory and that the modifications are made visible to the instruction fetching mechanism. This must be done even if the cache is disabled or if the page is marked caching-inhibited.</p>
</blockquote>
<h5 id="&#x6211;&#x6253;&#x7B97;&#x5982;&#x4F55;&#x5BF9;&#x81EA;&#x4FEE;&#x6539;&#x4EE3;&#x7801;&#x7684;&#x7F13;&#x5B58;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF1F;"><a href="#&#x6211;&#x6253;&#x7B97;&#x5982;&#x4F55;&#x5BF9;&#x81EA;&#x4FEE;&#x6539;&#x4EE3;&#x7801;&#x7684;&#x7F13;&#x5B58;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF1F;" class="headerlink" title="&#x6211;&#x6253;&#x7B97;&#x5982;&#x4F55;&#x5BF9;&#x81EA;&#x4FEE;&#x6539;&#x4EE3;&#x7801;&#x7684;&#x7F13;&#x5B58;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF1F;"></a>&#x6211;&#x6253;&#x7B97;&#x5982;&#x4F55;&#x5BF9;&#x81EA;&#x4FEE;&#x6539;&#x4EE3;&#x7801;&#x7684;&#x7F13;&#x5B58;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF1F;</h5><p>&#x5982;&#x679C;&#x4E0D;&#x589E;&#x52A0;&#x603B;&#x7EBF;&#x76D1;&#x542C;&#x3001;&#x6D41;&#x6C34;&#x7EBF;&#x56DE;&#x9000;&#x7B49;&#x673A;&#x5236;&#xFF0C;&#x53EA;&#x5F15;&#x5165;&#x6E05;&#x7A7A;cache&#x7684;&#x6307;&#x4EE4;&#xFF0C;&#x90A3;&#x5C31;&#x9700;&#x8981;&#x7CFB;&#x7EDF;&#x7A0B;&#x5E8F;&#x5458;&#x5BF9;&#x81EA;&#x4FEE;&#x6539;&#x4EE3;&#x7801;&#x52A0;&#x4EE5;&#x9650;&#x5236;&#xFF0C;&#x5982;&#x9650;&#x5B9A;&#x5728;&#x5173;&#x4E2D;&#x65AD;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x4FEE;&#x6539;&#x4EE3;&#x7801;&#xFF0C;&#x5E76;&#x5728;&#x4FEE;&#x6539;&#x4EE3;&#x7801;&#x540E;&#x5F15;&#x5165;&#x82E5;&#x5E72;&#x7A7A;&#x6307;&#x4EE4;&#x586B;&#x5145;&#x6D41;&#x6C34;&#x7EBF;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528;&#x6307;&#x4EE4;cache&#x6E05;&#x96F6;&#x6307;&#x4EE4;&#x6E05;&#x96F6;cache&#x3002;&#x8FD9;&#x6837;&#x505A;&#x964D;&#x4F4E;&#x4E86;&#x786C;&#x4EF6;&#x8BBE;&#x8BA1;&#x7684;&#x96BE;&#x5EA6;&#xFF0C;&#x4F46;&#x5BF9;&#x6240;&#x6709;&#x7684;&#x81EA;&#x4FEE;&#x6539;&#x4EE3;&#x7801;&#x65E0;&#x8BBA;&#x5176;&#x662F;&#x5426;&#x5728;&#x7F13;&#x5B58;&#x4E2D;&#x90FD;&#x9700;&#x8981;&#x7528;&#x63A7;&#x5236;&#x4EE4;&#x586B;&#x5145;&#x6D41;&#x6C34;&#x7EBF;&#x3001;&#x6E05;&#x7A7A;cache&#xFF0C;&#x5E26;&#x6765;&#x4E86;&#x989D;&#x5916;&#x7684;&#x6027;&#x80FD;&#x5F00;&#x9500;&#x3002;</p>
<p>&#x603B;&#x7EBF;&#x76D1;&#x542C;&#x5B9E;&#x73B0;&#x8D77;&#x6765;&#x4E0D;&#x590D;&#x6742;&#xFF0C;&#x4F46;&#x662F;&#x7531;&#x4E8E;cache&#x53D8;&#x5316;&#x5F15;&#x8D77;&#x7684;&#x6D41;&#x6C34;&#x7EBF;&#x56DE;&#x9000;&#x673A;&#x5236;&#x548C;&#x4E2D;&#x65AD;&#x7684;&#x76F8;&#x4E92;&#x4F5C;&#x7528;&#x5206;&#x6790;&#x8D77;&#x6765;&#x6709;&#x70B9;&#x590D;&#x6742;&#x3002;&#x662F;&#x5426;&#x589E;&#x52A0;&#x6D41;&#x6C34;&#x7EBF;&#x56DE;&#x9000;&#x673A;&#x5236;&#xFF0C;&#x53D6;&#x51B3;&#x4E8E;&#x80FD;&#x5426;&#x8054;&#x5408;&#x4E2D;&#x65AD;&#xFF0C;&#x5206;&#x6790;&#x6E05;&#x695A;&#x5904;&#x7406;&#x5668;&#x7684;&#x5DE5;&#x4F5C;&#x72B6;&#x6001;&#x3002;&#x5F53;&#x7136;&#x5F15;&#x5165;&#x8FD9;&#x4E2A;cache&#x4E00;&#x81F4;&#x6027;&#x673A;&#x5236;&#x4F1A;&#x5E26;&#x6765;&#x4E00;&#x4E9B;&#x989D;&#x5916;&#x7684;&#x597D;&#x5904;&#xFF0C;&#x6BD4;&#x5982;&#x53EF;&#x4EE5;&#x62D3;&#x5C55;DMA&#x7684;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#xFF0C;&#x53EA;&#x628A;&#x5355;&#x7EAF;&#x7684;IO&#x653E;&#x5728;&#x4E0D;&#x7ECF;&#x8FC7;cache&#x7684;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#x5373;&#x53EF;&#x3002;</p>
<p>&#x4F46;&#x662F;&#xFF0C;&#x5F53;&#x603B;&#x7EBF;&#x76D1;&#x542C;&#x3001;&#x4E2D;&#x65AD;&#x3001;&#x5F02;&#x5E38;&#x548C;&#x6D41;&#x6C34;&#x7EBF;&#x7ED3;&#x5408;&#x8D77;&#x6765;&#x540E;&#xFF0C;&#x4E8B;&#x60C5;&#x53D8;&#x5F97;&#x6709;&#x70B9;&#x590D;&#x6742;&#x3002;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x662F;&#x8981;&#x7EFC;&#x5408;&#x5206;&#x6790;&#x81EA;&#x4FEE;&#x6539;&#x4EE3;&#x7801;&#x5F15;&#x8D77;&#x7684;&#x6D41;&#x6C34;&#x7EBF;&#x548C;cache&#x53D8;&#x5316;&#x4EE5;&#x53CA;&#x5176;&#x4ED6;&#x7684;&#x4E00;&#x573A;&#x548C;&#x4E2D;&#x65AD;&#x7684;&#x7EC4;&#x5408;&#xFF0C;&#x8BBE;&#x8BA1;&#x7535;&#x8DEF;&#x3002;</p>
<p>&#x7CBE;&#x786E;&#x4E2D;&#x65AD;&#x6709;&#x4E24;&#x79CD;&#x5B9E;&#x73B0;&#x65B9;&#x6CD5;&#xFF0C;&#x4E00;&#x662F;&#x65E0;&#x8BBA;&#x4EC0;&#x4E48;&#x65F6;&#x523B;&#x4E2D;&#x65AD;&#x53D1;&#x751F;&#xFF0C;cpu&#x7ACB;&#x523B;&#x6682;&#x505C;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#xFF0C;&#x8FDB;&#x5165;&#x7EC8;&#x7AEF;&#x6D41;&#x7A0B;&#x3002;&#x8FD9;&#x4E2A;&#x8981;&#x6C42;&#x8F83;&#x9AD8;&#xFF0C;&#x9700;&#x8981;&#x5206;&#x6790;&#x4E2D;&#x65AD;&#x53D1;&#x751F;&#x65F6;ID&#x7EA7;&#x7684;&#x4E09;&#x79CD;&#x60C5;&#x51B5;:</p>
<ul>
<li>ID&#x7EA7;&#x662F;&#x8F6C;&#x79FB;&#x6307;&#x4EE4;&#x2013;&#x4E2D;&#x65AD;&#x4FDD;&#x5B58;&#x8DF3;&#x8F6C;&#x6307;&#x4EE4;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x4E2D;&#x65AD;&#x8FD4;&#x56DE;&#x91CD;&#x65B0;&#x6267;&#x884C;</li>
<li>ID&#x7EA7;&#x662F;&#x5904;&#x5728;&#x5EF6;&#x65F6;&#x69FD;&#x4E2D;&#x7684;&#x6307;&#x4EE4;&#x2013;&#x4E2D;&#x65AD;&#x4FDD;&#x5B58;&#x5F53;&#x524D;PC&#xFF0C;&#x8BA9;&#x5EF6;&#x65F6;&#x69FD;&#x4E2D;&#x7684;&#x6307;&#x4EE4;&#x6267;&#x884C;&#x5B8C;&#xFF0C;&#x5F53;&#x524D;PC&#x5C31;&#x662F;&#x4E4B;&#x524D;&#x7684;&#x8DF3;&#x8F6C;&#x8BA1;&#x7B97;&#x51FA;&#x7684;&#x5730;&#x5740;&#x3002;</li>
<li>&#x5176;&#x4ED6;&#x60C5;&#x51B5;&#x2013;&#x4E2D;&#x65AD;&#x4FDD;&#x5B58;&#x5F53;&#x524D;PC&#xFF0C;&#x4E0E;&#x4E0A;&#x4E00;&#x79CD;&#x60C5;&#x51B5;&#x7C7B;&#x4F3C;&#x3002;</li>
</ul>
<p>&#x4E4B;&#x6240;&#x4EE5;&#x9700;&#x8981;&#x8003;&#x8651;&#x8FD9;&#x4E9B;&#x60C5;&#x51B5;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;&#x4E2D;&#x65AD;&#x54CD;&#x5E94;&#x8FC7;&#x7A0B;&#x5904;&#x7406;&#x5668;&#x53D6;&#x6307;&#x7684;&#x5730;&#x5740;&#x53D1;&#x751F;&#x53D8;&#x5316;&#xFF0C;&#x800C;&#x662F;&#x5426;&#x662F;&#x8F6C;&#x79FB;&#x6307;&#x4EE4;&#x3001;&#x662F;&#x5426;&#x5904;&#x5728;&#x5EF6;&#x65F6;&#x69FD;&#x4E2D;&#x5BF9;&#x4E8E;CPU&#x4E0B;&#x4E00;&#x5468;&#x671F;&#x53D6;&#x6307;&#x7684;&#x5730;&#x5740;&#x6709;&#x5F71;&#x54CD;&#x3002;</p>
<p>&#x4E5F;&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x7B49;&#x5230;CPU&#x5904;&#x5728;&#x8F83;&#x4E3A;&#x7A33;&#x5B9A;&#x7684;&#x72B6;&#x6001;&#x65F6;&#x5728;&#x54CD;&#x5E94;&#x4E2D;&#x65AD;&#x3002;&#x4E0A;&#x9762;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x82E5;&#x53D1;&#x751F;&#x4E2D;&#x65AD;&#x65F6;ID&#x7EA7;&#x662F;&#x8F6C;&#x79FB;&#x6307;&#x4EE4;&#xFF0C;&#x5219;&#x6D41;&#x6C34;&#x7EBF;&#x4E2D;&#x8981;&#x53D6;&#x6D88;&#x4E24;&#x6761;&#x6307;&#x4EE4;&#xFF0C;&#x5F85;&#x4E2D;&#x65AD;&#x8FD4;&#x56DE;&#x540E;&#x518D;&#x6B21;&#x91CD;&#x65B0;&#x6267;&#x884C;&#x3002;&#x8FD9;&#x6837;&#x505A;&#x5B9E;&#x9645;&#x4E0A;&#x9020;&#x6210;&#x4E86;&#x989D;&#x5916;&#x7684;&#x6027;&#x80FD;&#x5F00;&#x9500;&#xFF0C;&#x6211;&#x66F4;&#x503E;&#x5411;&#x4E8E;&#x7B49;&#x5F85;CPU&#x8FDB;&#x5165;&#x7A33;&#x5B9A;&#x72B6;&#x6001;&#x65F6;&#x54CD;&#x5E94;&#x4E2D;&#x65AD;&#x8BF7;&#x6C42;&#xFF0C;&#x5728;ID&#x7EA7;&#x662F;&#x8F6C;&#x79FB;&#x6307;&#x4EE4;&#x6216;&#x5EF6;&#x65F6;&#x69FD;&#x65F6;&#x4E0D;&#x54CD;&#x5E94;&#x4E2D;&#x65AD;&#x8BF7;&#x6C42;&#x3002;&#x8FD9;&#x6837;&#x505A;&#x9700;&#x8981;&#x5728;&#x4E2D;&#x65AD;&#x63A7;&#x5236;&#x5668;&#x4E2D;&#x589E;&#x52A0;&#x4E00;&#x4E2A;&#x4E2D;&#x65AD;&#x54CD;&#x5E94;&#x673A;&#x5236;&#xFF0C;&#x5728;&#x6536;&#x5230;&#x54CD;&#x5E94;&#x540E;&#x5E94;&#x7ACB;&#x523B;&#x64A4;&#x9500;&#x4E2D;&#x65AD;&#x8BF7;&#x6C42;&#x3002;</p>
<p>&#x5F02;&#x5E38;&#x7684;&#x60C5;&#x51B5;&#x8981;&#x6BD4;&#x4E2D;&#x65AD;&#x590D;&#x6742;&#xFF0C;&#x56E0;&#x4E3A;&#x5F02;&#x5E38;&#x5F80;&#x5F80;&#x9700;&#x8981;&#x7ACB;&#x5373;&#x5904;&#x7406;&#x3002;&#x4E00;&#x4E2A;&#x590D;&#x6742;&#x7684;CPU&#x5E94;&#x5F53;&#x53EF;&#x4EE5;&#x5904;&#x7406;&#x591A;&#x79CD;&#x5F02;&#x5E38;&#xFF0C;&#x4F8B;&#x5982;&#x4FDD;&#x62A4;&#x6A21;&#x5F0F;&#x5F15;&#x5165;&#x7684;&#x5F02;&#x5E38;&#xFF0C;&#x5728;&#x53D6;&#x6307;&#x3001;&#x8BFB;&#x53D6;&#x3001;&#x5B58;&#x50A8;&#x6570;&#x636E;&#x65F6;&#x90FD;&#x53EF;&#x80FD;&#x53D1;&#x751F;&#x7684;&#x8D85;&#x8FC7;&#x8303;&#x56F4;&#xFF0C;&#x7B97;&#x6570;&#x8FD0;&#x7B97;&#x6EA2;&#x51FA;&#xFF0C;&#x6307;&#x4EE4;&#x672A;&#x5B9E;&#x73B0;&#x3001;syscall&#x6307;&#x4EE4;&#x3001;&#x8FD8;&#x6709;&#x5206;&#x9875;&#x6A21;&#x5F0F;&#x5F15;&#x5165;&#x7684;&#x5F02;&#x5E38;&#x5982;tlb&#x7F3A;&#x5931;&#xFF0C;&#x7F3A;&#x9875;&#x7B49;&#x3002;&#x76EE;&#x524D;&#x6211;&#x5C1A;&#x672A;&#x6253;&#x7B97;&#x5728;&#x6211;&#x7684;CPU&#x4E2D;&#x5B9E;&#x73B0;&#x4FDD;&#x62A4;&#x6A21;&#x5F0F;&#x548C;&#x5206;&#x9875;&#xFF0C;&#x56E0;&#x6B64;&#x76EE;&#x524D;&#x652F;&#x6301;&#x7684;&#x5F02;&#x5E38;&#x65F6;&#x7B97;&#x6570;&#x8FD0;&#x7B97;&#x6EA2;&#x51FA;&#x3001;&#x6307;&#x4EE4;&#x672A;&#x5B9E;&#x73B0;&#x548C;syscall&#x6307;&#x4EE4;&#x3002;&#x7B2C;&#x4E00;&#x4E2A;&#x5F02;&#x5E38;&#x662F;&#x53D1;&#x751F;&#x5728;EXE&#x7EA7;&#xFF0C;&#x540E;&#x4E24;&#x4E2A;&#x662F;&#x53D1;&#x751F;&#x5728;ID&#x7EA7;&#x3002;&#x8FD9;&#x4E09;&#x4E2A;&#x5F02;&#x5E38;EXE&#x7EA7;&#x7684;&#x5F02;&#x5E38;&#x4F18;&#x5148;&#x7EA7;&#x6700;&#x9AD8;&#xFF0C;&#x56E0;&#x4E3A;&#x5176;&#x53D1;&#x751F;&#x5728;&#x6D41;&#x6C34;&#x7EBF;&#x5185;&#x8F83;&#x6DF1;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x800C;&#x5F02;&#x5E38;&#x5904;&#x7406;&#x5F80;&#x5F80;&#x9700;&#x8981;&#x91CD;&#x65B0;&#x6267;&#x884C;&#x9020;&#x6210;&#x5F02;&#x5E38;&#x7684;&#x6307;&#x4EE4;&#xFF0C;&#x6240;&#x4EE5;&#x5F53;&#x591A;&#x79CD;&#x5F02;&#x5E38;&#x540C;&#x65F6;&#x51FA;&#x73B0;&#x5728;&#x6D41;&#x6C34;&#x7EBF;&#x7684;&#x4E0D;&#x540C;&#x9636;&#x6BB5;&#x4E2D;&#xFF0C;&#x6309;&#x7167;&#x5176;&#x53D1;&#x751F;&#x7684;&#x4F4D;&#x7F6E;&#x5B89;&#x6392;&#x4F18;&#x5148;&#x7EA7;&#x5904;&#x7406;&#x65F6;&#x5F97;&#x5F53;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x5F02;&#x5E38;&#x5904;&#x7406;&#x7684;&#x786C;&#x4EF6;&#x7535;&#x8DEF;&#x548C;&#x4E2D;&#x65AD;&#x4E00;&#x6837;&#xFF0C;&#x5728;&#x8BBE;&#x8BA1;&#x65F6;&#x9700;&#x8981;&#x5206;&#x6790;&#x4E0D;&#x540C;&#x9636;&#x6BB5;&#x7684;&#x5F02;&#x5E38;EPC&#x4E2D;&#x8981;&#x4FDD;&#x5B58;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x6D41;&#x6C34;&#x7EBF;&#x4E2D;&#x9700;&#x8981;&#x5E9F;&#x5F03;&#x7684;&#x6307;&#x4EE4;&#xFF0C;nPC&#x4E2D;&#x7684;&#x4E0B;&#x4E00;&#x4E2A;&#x6307;&#x4EE4;&#x5730;&#x5740;&#x3002;&#x5177;&#x4F53;&#x5206;&#x6790;&#x7684;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x770B;&#x674E;&#x4E9A;&#x6C11;&#x7684;&#x4E66;&#x3002;</p>
<p>&#x5176;&#x5B9E;&#x8FD9;&#x91CC;&#x6211;&#x8BA4;&#x4E3A;&#x674E;&#x7684;&#x4E66;&#x4E2D;&#x6240;&#x63CF;&#x8FF0;&#x7684;CPU&#x5DE5;&#x4F5C;&#x8D77;&#x6765;&#x5E94;&#x8BE5;&#x6709;BUG&#x3002;&#x674E;&#x5E76;&#x6CA1;&#x6709;&#x8BBE;&#x8BA1;&#x4E2D;&#x65AD;&#x8BF7;&#x6C42;&#x548C;&#x54CD;&#x5E94;&#x7684;&#x76F8;&#x5E94;&#x673A;&#x5236;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E2D;&#x65AD;&#x5230;&#x6765;&#x5C31;&#x7ACB;&#x523B;&#x8FDB;&#x5165;&#x4E2D;&#x65AD;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x3002;&#x4F46;&#x5728;&#x5176;&#x4EE3;&#x7801;&#x4E2D;&#x53EF;&#x4EE5;&#x6E05;&#x695A;&#x770B;&#x5230;&#xFF0C;&#x4E2D;&#x65AD;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x662F;&#x4F4E;&#x4E8E;&#x5F02;&#x5E38;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x5F53;&#x5F02;&#x5E38;&#x548C;&#x4E2D;&#x65AD;&#x540C;&#x65F6;&#x53D1;&#x751F;&#x65F6;&#xFF0C;&#x7531;&#x4E8E;&#x7F3A;&#x4E4F;&#x4E2D;&#x65AD;&#x8BF7;&#x6C42;&#x548C;&#x54CD;&#x5E94;&#x673A;&#x5236;&#xFF0C;CPU&#x53EF;&#x80FD;&#x5728;&#x5904;&#x7406;&#x5F02;&#x5E38;&#x65F6;&#x9519;&#x8FC7;&#x5916;&#x90E8;&#x4E2D;&#x65AD;&#xFF0C;&#x9020;&#x6210;IO&#x8BBE;&#x5907;&#x6570;&#x636E;&#x4E22;&#x5931;&#x3002;&#x53E6;&#x5916;&#xFF0C;&#x5982;&#x4E0A;&#x6587;&#x6240;&#x8FF0;&#xFF0C;&#x9009;&#x62E9;&#x7ACB;&#x523B;&#x5904;&#x7406;&#x4E2D;&#x65AD;&#x4F1A;&#x5F15;&#x5165;&#x989D;&#x5916;&#x7684;&#x6027;&#x80FD;&#x5F00;&#x9500;&#xFF0C;&#x4F7F;&#x6D41;&#x6C34;&#x7EBF;&#x6027;&#x80FD;&#x4E0B;&#x964D;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x503E;&#x5411;&#x4E8E;&#x9009;&#x62E9;&#x7B49;&#x5F85;&#x65F6;&#x673A;&#x5904;&#x7406;&#x4E2D;&#x65AD;&#x3002;</p>
<p>&#x7531;&#x6B64;&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#xFF0C;&#x5728;&#x6D41;&#x6C34;&#x7EBF;&#x7CFB;&#x7EDF;&#x91CC;&#x5B9E;&#x73B0;&#x4E2D;&#x65AD;&#x548C;&#x5F02;&#x5E38;&#x5904;&#x7406;&#x5E76;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4EFB;&#x52A1;&#x3002;&#x5F53;&#x4F60;&#x5F15;&#x5165;&#x989D;&#x5916;&#x7684;&#x786C;&#x4EF6;&#x63D0;&#x4F9B;&#x7684;cache&#x540C;&#x6B65;&#x652F;&#x6301;&#x65F6;&#xFF0C;&#x4E8B;&#x60C5;&#x5C31;&#x53D8;&#x5F97;&#x66F4;&#x52A0;&#x590D;&#x6742;&#x3002;&#x5F53;MEM&#x7EA7;&#x53D1;&#x751F;&#x4E00;&#x6B21;cache&#x5199;&#x5165;&#xFF0C;&#x82E5;&#x8FD9;&#x6B21;&#x5199;&#x5165;&#x7684;&#x5730;&#x5740;&#x662F;&#x5DF2;&#x7ECF;&#x9884;&#x53D6;&#x3001;&#x5728;&#x6D41;&#x6C34;&#x7EBF;&#x4E2D;&#x6267;&#x884C;&#x7740;&#x7684;&#x6307;&#x4EE4;&#xFF0C;&#x9700;&#x8981;&#x6E05;&#x9664;Icache&#x4E2D;&#x7684;&#x67D0;&#x884C;&#xFF0C;&#x540C;&#x65F6;&#x5C06;&#x88AB;&#x5F71;&#x54CD;&#x7684;&#x6307;&#x4EE4;&#x53CA;&#x5176;&#x4E4B;&#x540E;&#x7684;&#x6307;&#x4EE4;&#x4ECE;&#x6D41;&#x6C34;&#x7EBF;&#x4E2D;&#x5E9F;&#x5F03;&#xFF1B;&#x82E5;&#x4E0D;&#x5F71;&#x54CD;&#x5DF2;&#x7ECF;&#x9884;&#x53D6;&#x7684;&#x6307;&#x4EE4;&#xFF0C;&#x5219;&#x53EA;&#x9700;&#x8981;&#x5728;Icache&#x4E2D;&#x6E05;&#x9664;&#x67D0;&#x884C;&#x5373;&#x53EF;&#x3002;&#x53EF;&#x4EE5;&#x5C06;&#x8FD9;&#x6837;&#x7684;&#x4E8B;&#x4EF6;&#x5F53;&#x4F5C;&#x5F02;&#x5E38;&#x5904;&#x7406;&#xFF0C;&#x4F46;&#x4E0E;&#x5F02;&#x5E38;&#x4E0D;&#x540C;&#x7684;&#x662F;&#xFF0C;&#x67D0;&#x4E2A;&#x5F15;&#x8D77;&#x81EA;&#x4FEE;&#x6539;&#x4EE3;&#x7801;&#x7684;LW&#x6307;&#x4EE4;&#xFF0C;&#x4E0D;&#x4F1A;&#x4EA7;&#x751F;&#x8F6C;&#x79FB;&#xFF0C;&#x53EA;&#x662F;&#x9700;&#x8981;&#x5728;&#x6D41;&#x6C34;&#x7EBF;&#x4E2D;&#x5E9F;&#x5F03;&#x67D0;&#x4E9B;&#x6307;&#x4EE4;&#x3002;&#x82E5;&#x91C7;&#x7528;&#x674E;&#x7684;&#x4E66;&#x4E2D;&#x505A;&#x6CD5;&#xFF0C;&#x60C5;&#x51B5;&#x5C31;&#x4F1A;&#x53D8;&#x5F97;&#x975E;&#x5E38;&#x590D;&#x6742;&#x3002;&#x6211;&#x82E5;&#x5B9E;&#x73B0;&#x786C;&#x4EF6;cache&#x540C;&#x6B65;&#xFF0C;&#x4E00;&#x5B9A;&#x4F1A;&#x9009;&#x62E9;&#x7B49;&#x5F85;&#x65F6;&#x673A;&#xFF08;&#x5904;&#x7406;&#x5668;&#x65E0;&#x5F02;&#x5E38;&#x3001;ID&#x65E0;&#x8DF3;&#x8F6C;&#x3001;ID&#x4E0D;&#x662F;&#x5EF6;&#x65F6;&#x69FD;&#x3001;cache&#x4E0D;&#x9700;&#x8981;&#x540C;&#x6B65;&#xFF09;&#x54CD;&#x5E94;&#x4E2D;&#x65AD;&#xFF0C;&#x8FD9;&#x6837;&#x6D41;&#x6C34;&#x7EBF;&#x63A7;&#x5236;&#x8BBE;&#x8BA1;&#x53EA;&#x9700;&#x8981;&#x5206;&#x6790;&#x5F02;&#x5E38;&#x548C;cache&#x540C;&#x6B65;&#x5373;&#x53EF;&#x3002;</p>
<p>&#x73B0;&#x5206;&#x6790;&#x5F02;&#x5E38;&#x548C;cache&#x540C;&#x6B65;&#xFF1A;&#x5982;&#x679C;&#x6309;&#x7167;&#x6027;&#x80FD;&#x8003;&#x8651;&#xFF0C;cache&#x540C;&#x6B65;&#x4E8B;&#x4EF6;&#x53EF;&#x4EE5;&#x5728;EXE&#x7EA7;&#x5C31;&#x8BA1;&#x7B97;&#x51FA;&#x6765;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x65C1;&#x8DEF;&#x5C06;lw&#x6307;&#x4EE4;&#x5199;&#x5165;&#x7684;&#x76EE;&#x6807;&#x4E0E;IF ID &#x7EA7;&#x6307;&#x4EE4;&#x7684;&#x5730;&#x5740;&#x8FDB;&#x884C;&#x6BD4;&#x8F83;&#xFF0C;&#x5224;&#x65AD;&#x662F;&#x5426;&#x5E9F;&#x5F03;&#x6D41;&#x6C34;&#x7EBF;&#x4E2D;&#x7684;&#x6307;&#x4EE4;&#x3002;&#x7531;&#x4E8E;lw&#x6307;&#x4EE4;&#x4E0D;&#x662F;&#x8DF3;&#x8F6C;&#x6307;&#x4EE4;&#xFF0C;&#x56E0;&#x6B64;&#x53D1;&#x751F;cache&#x540C;&#x6B65;&#x4E8B;&#x4EF6;&#x65F6;&#xFF0C;ID&#x7EA7;&#x4E00;&#x5B9A;&#x4E0D;&#x5904;&#x5728;&#x5EF6;&#x65F6;&#x69FD;&#x3002;&#x5982;&#x679C;&#x4E0D;&#x8003;&#x8651;&#x6027;&#x80FD;&#xFF0C;&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x65E0;&#x8BBA;IF&#x3001;ID&#x90A3;&#x4E2A;&#x6307;&#x4EE4;&#x9700;&#x8981;&#x5E9F;&#x5F03;&#xFF0C;&#x53EA;&#x8981;&#x6709;&#x4E00;&#x4E2A;&#x9700;&#x8981;&#x5E9F;&#x5F03;&#xFF0C;&#x5C31;&#x76F4;&#x63A5;&#x5C06;IF&#x3001;ID&#x4E2D;&#x7684;&#x6307;&#x4EE4;&#x4F5C;&#x5E9F;&#xFF0C;&#x91CD;&#x65B0;&#x6267;&#x884C;&#x3002;&#x5982;&#x679C;&#x8003;&#x8651;&#x6027;&#x80FD;&#xFF0C;&#x4E8B;&#x60C5;&#x5C31;&#x53D8;&#x5F97;&#x590D;&#x6742;&#x4E86;.&#x5982;&#x679C;&#x6B64;&#x65F6;ID&#x7EA7;&#x662F;&#x4E00;&#x4E2A;&#x8DF3;&#x8F6C;&#x6307;&#x4EE4;&#xFF0C;&#x90A3;&#x4E48;&#x5EF6;&#x65F6;&#x69FD;&#x4E2D;&#x7684;&#x6307;&#x4EE4;&#x53D7;&#x5230;cache&#x540C;&#x6B65;&#x7684;&#x5F71;&#x54CD;&#xFF0C;&#x5982;&#x679C;&#x53EA;&#x5E9F;&#x5F03;IF&#x7EA7;&#x6307;&#x4EE4;&#x5C31;&#x4F1A;&#x5F15;&#x8D77;&#x9519;&#x8BEF;&#xFF0C;&#x56E0;&#x4E3A;&#x5904;&#x7406;&#x5668;&#x4E22;&#x5F03;&#x4E86;ID&#x7EA7;&#x7684;&#x8DF3;&#x8F6C;&#x6307;&#x4EE4;&#x8BA1;&#x7B97;&#x51FA;&#x7684;&#x8DF3;&#x8F6C;&#x7ED3;&#x679C;&#xFF0C;&#x7B49;&#x4E8E;ID&#x7EA7;&#x8DF3;&#x8F6C;&#x6307;&#x4EE4;&#x6CA1;&#x6709;&#x8D77;&#x5230;&#x4F5C;&#x7528;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C;Cache&#x540C;&#x6B65;&#x5F71;&#x54CD;IF&#x7EA7;&#x4E2D;&#x7684;&#x6307;&#x4EE4;&#xFF0C;&#x5E94;&#x5F53;&#x5224;&#x65AD;ID&#x7EA7;&#x662F;&#x5426;&#x662F;&#x8DF3;&#x8F6C;&#x6307;&#x4EE4;&#xFF08;&#x6216;syscall&#xFF09;&#xFF0C;&#x5982;&#x679C;&#x662F;&#xFF0C;&#x5219;&#x4E0D;&#x4EC5;&#x8981;&#x5E9F;&#x5F03;IF&#x8FD8;&#x8981;&#x5E9F;&#x5F03;ID&#x3002;</p>
<p>&#x8FD9;&#x6837;&#x770B;&#x6765;&#xFF0C;&#x786C;&#x4EF6;&#x652F;&#x6301;&#x7684;cache&#x540C;&#x6B65;&#x673A;&#x5236;&#x914D;&#x5408;&#x7B49;&#x5F85;&#x65F6;&#x673A;&#x7684;&#x4E2D;&#x65AD;&#x54CD;&#x5E94;&#x673A;&#x5236;&#xFF0C;&#x4EE5;&#x53CA;&#x7ACB;&#x523B;&#x5904;&#x7406;&#x7684;&#x5F02;&#x5E38;&#x673A;&#x5236;&#x5728;&#x786C;&#x4EF6;&#x4E0A;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x3002;&#x4F46;&#x662F;&#x6211;&#x4E0D;&#x6253;&#x7B97;&#x5B9E;&#x73B0;&#x5B83;&#x3002;&#x4E3A;&#x4EC0;&#x4E48;&#x5462;&#xFF1F;</p>
<p>&#x5728;&#x4E4B;&#x524D;&#x7684;&#x8BBE;&#x60F3;&#x4E2D;&#xFF0C;&#x6211;&#x5C06;&#x539F;&#x672C;&#x53D1;&#x751F;&#x5728;MEM&#x7EA7;&#x7684;cache&#x4E8B;&#x4EF6;&#xFF0C;&#x524D;&#x63A8;&#x5230;EXE&#x7EA7;&#xFF0C;&#x8FD9;&#x5F88;&#x5927;&#x7A0B;&#x5EA6;&#x4E0A;&#x907F;&#x514D;&#x4E86;&#x66F4;&#x591A;&#x7684;&#x6D41;&#x6C34;&#x7EBF;&#x6027;&#x80FD;&#x635F;&#x5931;&#x3002;&#x4F46;&#x662F;&#x8FD9;&#x4EC5;&#x4EC5;&#x53EF;&#x4EE5;&#x5728;&#x65E0;&#x5206;&#x9875;&#x673A;&#x5236;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x5B9E;&#x73B0;&#x3002;&#x5982;&#x679C;&#x5B9E;&#x73B0;&#x5206;&#x9875;&#xFF0C;&#x5219;&#x5728;&#x6307;&#x4EE4;&#x4E2D;&#x7684;&#x5730;&#x5740;&#x90FD;&#x662F;&#x865A;&#x5730;&#x5740;&#xFF0C;EXE&#x7EA7;&#x7684;&#x5730;&#x5740;&#x4E5F;&#x662F;&#x865A;&#x5730;&#x5740;&#xFF0C;&#x4E0D;&#x80FD;&#x7528;&#x4E8E;&#x524D;&#x9762;&#x7EA7;&#x6D41;&#x6C34;&#x5BC4;&#x5B58;&#x5668;&#x4E2D;&#x6307;&#x4EE4;&#x5730;&#x5740;&#x7684;&#x6BD4;&#x8F83;&#xFF0C;&#x800C;&#x5B9E;&#x5730;&#x5740;&#x5B9E;&#x5728;&#x67E5;&#x627E;MEM&#x7EA7;&#x4E2D;&#x7684;TLB&#x540E;&#x624D;&#x80FD;&#x5F97;&#x5230;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x4E0A;&#x8FF0;&#x8BBE;&#x8BA1;&#x5728;&#x5B9E;&#x73B0;TLB&#x540E;&#xFF0C;&#x5C31;&#x5931;&#x6548;&#x4E86;&#xFF0C;&#x800C;&#x8BBE;&#x8BA1;TLB&#x662F;&#x672C;&#x9879;&#x76EE;&#x7684;&#x8FDC;&#x671F;&#x8BA1;&#x5212;&#x4E4B;&#x4E00;&#x3002;&#x56E0;&#x6B64;&#x4E0D;&#x59A8;&#x7B49;&#x5230;&#x5B8C;&#x6210;MMU&#x8BBE;&#x8BA1;&#x4E4B;&#x540E;&#xFF0C;&#x5B58;&#x50A8;&#x63A7;&#x5236;&#x7CFB;&#x7EDF;&#x5B9A;&#x578B;&#xFF0C;&#x518D;&#x52A0;&#x5165;&#x786C;&#x4EF6;&#x7684;cache&#x540C;&#x6B65;&#x652F;&#x6301;&#x3002;</p>
<p>&#x56E0;&#x6B64;&#x5F97;&#x51FA;&#x7ED3;&#x8BBA;&#xFF0C;&#x76EE;&#x524D;&#x7684;&#x8BBE;&#x8BA1;&#x91C7;&#x7528;&#x8F6F;&#x4EF6;&#x63A7;&#x5236;&#x7684;cache&#x540C;&#x6B65;&#xFF0C;&#x63D0;&#x4F9B;&#x786C;&#x4EF6;Cache&#x6E05;&#x7A7A;&#x6307;&#x4EE4;&#x3002;&#x7CFB;&#x7EDF;&#x8F6F;&#x4EF6;&#x7F16;&#x5199;&#x8005;&#x5728;&#x7F16;&#x5199;&#x81EA;&#x4FEE;&#x6539;&#x4EE3;&#x7801;&#x65F6;&#xFF0C;&#x5E94;&#x5148;&#x5173;&#x95ED;&#x4E2D;&#x65AD;&#xFF0C;&#x5728;&#x4FEE;&#x6539;&#x5B8C;&#x4EE3;&#x7801;&#x540E;&#x624B;&#x52A8;&#x6E05;&#x7A7A;cache&#xFF0C;&#x5E76;&#x4F7F;&#x7528;&#x7D27;&#x968F;&#x5176;&#x540E;&#x7684;&#x82E5;&#x5E72;&#x7A7A;&#x6307;&#x4EE4;&#x6D88;&#x9664;cache&#x4E0D;&#x540C;&#x6B65;&#x5F15;&#x8D77;&#x7684;&#x6D41;&#x6C34;&#x7EBF;&#x9519;&#x8BEF;&#x3002;</p>

    
    </div>
    
    
</article>






    <script src='https://unpkg.com/mermaid@8.8.0/dist/mermaid.min.js'></script>
    <script>
      if (window.mermaid) {
        mermaid.initialize({theme: 'forest'});
      }
    </script>
  

  
    
        <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/%E6%80%BB%E7%BA%BF%E6%8E%A7%E5%88%B6%E5%99%A8%E8%AE%BE%E8%AE%A1/" itemprop="url">总线控制器设计</a>
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            
                <time datetime="2020-10-14T05:59:02.000Z" itemprop="datePublished">10月 14 2020</time>
            
        </span>
        
        
        <span class="column is-narrow">
            
            
            19 分钟 read (About 2782 words)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <h2 id="&#x603B;&#x7EBF;&#x8BBE;&#x8BA1;"><a href="#&#x603B;&#x7EBF;&#x8BBE;&#x8BA1;" class="headerlink" title="&#x603B;&#x7EBF;&#x8BBE;&#x8BA1;"></a>&#x603B;&#x7EBF;&#x8BBE;&#x8BA1;</h2><h3 id="&#x603B;&#x7EBF;&#x5F62;&#x5F0F;"><a href="#&#x603B;&#x7EBF;&#x5F62;&#x5F0F;" class="headerlink" title="&#x603B;&#x7EBF;&#x5F62;&#x5F0F;"></a>&#x603B;&#x7EBF;&#x5F62;&#x5F0F;</h3><p>CPU&#x5185;cache&#x901A;&#x8FC7;&#x603B;&#x7EBF;&#x4E0E;&#x5176;&#x4ED6;&#x8BBE;&#x5907;&#x5305;&#x62EC;RAM&#x3001;ROM&#x53CA;IO&#x8BBE;&#x5907;&#xFF08;Memory Mapped IO&#xFF09;&#x76F8;&#x8FDE;&#x3002;&#x603B;&#x7EBF;&#x53EF;&#x4EE5;&#x6709;&#x591A;&#x4E2A;&#x4E3B;&#x8BBE;&#x5907;&#xFF0C;&#x80FD;&#x53D1;&#x8D77;&#x8BFB;&#x5199;&#x8BF7;&#x6C42;&#xFF0C;&#x8FD9;&#x4F7F;&#x5F97;&#x8BE5;&#x7CFB;&#x7EDF;&#x62E5;&#x6709;DMA&#x80FD;&#x529B;&#xFF0C;&#x5176;&#x4ED6;&#x8BBE;&#x5907;&#x80FD;&#x5728;&#x603B;&#x7EBF;&#x7A7A;&#x95F2;&#x65F6;&#x62A2;&#x5360;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;&#x5B58;&#x50A8;&#x8BBE;&#x5907;&#x3002;&#x8FD9;&#x4E00;&#x70B9;&#x662F;&#x53D7;&#x5230;ZipCPU&#x542F;&#x53D1;&#x7684;&#xFF0C;ZipCPU&#x4F7F;&#x7528;&#x4E00;&#x79CD;&#x6210;&#x719F;&#x7684;&#x603B;&#x7EBF;&#xFF0C;&#x5728;&#x672C;&#x9879;&#x76EE;&#x4E2D;&#x6211;&#x8BA1;&#x5212;&#x8BBE;&#x8BA1;&#x4E00;&#x79CD;&#x7B80;&#x5355;&#x7684;&#x603B;&#x7EBF;&#x3002;<br>&#x603B;&#x7EBF;&#x8BBE;&#x8BA1;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>========address
========data
--------request
--------ready
--------r_w
--------clk</code></pre><h3 id="&#x603B;&#x7EBF;&#x63A7;&#x5236;&#x5668;"><a href="#&#x603B;&#x7EBF;&#x63A7;&#x5236;&#x5668;" class="headerlink" title="&#x603B;&#x7EBF;&#x63A7;&#x5236;&#x5668;"></a>&#x603B;&#x7EBF;&#x63A7;&#x5236;&#x5668;</h3><p>&#x603B;&#x7EBF;&#x63A7;&#x5236;&#x5668;&#x8BBE;&#x8BA1;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>          ------------
request&lt;--|  state    |--&lt;DMA 0
          |           |--&gt;Grant 0
          |   BUS     |--&lt;DMA 1
          | Controller|--&gt;Grant 1
          |           | ...
          |           |--&lt;DMA 7
    clk&gt;--|           |--&gt;Grant 7
          ------------</code></pre><p>&#x63A7;&#x5236;&#x5668;&#x8D1F;&#x8D23;&#x5BF9;&#x603B;&#x7EBF;&#x4E0A;&#x6240;&#x6709;&#x7684;&#x4E3B;&#x8BBE;&#x5907;&#x8BF7;&#x6C42;&#x8FDB;&#x884C;&#x6392;&#x961F;&#xFF0C;&#x5176;&#x5185;&#x90E8;&#x6307;&#x5B9A;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x7531;DMA 0 -&gt; DMA 7&#x9012;&#x51CF;&#x3002;&#x88AB;&#x5141;&#x8BB8;&#x7684;&#x8BBE;&#x5907;&#xFF0C;&#x4F1A;&#x901A;&#x8FC7;Grant X&#x4FE1;&#x53F7;&#x901A;&#x77E5;&#x4E3B;&#x8BBE;&#x5907;&#xFF0C;&#x7531;&#x8BE5;&#x4FE1;&#x53F7;&#x63A7;&#x5236;&#x8BBE;&#x5907;&#x8FDE;&#x63A5;&#x5728;&#x603B;&#x7EBF;&#x4E0A;&#x7684;&#x4E09;&#x6001;&#x95E8;&#xFF0C;&#x5141;&#x8BB8;&#x5176;&#x4E0E;&#x603B;&#x7EBF;&#x901A;&#x8BAF;&#x3002;&#x5F53;&#x4EFB;&#x610F;&#x8BBE;&#x5907;&#x53D1;&#x8D77;DMA&#x8BF7;&#x6C42;&#x65F6;&#xFF0C;request&#x8F93;&#x51FA;&#x9AD8;&#x7535;&#x5E73;&#xFF08;&#x8BE5;&#x4FE1;&#x53F7;&#x4E0E;&#x603B;&#x7EBF;&#x4E0A;&#x7684;request&#x8FDE;&#x63A5;&#xFF09;&#xFF0C;&#x901A;&#x77E5;&#x4ECE;&#x8BBE;&#x5907;&#x8FDB;&#x884C;&#x901A;&#x8BAF;&#x3002;&#x63A7;&#x5236;&#x5668;&#x5185;&#x90E8;&#x6709;&#x4E00;&#x4E2A;&#x72B6;&#x6001;&#x673A;&#xFF0C;&#x5F53;&#x6709;&#x8BF7;&#x6C42;&#x53D1;&#x51FA;&#x65F6;&#x7684;&#x4E0B;&#x4E00;&#x4E2A;&#x65F6;&#x949F;&#x4E0A;&#x8DF3;&#x8FDB;&#x5165;busy&#x72B6;&#x6001;&#xFF0C;&#x6536;&#x5230;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x4ECE;&#x8BBE;&#x5907;&#x53D1;&#x9001;&#x6765;&#x7684;ready&#x540E;&#x7684;&#x4E0B;&#x4E00;&#x4E2A;&#x65F6;&#x949F;&#x4E0A;&#x8DF3;&#x8FDB;&#x5165;idle&#x72B6;&#x6001;&#x3002;&#x5728;busy&#x72B6;&#x6001;&#x5176;&#x8F93;&#x51FA;&#x4E0D;&#x53D8;&#xFF0C;&#x7B49;&#x5F85;&#x8BE5;&#x8BBE;&#x5907;&#x901A;&#x8BAF;&#x7ED3;&#x675F;&#xFF0C;&#x603B;&#x7EBF;&#x624D;&#x7A7A;&#x95F2;&#x3002;&#x8BE5;&#x63A7;&#x5236;&#x5668;&#x7531;bus_control.v&#x5B9E;&#x73B0;&#x3002;&#x603B;&#x7EBF;&#x4E0A;&#x7684;&#x8BF7;&#x6C42;&#x53D1;&#x9001;&#x548C;&#x6570;&#x636E;&#x63A5;&#x6536;&#x90FD;&#x5728;&#x4E00;&#x4E2A;&#x65F6;&#x949F;&#x5185;&#x5B8C;&#x6210;&#x3002;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">module</span> bus_control(</span><br><span class="line">    dma,grant,req,ready,clk</span><br><span class="line">);</span><br><span class="line">    <span class="hljs-keyword">input</span>   [<span class="hljs-number">7</span>:<span class="hljs-number">0</span>] dma;</span><br><span class="line">    <span class="hljs-keyword">input</span>   ready, clk;</span><br><span class="line">    <span class="hljs-keyword">output</span>  [<span class="hljs-number">7</span>:<span class="hljs-number">0</span>] grant;</span><br><span class="line">    <span class="hljs-keyword">output</span>  req;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">//--------------------------    Module implementation  -------------------------</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//registered grant value.</span></span><br><span class="line">    <span class="hljs-keyword">reg</span> [<span class="hljs-number">7</span>:<span class="hljs-number">0</span>] grant_reg;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//internal state machine</span></span><br><span class="line">    <span class="hljs-keyword">reg</span> state;</span><br><span class="line">    <span class="hljs-keyword">always</span> @(<span class="hljs-keyword">posedge</span> clk)</span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        <span class="hljs-keyword">case</span> (state)</span><br><span class="line"></span><br><span class="line">        <span class="hljs-comment">//Idle state, in this state, if has a req, jump to state busy</span></span><br><span class="line">        <span class="hljs-comment">//and register the grant value, this device is chosen, and </span></span><br><span class="line">        <span class="hljs-comment">//other devices&apos; request can&apos;t change the output.</span></span><br><span class="line">            <span class="hljs-number">0</span>: <span class="hljs-keyword">begin</span></span><br><span class="line">                <span class="hljs-keyword">if</span> (req)</span><br><span class="line">                    state &lt;= <span class="hljs-number">1</span>;</span><br><span class="line">                    grant_reg &lt;= grant_inner;</span><br><span class="line">            <span class="hljs-keyword">end</span></span><br><span class="line">        <span class="hljs-comment">//Busy state, in this state, if has a ready, jump to state idle</span></span><br><span class="line">            <span class="hljs-number">1</span>: <span class="hljs-keyword">begin</span></span><br><span class="line">                <span class="hljs-keyword">if</span> (ready)</span><br><span class="line">                    state &lt;= <span class="hljs-number">0</span>;</span><br><span class="line">            <span class="hljs-keyword">end</span></span><br><span class="line">        <span class="hljs-keyword">endcase</span></span><br><span class="line">    <span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//dma request queue.</span></span><br><span class="line">    <span class="hljs-keyword">reg</span> [<span class="hljs-number">7</span>:<span class="hljs-number">0</span>] grant_inner;</span><br><span class="line">    <span class="hljs-keyword">always</span> @(*)</span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        <span class="hljs-keyword">casez</span> (dma)</span><br><span class="line">            <span class="hljs-number">8&apos;bzzzzzzz1</span> :  grant_inner = <span class="hljs-number">8&apos;b00000001</span>;</span><br><span class="line">            <span class="hljs-number">8&apos;bzzzzzz10</span> :  grant_inner = <span class="hljs-number">8&apos;b00000010</span>;</span><br><span class="line">            <span class="hljs-number">8&apos;bzzzzz100</span> :  grant_inner = <span class="hljs-number">8&apos;b00000100</span>;</span><br><span class="line">            <span class="hljs-number">8&apos;bzzzz1000</span> :  grant_inner = <span class="hljs-number">8&apos;b00001000</span>;</span><br><span class="line">            <span class="hljs-number">8&apos;bzzz10000</span> :  grant_inner = <span class="hljs-number">8&apos;b00010000</span>;</span><br><span class="line">            <span class="hljs-number">8&apos;bzz100000</span> :  grant_inner = <span class="hljs-number">8&apos;b00100000</span>;</span><br><span class="line">            <span class="hljs-number">8&apos;bz1000000</span> :  grant_inner = <span class="hljs-number">8&apos;b01000000</span>;</span><br><span class="line">            <span class="hljs-number">8&apos;b10000000</span> :  grant_inner = <span class="hljs-number">8&apos;b10000000</span>;</span><br><span class="line">            <span class="hljs-keyword">default</span>     :  grant_inner = <span class="hljs-number">8&apos;b00000000</span>; </span><br><span class="line">        <span class="hljs-keyword">endcase</span></span><br><span class="line">    <span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//When state == 0 (idle), grant is the instant output of code above</span></span><br><span class="line">    <span class="hljs-comment">//When state == 1 (busy), grant is the registered value.</span></span><br><span class="line">    <span class="hljs-comment">//This lets the grant output stable when one device has already been</span></span><br><span class="line">    <span class="hljs-comment">//chosen.</span></span><br><span class="line">    <span class="hljs-keyword">assign</span>  grant = state ? grant_reg : grant_inner;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//The req signal will remain untill ready signal is received.</span></span><br><span class="line">    <span class="hljs-keyword">assign</span>   req = (|grant) ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">endmodule</span> <span class="hljs-comment">//bus_control</span></span><br></pre></td></tr></table></figure>
<p>&#x603B;&#x7EBF;&#x63A7;&#x5236;&#x5668;&#x4EFF;&#x771F;&#x5982;&#x56FE;:<br><img src="/%E6%80%BB%E7%BA%BF%E6%8E%A7%E5%88%B6%E5%99%A8%E8%AE%BE%E8%AE%A1/bus_control_t.JPG" alt="&#x603B;&#x7EBF;&#x63A7;&#x5236;&#x5668;&#x4EFF;&#x771F;"></p>
<h3 id="&#x603B;&#x7EBF;&#x4E0A;&#x7684;&#x8BBE;&#x5907;"><a href="#&#x603B;&#x7EBF;&#x4E0A;&#x7684;&#x8BBE;&#x5907;" class="headerlink" title="&#x603B;&#x7EBF;&#x4E0A;&#x7684;&#x8BBE;&#x5907;"></a>&#x603B;&#x7EBF;&#x4E0A;&#x7684;&#x8BBE;&#x5907;</h3><p>&#x603B;&#x7EBF;&#x4E0A;&#x7684;&#x4E3B;&#x8BBE;&#x5907;&#xFF0C;&#x8FDE;&#x63A5;&#x603B;&#x7EBF;&#x4E0A;address&#x3001;data&#x3001;r_w&#x548C;ready&#xFF0C;&#x8FDE;&#x63A5;&#x63A7;&#x5236;&#x5668;&#x7684;DMA X&#x548C;Grant X&#x3002;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#x65F6;&#xFF0C;&#x5C06;DMA x&#x7F6E;&#x9AD8;&#x7535;&#x5E73;&#xFF0C;&#x6392;&#x961F;&#x6210;&#x529F;&#x540E;&#xFF0C;&#x7531;Grant X&#x4FE1;&#x53F7;&#x63A7;&#x5236;address&#x3001;data&#x3001;r_w&#x548C;ready&#x4E0A;&#x7684;&#x4E09;&#x6001;&#x95E8;&#x3002;&#x53EA;&#x6709;&#x5F53;&#x8BBE;&#x5907;&#x88AB;&#x63A7;&#x5236;&#x5668;&#x9009;&#x4E2D;&#xFF0C;address&#x3001;data&#x3001;r_w&#x624D;&#x80FD;&#x5728;&#x603B;&#x7EBF;&#x4E0A;&#x8F93;&#x51FA;&#x6216;&#x8005;&#x8F93;&#x5165;&#xFF0C;&#x5426;&#x5219;&#x8FD9;&#x4E9B;&#x4FE1;&#x53F7;&#x662F;&#x9AD8;&#x963B;&#x72B6;&#x6001;&#x3002;&#x4E3B;&#x8BBE;&#x5907;&#x5BF9;&#x5176;&#x662F;&#x5426;&#x88AB;&#x9009;&#x4E2D;&#x662F;&#x4E0D;&#x53EF;&#x77E5;&#x7684;&#xFF0C;&#x5F53;&#x67D0;&#x4E2A;&#x4E3B;&#x8BBE;&#x5907;&#x53D1;&#x8D77;&#x4E86;&#x8BF7;&#x6C42;&#xFF0C;&#x4ED6;&#x4FBF;&#x5C06;&#x5176;&#x8BF7;&#x6C42;&#x7684;&#x5730;&#x5740;&#x3001;&#x6570;&#x636E;&#x3001;&#x8BFB;&#x5199;&#x60C5;&#x51B5;&#x653E;&#x5728;&#x8F93;&#x51FA;&#x7AEF;&#x53E3;&#xFF0C;&#x800C;&#x8F93;&#x51FA;&#x7AEF;&#x53E3;&#x7684;&#x4E09;&#x6001;&#x95E8;&#x662F;&#x7531;&#x603B;&#x7EBF;&#x63A7;&#x5236;&#x5668;&#x4F20;&#x56DE;&#x7684;Grant X&#x4FE1;&#x53F7;&#x63A7;&#x5236;&#x7684;&#x3002;&#x82E5;&#x5176;&#x672A;&#x88AB;&#x63A7;&#x5236;&#x5668;&#x9009;&#x4E2D;&#xFF0C;&#x8BE5;&#x8BBE;&#x5907;&#x65E0;&#x6CD5;&#x6536;&#x5230;&#x5176;&#x4ED6;&#x8BBE;&#x5907;&#x53D1;&#x9001;&#x7684;ready&#x4FE1;&#x53F7;&#xFF0C;&#x56E0;&#x6B64;&#x5904;&#x4E8E;&#x7B49;&#x5F85;&#x72B6;&#x6001;&#x3002;&#x56E0;&#x6B64;&#x5728;&#x603B;&#x7EBF;&#x7A7A;&#x95F2;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5982;CPU&#x8FDE;&#x7EED;cache&#x547D;&#x4E2D;&#xFF0C;&#x5176;&#x4ED6;&#x8BBE;&#x5907;&#x5373;&#x53EF;&#x4F7F;&#x7528;&#x603B;&#x7EBF;&#x8FDB;&#x884C;DMA&#x8BF7;&#x6C42;&#x3002;</p>
<p>&#x603B;&#x7EBF;&#x4E0A;&#x7684;&#x4ECE;&#x8BBE;&#x5907;&#xFF0C;&#x5176;&#x63A5;&#x53E3;&#x5E94;&#x5BF9;&#x5730;&#x5740;&#x7EBF;&#x8FDB;&#x884C;&#x8303;&#x56F4;&#x5224;&#x5B9A;&#xFF0C;&#x5730;&#x5740;&#x7EBF;&#x9009;&#x5B9A;&#x8BE5;&#x8BBE;&#x5907;&#x5185;&#x5730;&#x5740;&#x5373;&#x8BA4;&#x4E3A;&#x5BF9;&#x8BE5;&#x8BBE;&#x5907;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#x3002;&#x5728;&#x88AB;&#x8BF7;&#x6C42;&#x7684;&#x6570;&#x636E;&#x51C6;&#x5907;&#x597D;&#x540E;&#xFF0C;&#x5E94;&#x5C06;&#x6570;&#x636E;&#x8F93;&#x51FA;&#x5230;&#x603B;&#x7EBF;&#xFF0C;&#x5E76;&#x5C06;ready&#x7F6E;&#x9AD8;&#x7535;&#x5E73;&#x3002;</p>
<p>CPU&#x5185;&#x90E8;&#x7684;cache&#x63A7;&#x5236;&#x5668;&#x662F;&#x4E3B;&#x8BBE;&#x5907;&#xFF0C;&#x53EA;&#x80FD;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#x800C;&#x4E0D;&#x80FD;&#x88AB;&#x8BF7;&#x6C42;&#x3002;&#x5927;&#x90E8;&#x5206;&#x7684;IO&#x8BBE;&#x5907;&#x90FD;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x4E3B;/&#x4ECE;&#x8BBE;&#x5907;,&#x65E2;&#x53EF;&#x4EE5;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x8BF7;&#x6C42;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x8FD9;&#x6837;&#x7684;&#x8BBE;&#x5907;&#x8981;&#x8BBE;&#x8BA1;&#x5206;&#x5F00;&#x7684;&#x7AEF;&#x53E3;&#xFF0C;&#x8D1F;&#x8D23;&#x63A5;&#x53D7;&#x8BF7;&#x6C42;&#x7684;&#x4ECE;&#x8BBE;&#x5907;&#x4F7F;&#x7528;&#x4ECE;&#x8BBE;&#x5907;&#x63A5;&#x53E3;&#xFF0C;&#x8D1F;&#x8D23;&#x53D1;&#x8D77;&#x8BF7;&#x6C42;&#x7684;&#x4E3B;&#x8BBE;&#x5907;&#x4F7F;&#x7528;&#x4E3B;&#x8BBE;&#x5907;&#x63A5;&#x53E3;&#x3002;</p>
<h2 id="&#x6D4B;&#x8BD5;"><a href="#&#x6D4B;&#x8BD5;" class="headerlink" title="&#x6D4B;&#x8BD5;"></a>&#x6D4B;&#x8BD5;</h2><p>&#x5982;&#x4F55;&#x8BBE;&#x8BA1;&#x5E76;&#x5355;&#x72EC;&#x6D4B;&#x8BD5;&#x603B;&#x7EBF;&#x8FD9;&#x4E00;&#x90E8;&#x5206;&#x5462;&#xFF1F;&#x9700;&#x8981;&#x8BBE;&#x8BA1;&#x4E3B;&#x4ECE;&#x8BBE;&#x5907;&#x63A5;&#x53E3;&#xFF0C;&#x4E3B;&#x4ECE;&#x8BBE;&#x5907;&#x6A21;&#x62DF;&#x5668;&#xFF0C;&#x5E76;&#x5C06;&#x6A21;&#x62DF;&#x8BBE;&#x5907;&#x63A5;&#x5165;&#x603B;&#x7EBF;&#x548C;&#x63A7;&#x5236;&#x5668;&#x8FDB;&#x884C;&#x65B9;&#x9488;&#x548C;&#x6D4B;&#x8BD5;&#x3002;</p>
<h3 id="&#x4ECE;&#x8BBE;&#x5907;&#x6A21;&#x62DF;"><a href="#&#x4ECE;&#x8BBE;&#x5907;&#x6A21;&#x62DF;" class="headerlink" title="&#x4ECE;&#x8BBE;&#x5907;&#x6A21;&#x62DF;"></a>&#x4ECE;&#x8BBE;&#x5907;&#x6A21;&#x62DF;</h3><p>&#x9996;&#x5148;&#x8BBE;&#x8BA1;&#x4E86;&#x4E00;&#x4E2A;&#x6A21;&#x5757;dummy_slave&#x6765;&#x6A21;&#x62DF;&#x4ECE;&#x8BBE;&#x5907;&#x5728;&#x603B;&#x7EBF;&#x4E0A;&#x7684;&#x884C;&#x4E3A;&#x3002;&#x8FD9;&#x4E2A;&#x4ECE;&#x8BBE;&#x5907;&#x53EF;&#x4EE5;&#x770B;&#x4F5C;&#x4E00;&#x4E2A;&#x5185;&#x5B58;&#x8BBE;&#x5907;&#xFF0C;&#x9700;&#x8981;&#x51E0;&#x4E2A;&#x5468;&#x671F;&#x5C06;&#x6570;&#x636E;&#x51C6;&#x5907;&#x597D;&#xFF0C;&#x53EF;&#x4EE5;&#x8BFB;&#x53EF;&#x4EE5;&#x5199;&#x3002;&#x8FD9;&#x4E2A;&#x4ECE;&#x8BBE;&#x5907;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x4F5C;&#x5904;&#x7406;&#x5668;&#x7684;&#x6D4B;&#x8BD5;&#x3002;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">//module for dummy slave devices.</span></span><br><span class="line"><span class="hljs-keyword">module</span> dummy_slave( </span><br><span class="line">    clk,address, data, request, ready_out, r_w</span><br><span class="line">);</span><br><span class="line">    <span class="hljs-keyword">input</span> clk, r_w, request;</span><br><span class="line">    <span class="hljs-keyword">input</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] address;</span><br><span class="line">    <span class="hljs-keyword">inout</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] data;</span><br><span class="line">    <span class="hljs-keyword">output</span> ready_out;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">//--------------------------    Module implementation  -------------------------</span></span><br><span class="line">    <span class="hljs-comment">//dummy memory</span></span><br><span class="line">    <span class="hljs-keyword">reg</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] mem [<span class="hljs-number">0</span>:<span class="hljs-number">32</span>-<span class="hljs-number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//internal state machine</span></span><br><span class="line">    <span class="hljs-keyword">reg</span> [ <span class="hljs-number">2</span>:<span class="hljs-number">0</span>] state;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//address range</span></span><br><span class="line">    <span class="hljs-keyword">reg</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] entry_start, entry_end;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//internal registers for bus signal</span></span><br><span class="line">    <span class="hljs-keyword">reg</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] addr_reg,data_reg;</span><br><span class="line">    <span class="hljs-keyword">reg</span> r_w_reg,selected_reg;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">initial</span> </span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        entry_start=<span class="hljs-number">32&apos;b0</span>;</span><br><span class="line">        entry_end  =<span class="hljs-number">32&apos;b11111</span>;</span><br><span class="line">        state      = <span class="hljs-number">0</span>;</span><br><span class="line">        <span class="hljs-comment">//ready signal is Z when idle, ready line should have a tri0 </span></span><br><span class="line">        <span class="hljs-comment">//pulldown resistance. because there&apos;re other devices on the</span></span><br><span class="line">        <span class="hljs-comment">//bus.</span></span><br><span class="line">        ready = <span class="hljs-number">1&apos;b0</span>;</span><br><span class="line">        addr_reg =<span class="hljs-number">0</span>;</span><br><span class="line">        data_reg=<span class="hljs-number">0</span>;</span><br><span class="line">        r_w_reg=<span class="hljs-number">0</span>;</span><br><span class="line">        selected_reg=<span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//selected if request in address range</span></span><br><span class="line">    <span class="hljs-keyword">reg</span> selected;</span><br><span class="line">    <span class="hljs-keyword">always</span> @(*)</span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        <span class="hljs-keyword">if</span> ((address &gt;= entry_start) &amp;(address &lt;=entry_end) &amp;request )</span><br><span class="line">            selected = <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">else</span>    selected =<span class="hljs-number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">end</span> </span><br><span class="line">    <span class="hljs-comment">//put the ready_out High Z when device is not selected.   </span></span><br><span class="line">    <span class="hljs-keyword">reg</span> ready;</span><br><span class="line">    <span class="hljs-keyword">assign</span> ready_out = (selected | selected_reg) ? ready : <span class="hljs-number">1&apos;bz</span>;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//implement inout data port.</span></span><br><span class="line">    <span class="hljs-comment">//if device is selected and the request is a read request, this device</span></span><br><span class="line">    <span class="hljs-comment">//will put data onto the bus. In any other condition, the output will be</span></span><br><span class="line">    <span class="hljs-comment">//high Z.</span></span><br><span class="line">    <span class="hljs-keyword">assign</span> data = (selected_reg &amp; ~r_w_reg &amp; ready) ? read :<span class="hljs-number">32&apos;bz</span>;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//read is the continuous read data out.</span></span><br><span class="line">    <span class="hljs-keyword">wire</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] read;</span><br><span class="line">    <span class="hljs-keyword">assign</span> read = mem[addr_reg];</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//the state machine implements the dummy wait cycles and ready signal.</span></span><br><span class="line">    <span class="hljs-comment">//one dummy operation needs four cycles.</span></span><br><span class="line">    <span class="hljs-keyword">always</span> @(<span class="hljs-keyword">posedge</span> clk)</span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        <span class="hljs-comment">//If device is in idle state and selected, register address, r_w </span></span><br><span class="line">        <span class="hljs-comment">//and data.</span></span><br><span class="line">        <span class="hljs-keyword">if</span> ((state == <span class="hljs-number">2&apos;b00</span>)&amp; selected) <span class="hljs-keyword">begin</span></span><br><span class="line">            state &lt;=  <span class="hljs-number">2&apos;b01</span>;</span><br><span class="line"></span><br><span class="line">            <span class="hljs-comment">//pull the ready line low.</span></span><br><span class="line">            ready &lt;=  <span class="hljs-number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="hljs-comment">//registered the request</span></span><br><span class="line">            addr_reg&lt;= address;</span><br><span class="line">            r_w_reg &lt;= r_w;</span><br><span class="line">            selected_reg&lt;=selected;</span><br><span class="line">            <span class="hljs-keyword">if</span> (r_w) <span class="hljs-keyword">begin</span></span><br><span class="line">                data_reg&lt;= data;</span><br><span class="line">            <span class="hljs-keyword">end</span></span><br><span class="line">        <span class="hljs-keyword">end</span></span><br><span class="line">        <span class="hljs-comment">//dummy write and read.</span></span><br><span class="line">        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (state == <span class="hljs-number">2&apos;b01</span> ) <span class="hljs-keyword">begin</span></span><br><span class="line">            state &lt;= <span class="hljs-number">2&apos;b10</span>;</span><br><span class="line">            <span class="hljs-keyword">if</span> (r_w_reg) </span><br><span class="line">                mem[addr_reg] &lt;= data_reg; </span><br><span class="line">        <span class="hljs-keyword">end</span>       </span><br><span class="line">        <span class="hljs-comment">//dummy wait. </span></span><br><span class="line">        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (state == <span class="hljs-number">2&apos;b10</span>) <span class="hljs-keyword">begin</span></span><br><span class="line">            state &lt;= <span class="hljs-number">2&apos;b11</span>;</span><br><span class="line">        <span class="hljs-keyword">end</span></span><br><span class="line">        <span class="hljs-comment">//operation ready</span></span><br><span class="line">        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (state == <span class="hljs-number">2&apos;b11</span>) <span class="hljs-keyword">begin</span> </span><br><span class="line">            state &lt;= <span class="hljs-number">3&apos;b100</span>;</span><br><span class="line">            <span class="hljs-comment">//one cycle ready signal</span></span><br><span class="line">            ready &lt;= <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="hljs-comment">//goto idle next cycle, ready for next request</span></span><br><span class="line">        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (state ==<span class="hljs-number">3&apos;b100</span>) <span class="hljs-keyword">begin</span></span><br><span class="line">            state &lt;= <span class="hljs-number">00</span>;</span><br><span class="line">            ready &lt;= <span class="hljs-number">1&apos;b0</span>;</span><br><span class="line">            selected_reg&lt;= <span class="hljs-number">0</span>;</span><br><span class="line">            r_w_reg &lt;=<span class="hljs-number">0</span>;</span><br><span class="line">            data_reg &lt;=<span class="hljs-number">0</span>;</span><br><span class="line">            addr_reg&lt;=<span class="hljs-number">0</span>;</span><br><span class="line">        <span class="hljs-keyword">end</span></span><br><span class="line">        <span class="hljs-keyword">else</span> <span class="hljs-keyword">begin</span> </span><br><span class="line">            <span class="hljs-comment">//if device is idle, and there&apos;s no request on this device</span></span><br><span class="line">            <span class="hljs-comment">//clear all internal registers.</span></span><br><span class="line">            state &lt;= <span class="hljs-number">00</span>;</span><br><span class="line">            ready &lt;= <span class="hljs-number">1&apos;b0</span>;</span><br><span class="line">            selected_reg&lt;= <span class="hljs-number">0</span>;</span><br><span class="line">            r_w_reg &lt;=<span class="hljs-number">0</span>;</span><br><span class="line">            data_reg &lt;=<span class="hljs-number">0</span>;</span><br><span class="line">            addr_reg&lt;=<span class="hljs-number">0</span>;</span><br><span class="line">        <span class="hljs-keyword">end</span></span><br><span class="line">    <span class="hljs-keyword">end</span></span><br><span class="line"><span class="hljs-keyword">endmodule</span> <span class="hljs-comment">//dummy_slave</span></span><br></pre></td></tr></table></figure>

<p>&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#xFF0C;&#x5728;quartus&#x4E2D;&#x7EFC;&#x5408;&#x751F;&#x6210;&#x4E86;&#x4E00;&#x4E2A;&#x9690;&#x542B;&#x7684;&#x8C03;&#x7528;FPGA&#x7247;&#x4E0A;&#x5B58;&#x50A8;&#x7684;&#x6A21;&#x5757;&#xFF0C;&#x6A21;&#x5757;&#x7684;&#x7C7B;&#x578B;&#x662F;dual port/single clock RAM.&#x5176;&#x5B9E;&#x6211;&#x6240;&#x8BBE;&#x8BA1;&#x7684;&#x6A21;&#x578B;&#x5E94;&#x5F53;&#x662F;&#x4E00;&#x4E2A;&#x5355;&#x7AEF;&#x53E3;RAM&#xFF0C;&#x6211;&#x67E5;&#x770B;&#x4E86;Altera&#x7684;&#x624B;&#x518C;&#xFF0C;&#x4E5F;&#x53C2;&#x8003;&#x4E86;quartus&#x7684;&#x4EE3;&#x7801;&#x7247;&#x6BB5;,&#x4F46;&#x662F;&#x7EFC;&#x5408;&#x540E;&#x7684;&#x7ED3;&#x679C;&#x4ECD;&#x7136;&#x662F;&#x53CC;&#x7AEF;&#x53E3;RAM&#xFF0C;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x8BA9;&#x6211;&#x60F3;&#x4E0D;&#x660E;&#x767D;&#x3002;&#x4F46;&#x662F;&#x7EFC;&#x5408;&#x7684;&#x7ED3;&#x679C;&#x6EE1;&#x8DB3;&#x6211;&#x7684;&#x8BBE;&#x8BA1;&#x9700;&#x6C42;&#x3002;&#x7EC6;&#x60F3;&#x5355;&#x7AEF;&#x53E3;&#x548C;&#x53CC;&#x7AEF;&#x53E3;RAM&#x7684;&#x533A;&#x522B;&#xFF0C;&#x8FD9;&#x91CC;&#x7EFC;&#x5408;&#x751F;&#x6210;&#x7684;&#x53CC;&#x7AEF;&#x53E3;&#xFF0C;&#x5E94;&#x662F;&#x8BFB;&#x5199;&#x7AEF;&#x53E3;&#x5171;&#x7528;&#x5730;&#x5740;&#x7EBF;&#x548C;&#x6570;&#x636E;&#x7EBF;&#xFF0C;&#x4F46;&#x8BFB;&#x7AEF;&#x53E3;&#x7684;&#x6570;&#x636E;&#x7EBF;&#x7528;&#x4E09;&#x6001;&#x95E8;&#x63A7;&#x5236;&#xFF0C;&#x4EC5;&#x5728;&#x5199;&#x4FE1;&#x53F7;&#x65E0;&#x6548;&#x65F6;&#x624D;&#x5411;&#x603B;&#x7EBF;&#x8F93;&#x51FA;&#x3002;&#x56E0;&#x4E3A;&#x6211;&#x5E76;&#x4E0D;&#x6E05;&#x695A;Quartus&#x7EFC;&#x5408;&#x7684;&#x7EC6;&#x8282;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x8FD9;&#x91CC;&#x6211;&#x5E76;&#x4E0D;&#x7EA0;&#x7ED3;&#x4E3A;&#x4EC0;&#x4E48;&#x7F16;&#x8BD1;&#x5668;&#x6CA1;&#x6709;&#x6309;&#x7167;&#x6211;&#x7684;&#x8981;&#x6C42;&#x7EFC;&#x5408;&#x6210;&#x5355;&#x7AEF;&#x53E3;RAM&#x4E86;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x54EA;&#x4F4D;&#x5927;&#x4F6C;&#x77E5;&#x9053;&#x539F;&#x56E0;&#xFF0C;&#x6B22;&#x8FCE;&#x7559;&#x8A00;&#x3002;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">//Quaratus&#x5185;&#x7F6E;&#x7684;&#x5355;&#x7AEF;&#x53E3;ram&#x4EE3;&#x7801;&#x7247;&#x6BB5;&#x3002;</span></span><br><span class="line"><span class="hljs-keyword">module</span> single_port_RAM</span><br><span class="line">#(<span class="hljs-keyword">parameter</span> DATA_WIDTH=<span class="hljs-number">8</span>, <span class="hljs-keyword">parameter</span> ADDR_WIDTH=<span class="hljs-number">6</span>)</span><br><span class="line">(</span><br><span class="line">	<span class="hljs-keyword">input</span> [(DATA_WIDTH-<span class="hljs-number">1</span>):<span class="hljs-number">0</span>] data,</span><br><span class="line">	<span class="hljs-keyword">input</span> [(ADDR_WIDTH-<span class="hljs-number">1</span>):<span class="hljs-number">0</span>] addr,</span><br><span class="line">	<span class="hljs-keyword">input</span> we, clk,</span><br><span class="line">	<span class="hljs-keyword">output</span> [(DATA_WIDTH-<span class="hljs-number">1</span>):<span class="hljs-number">0</span>] q</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">	<span class="hljs-comment">// Declare the RAM variable</span></span><br><span class="line">	<span class="hljs-keyword">reg</span> [DATA_WIDTH-<span class="hljs-number">1</span>:<span class="hljs-number">0</span>] ram[<span class="hljs-number">2</span>**ADDR_WIDTH-<span class="hljs-number">1</span>:<span class="hljs-number">0</span>];</span><br><span class="line"></span><br><span class="line">	<span class="hljs-comment">// Variable to hold the registered read address</span></span><br><span class="line">	<span class="hljs-keyword">reg</span> [ADDR_WIDTH-<span class="hljs-number">1</span>:<span class="hljs-number">0</span>] addr_reg;</span><br><span class="line"></span><br><span class="line">	<span class="hljs-keyword">always</span> @ (<span class="hljs-keyword">posedge</span> clk)</span><br><span class="line">	<span class="hljs-keyword">begin</span></span><br><span class="line">		<span class="hljs-comment">// Write</span></span><br><span class="line">		<span class="hljs-keyword">if</span> (we)</span><br><span class="line">			ram[addr] &lt;= data;</span><br><span class="line"></span><br><span class="line">		addr_reg &lt;= addr;</span><br><span class="line">	<span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">	<span class="hljs-comment">// Continuous assignment implies read returns NEW data.</span></span><br><span class="line">	<span class="hljs-comment">// This is the natural behavior of the TriMatrix memory</span></span><br><span class="line">	<span class="hljs-comment">// blocks in Single Port mode.  </span></span><br><span class="line">	<span class="hljs-keyword">assign</span> q = ram[addr_reg];</span><br></pre></td></tr></table></figure>

<p>dummy_slave&#x7684;&#x4EFF;&#x771F;&#x7ED3;&#x679C;&#xFF1A;<br><img src="/%E6%80%BB%E7%BA%BF%E6%8E%A7%E5%88%B6%E5%99%A8%E8%AE%BE%E8%AE%A1/dummy_slave_t.JPG" alt="dummy_slave&#x4EFF;&#x771F;"></p>
<h3 id="&#x4E3B;&#x8BBE;&#x5907;&#x6A21;&#x62DF;"><a href="#&#x4E3B;&#x8BBE;&#x5907;&#x6A21;&#x62DF;" class="headerlink" title="&#x4E3B;&#x8BBE;&#x5907;&#x6A21;&#x62DF;"></a>&#x4E3B;&#x8BBE;&#x5907;&#x6A21;&#x62DF;</h3><p>dummy master&#x6700;&#x7EC8;&#x4F1A;&#x88AB;Cache&#x3001;&#x5404;&#x79CD;DMA&#x8BBE;&#x5907;&#x66FF;&#x4EE3;&#xFF0C;&#x4F46;&#x662F;&#x8BBE;&#x8BA1;&#x4E00;&#x4E2A;dummy master&#x4ECD;&#x7136;&#x6709;&#x610F;&#x4E49;&#xFF0C;&#x5B83;&#x53EF;&#x4EE5;&#x6D4B;&#x8BD5;&#x603B;&#x7EBF;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x591A;&#x4E2A;&#x4E3B;&#x8BBE;&#x5907;&#x540C;&#x65F6;&#x8BF7;&#x6C42;&#x7684;&#x60C5;&#x51B5;&#x3002;</p>
<p>dummy master&#x5185;&#x90E8;&#x662F;&#x4E00;&#x4E2A;&#x8BF7;&#x6C42;&#x961F;&#x5217;&#xFF0C;&#x5176;&#x5C06;&#x8BF7;&#x6C42;&#x9001;&#x81F3;&#x603B;&#x7EBF;&#x63A7;&#x5236;&#x5668;&#xFF0C;&#x5728;&#x63A7;&#x5236;&#x5668;&#x5141;&#x8BB8;&#x540E;&#x5C06;&#x8BF7;&#x6C42;&#x9001;&#x81F3;&#x603B;&#x7EBF;&#xFF0C;&#x7B49;&#x5F85;&#x88AB;&#x8BF7;&#x6C42;&#x8BBE;&#x5907;&#x7684;ready&#x4FE1;&#x53F7;&#xFF0C;&#x53D6;&#x8D70;&#x6570;&#x636E;&#x540E;&#x91CD;&#x65B0;&#x6392;&#x961F;&#xFF0C;&#x51C6;&#x5907;&#x4E0B;&#x4E00;&#x4E2A;&#x8BF7;&#x6C42;&#x3002;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">module</span> dummy_master(</span><br><span class="line">    clk, request, ready, grant, address, data, r_w</span><br><span class="line">);</span><br><span class="line">    <span class="hljs-keyword">input</span> clk, ready, grant;</span><br><span class="line">    <span class="hljs-keyword">output</span> request, r_w;</span><br><span class="line">    <span class="hljs-keyword">output</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] address;</span><br><span class="line">    <span class="hljs-keyword">inout</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] data;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//dummy requests.</span></span><br><span class="line">    <span class="hljs-keyword">reg</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] req_addr [<span class="hljs-number">0</span>:<span class="hljs-number">32</span>-<span class="hljs-number">1</span>];</span><br><span class="line">    <span class="hljs-keyword">reg</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] req_r_w;</span><br><span class="line">    <span class="hljs-keyword">reg</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] req;</span><br><span class="line">    <span class="hljs-keyword">wire</span> ready_inner;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//dummy memory operation.</span></span><br><span class="line">    <span class="hljs-keyword">reg</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] mem      [<span class="hljs-number">0</span>:<span class="hljs-number">32</span>-<span class="hljs-number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">reg</span> [<span class="hljs-number">4</span>:<span class="hljs-number">0</span>]       req_num  ;</span><br><span class="line">    <span class="hljs-comment">//initial dummy operations.</span></span><br><span class="line">    <span class="hljs-keyword">initial</span></span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        <span class="hljs-comment">//simulated operation is here.</span></span><br><span class="line">    <span class="hljs-keyword">end</span></span><br><span class="line">    <span class="hljs-comment">//internal state machine.</span></span><br><span class="line">    <span class="hljs-keyword">reg</span> state;</span><br><span class="line">    <span class="hljs-keyword">always</span> @(<span class="hljs-keyword">posedge</span> clk)</span><br><span class="line">    <span class="hljs-keyword">begin</span></span><br><span class="line">        <span class="hljs-keyword">case</span> (state)</span><br><span class="line">        <span class="hljs-number">1&apos;b0</span>:<span class="hljs-keyword">begin</span></span><br><span class="line">            <span class="hljs-keyword">if</span> (request) state &lt;= <span class="hljs-number">1</span>;     </span><br><span class="line">            <span class="hljs-keyword">else</span> req_num&lt;=req_num +<span class="hljs-number">1</span>;</span><br><span class="line">            <span class="hljs-keyword">end</span></span><br><span class="line">        <span class="hljs-number">1&apos;b1</span>:<span class="hljs-keyword">begin</span> </span><br><span class="line">            <span class="hljs-keyword">if</span> (ready_inner)</span><br><span class="line">                <span class="hljs-keyword">begin</span></span><br><span class="line">                    <span class="hljs-keyword">if</span> (~req_r_w [req_num]) </span><br><span class="line">                        mem[req_num] &lt;= data;</span><br><span class="line">                    state &lt;=<span class="hljs-number">0</span>;</span><br><span class="line">                    req_num&lt;=req_num +<span class="hljs-number">1</span>;</span><br><span class="line">                <span class="hljs-keyword">end</span></span><br><span class="line">            <span class="hljs-keyword">end</span></span><br><span class="line">        <span class="hljs-keyword">endcase</span></span><br><span class="line">    <span class="hljs-keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">assign</span> request  = req [req_num];</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//High z when not granted</span></span><br><span class="line">    <span class="hljs-keyword">assign</span> address = grant ? req_addr[req_num] : <span class="hljs-number">32&apos;bz</span>;</span><br><span class="line">    <span class="hljs-keyword">assign</span> r_w = grant ? req_r_w [req_num] : <span class="hljs-number">1&apos;bz</span>;</span><br><span class="line">    <span class="hljs-keyword">wire</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] data_out = req_r_w [req_num] ? mem [req_num] :<span class="hljs-number">32&apos;bz</span>;</span><br><span class="line">    <span class="hljs-keyword">assign</span> data = grant ? data_out: <span class="hljs-number">32&apos;bz</span>;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//mask out ready signal when not granted</span></span><br><span class="line">    <span class="hljs-keyword">assign</span> ready_inner = grant? ready :<span class="hljs-number">1&apos;b0</span>; </span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">endmodule</span> <span class="hljs-comment">//dummy_master</span></span><br></pre></td></tr></table></figure>
<p>&#x4EFF;&#x771F;&#x60C5;&#x51B5;&#x5982;&#x56FE;:<br><img src="/%E6%80%BB%E7%BA%BF%E6%8E%A7%E5%88%B6%E5%99%A8%E8%AE%BE%E8%AE%A1/dummy_master_t.JPG" alt="dummy_master &#x4EFF;&#x771F;"></p>
<h3 id="&#x603B;&#x7EBF;&#x4E8B;&#x52A1;&#x6D4B;&#x8BD5;"><a href="#&#x603B;&#x7EBF;&#x4E8B;&#x52A1;&#x6D4B;&#x8BD5;" class="headerlink" title="&#x603B;&#x7EBF;&#x4E8B;&#x52A1;&#x6D4B;&#x8BD5;"></a>&#x603B;&#x7EBF;&#x4E8B;&#x52A1;&#x6D4B;&#x8BD5;</h3><p>&#x8FD9;&#x91CC;&#x8BBE;&#x8BA1;&#x7684;test bench&#x5728;&#x603B;&#x7EBF;&#x4E0A;&#x8FDE;&#x63A5;&#x4E86;&#x4E24;&#x4E2A;DMA&#x8BBE;&#x5907;&#xFF0C;&#x5206;&#x522B;&#x63A5;&#x5165;&#x63A7;&#x5236;&#x5668;&#x7684;DMA[0]&#x548C;DMA[1]&#x56E0;&#x6B64;&#xFF0C;DMA[0]&#x6709;&#x9AD8;&#x4F18;&#x5148;&#x7EA7;&#x3002;&#x603B;&#x7EBF;&#x4E0A;&#x540C;&#x65F6;&#x63A5;&#x5165;&#x4E86;&#x4E24;&#x4E2A;&#x4ECE;&#x8BBE;&#x5907;&#xFF08;&#x5185;&#x5B58;&#x8BBE;&#x5907;&#xFF09;&#xFF0C;&#x4E24;&#x4E2A;&#x5185;&#x5B58;&#x8BBE;&#x5907;&#x7684;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#x5206;&#x522B;&#x662F;32&#x2019;b0 -&gt; 32&#x2019;b11111 &#x548C; 32&#x2019;b100000-&gt;32&#x2019;b111111&#x3002;test bench&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x5C06;&#x7EBF;&#x7F51;&#x8FDE;&#x63A5;&#x81F3;&#x5404;&#x4E2A;&#x6A21;&#x5757;&#x7684;&#x5B9E;&#x4F8B;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#xFF1A;</p>
<figure class="highlight verilog hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">//This module is the test bench for bus</span></span><br><span class="line"><span class="hljs-keyword">module</span> bus_t(</span><br><span class="line">    clk,address_o,data_o,request_o,ready_o,rw_o,DMA_o,grant_o ,ready_inner</span><br><span class="line">);</span><br><span class="line">    <span class="hljs-keyword">output</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] address_o, data_o;</span><br><span class="line">    <span class="hljs-keyword">output</span> request_o, ready_o,rw_o,ready_inner;</span><br><span class="line">    <span class="hljs-keyword">output</span> [<span class="hljs-number">7</span>:<span class="hljs-number">0</span>] DMA_o, grant_o;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">input</span> clk;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//These wires are internal bus signal</span></span><br><span class="line">    <span class="hljs-keyword">wire</span> [<span class="hljs-number">31</span>:<span class="hljs-number">0</span>] address,data;</span><br><span class="line">    <span class="hljs-keyword">wire</span> request, ready, r_w;</span><br><span class="line">    <span class="hljs-keyword">wire</span> [<span class="hljs-number">7</span>:<span class="hljs-number">0</span>] DMA, grant;</span><br><span class="line"></span><br><span class="line">   <span class="hljs-comment">//these ports are used by the simulator output</span></span><br><span class="line">    <span class="hljs-keyword">assign</span> address_o =address;</span><br><span class="line">    <span class="hljs-keyword">assign</span> data_o = data;</span><br><span class="line">    <span class="hljs-keyword">assign</span> request_o = request;</span><br><span class="line">    <span class="hljs-keyword">assign</span> ready_o = ready;</span><br><span class="line">    <span class="hljs-keyword">assign</span> rw_o = r_w;</span><br><span class="line">    <span class="hljs-keyword">assign</span> DMA_o = DMA;</span><br><span class="line">    <span class="hljs-keyword">assign</span> grant_o = grant;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//instances of bus component</span></span><br><span class="line">    bus_control bus_control_0 (DMA,grant, request,ready,clk);</span><br><span class="line">    dummy_slave dummy_slave_a (clk,address,data,request,ready,r_w);</span><br><span class="line">    dummy_slave_1 dummy_slave_b (clk,address,data,request,ready,r_w);</span><br><span class="line">    dummy_master dummy_master_a (clk,DMA[<span class="hljs-number">0</span>],ready, grant[<span class="hljs-number">0</span>],address,data,r_w);</span><br><span class="line">    dummy_master_1 dummy_master_b (clk,DMA[<span class="hljs-number">1</span>],ready, grant[<span class="hljs-number">1</span>],address,data,r_w,ready_inner);    </span><br><span class="line"><span class="hljs-keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>&#x4EFF;&#x771F;&#x8F93;&#x51FA;&#x4E3A;&#xFF1A;<br><img src="/%E6%80%BB%E7%BA%BF%E6%8E%A7%E5%88%B6%E5%99%A8%E8%AE%BE%E8%AE%A1/bus_t.JPG" alt="&#x603B;&#x7EBF;&#x4E8B;&#x52A1;&#x4EFF;&#x771F;"><br>&#x4ECE;&#x4EFF;&#x771F;&#x7ED3;&#x679C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6A21;&#x62DF;&#x7684;&#x56DB;&#x4E2A;&#x8BBE;&#x5907;8&#x4E2A;&#x603B;&#x7EBF;&#x4E8B;&#x52A1;&#x529F;&#x80FD;&#x6B63;&#x5E38;&#x3002;</p>
<h2 id="&#x5C0F;&#x7ED3;"><a href="#&#x5C0F;&#x7ED3;" class="headerlink" title="&#x5C0F;&#x7ED3;"></a>&#x5C0F;&#x7ED3;</h2><p>&#x603B;&#x7EBF;&#x7684;&#x8BBE;&#x8BA1;&#xFF0C;&#x53EF;&#x4EE5;&#x9694;&#x79BB;CPU&#x548C;&#x5916;&#x56F4;&#x8BBE;&#x5907;&#xFF0C;&#x751A;&#x81F3;&#x53EF;&#x4EE5;&#x9694;&#x79BB;IO&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x6240;&#x8981;&#x8BBE;&#x8BA1;&#x7684;CPU&#x4F7F;&#x7528;memory mapped IO&#x3002;&#x6709;&#x4E86;&#x603B;&#x7EBF;&#xFF0C;IO&#x8BBE;&#x5907;&#x53EA;&#x662F;&#x603B;&#x7EBF;&#x4E0A;&#x94FE;&#x63A5;&#x7684;&#x4E00;&#x4E2A;&#x8BBE;&#x5907;&#x7F62;&#x4E86;, &#x800C;&#x4E14;&#x53EF;&#x4EE5;&#x8F7B;&#x677E;&#x5B9E;&#x73B0;&#x4E0D;&#x540C;&#x7684;&#x5185;&#x5B58;&#x6620;&#x5C04;&#xFF0C;&#x8FDE;&#x63A5;ROM&#x548C;RAM&#x3002;&#x6240;&#x4EE5;&#x603B;&#x7EBF;&#x8BBE;&#x8BA1;&#x5B8C;&#x6210;&#xFF0C;&#x662F;&#x672C;&#x9879;&#x76EE;&#x7684;&#x4E00;&#x4E2A;&#x91CC;&#x7A0B;&#x7891;&#xFF0C;&#x5B83;&#x6807;&#x5FD7;&#x7740;&#x5BF9;&#x5F00;&#x53D1;&#x8BBE;&#x8BA1;&#x6D41;&#x7A0B;&#x7684;&#x9A8C;&#x8BC1;&#x3002;</p>

    
    </div>
    
    
</article>






    <script src='https://unpkg.com/mermaid@8.8.0/dist/mermaid.min.js'></script>
    <script>
      if (window.mermaid) {
        mermaid.initialize({theme: 'forest'});
      }
    </script>
  

  
    
        <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/%E5%85%B3%E4%BA%8E%E4%B8%AD%E6%96%AD%E5%92%8Cio%E6%8E%A7%E5%88%B6%E5%99%A8/" itemprop="url">关于中断和io控制器</a>
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            
                <time datetime="2020-09-29T00:54:54.000Z" itemprop="datePublished">9月 29 2020</time>
            
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/home-brew-computer-system/">home brew computer system</a>
        </span>
        
        
        <span class="column is-narrow">
            
            
            2 分钟 read (About 349 words)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <p>io&#x548C;&#x4E2D;&#x65AD;&#x7684;&#x8BBE;&#x8BA1;&#x5B9A;&#x578B;&#xFF0C;&#x6210;&#x4E86;&#x76EE;&#x524D;&#x6211;&#x7684;cpu&#x8BBE;&#x8BA1;&#x8FC7;&#x7A0B;&#x4E2D;&#x6700;&#x4E9F;&#x5F85;&#x89E3;&#x51B3;&#x7684;&#x95EE;&#x9898;&#x3002;&#x82E5;&#x4E0D;&#x5B9A;&#x578B;&#xFF0C;&#x53EF;&#x80FD;&#x5F71;&#x54CD;&#x63A5;&#x4E0B;&#x6765;&#x5176;&#x4ED6;&#x7EC4;&#x4EF6;&#x7684;&#x8BBE;&#x8BA1;&#x548C;&#x6D4B;&#x8BD5;&#x5DE5;&#x4F5C;&#x3002;</p>
<p>&#x4E2D;&#x65AD;&#x63A7;&#x5236;&#x57FA;&#x672C;&#x6CA1;&#x5565;&#x53EF;&#x4FEE;&#x6539;&#x7684;&#xFF0C;cpu&#x7AEF;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x4E2D;&#x65AD;&#x811A;&#xFF0C;cp0&#xFF08;&#x534F;&#x5904;&#x7406;&#x5668;0&#xFF0C;&#x5373;cu&#xFF09;&#x4E2D;&#x6709;&#x56DB;&#x4E2A;&#x5BC4;&#x5B58;&#x5668;&#xFF0C;cause&#x7528;&#x4E8E;&#x8BB0;&#x5F55;&#x5916;&#x90E8;&#x4E2D;&#x65AD;&#x3001;&#x5185;&#x90E8;&#x4E2D;&#x65AD;&#x548C;&#x5F02;&#x5E38;&#x7684;&#x79CD;&#x7C7B;&#xFF1B;status&#x4E2D;&#x63A7;&#x5236;&#x8FD9;&#x4E00;&#x4E2A;&#x4E2D;&#x65AD;&#x7684;&#x5F00;&#x5173;&#xFF1B;base&#x8BB0;&#x5F55;&#x4E2D;&#x65AD;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x5728;&#x4E2D;&#x65AD;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x4E2D;&#x4F7F;&#x7528;mfc0&#x6307;&#x4EE4;&#x67E5;&#x8BE2;cause&#x5BC4;&#x5B58;&#x5668;&#x8DF3;&#x8F6C;&#x5230;&#x76F8;&#x5E94;&#x4E2D;&#x65AD;&#x7684;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x5730;&#x5740;&#xFF1B;EPC&#x7528;&#x6765;&#x4FDD;&#x5B58;&#x4E2D;&#x65AD;&#x524D;&#x7684;&#x6307;&#x4EE4;&#x5730;&#x5740;&#x3002;&#x8FD9;&#x4E00;&#x90E8;&#x5206;&#xFF0C;&#x6211;&#x53EA;&#x9700;&#x8981;&#x989D;&#x5916;&#x5B9E;&#x73B0;&#x4E09;&#x6761;&#x6307;&#x4EE4;mfc0&#xFF0C;mtc0&#x548C;eret&#x3002;</p>
<p>io&#x6A21;&#x5757;&#x7684;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x90E8;&#x5206;&#x5E94;&#x8BE5;&#x662F;&#x4E00;&#x4E2A;&#x5BC4;&#x5B58;&#x5668;&#x7EC4;&#xFF0C;&#x5305;&#x62EC;&#x72B6;&#x6001;&#x5BC4;&#x5B58;&#x5668;&#x3001;&#x6307;&#x4EE4;&#x5BC4;&#x5B58;&#x5668;&#x3001;&#x6570;&#x636E;&#x5BC4;&#x5B58;&#x5668;&#x3002;&#x72B6;&#x6001;&#x5BC4;&#x5B58;&#x5668;&#x6807;&#x5FD7;&#x5FD9;&#x95F2;&#xFF0C;&#x6307;&#x4EE4;&#x5BC4;&#x5B58;&#x5668;&#x4E3A;&#x4ECE;cpu&#x83B7;&#x53D6;&#x6307;&#x4EE4;&#xFF0C;&#x6570;&#x636E;&#x5BC4;&#x5B58;&#x5668;&#x4F5C;&#x4E3A;io&#x63A7;&#x5236;&#x5668;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x7684;&#x901A;&#x9053;&#x3002;&#x6B64;&#x5916;&#xFF0C;io&#x6A21;&#x5757;&#x8FD8;&#x8981;&#x4E0E;cause&#x5BC4;&#x5B58;&#x5668;&#x76F8;&#x8FDE;&#xFF0C;&#x8F85;&#x52A9;&#x4E00;&#x5957;&#x4E2D;&#x65AD;&#x5C4F;&#x853D;&#x4E0E;&#x4F18;&#x5148;&#x7EA7;&#x903B;&#x8F91;&#xFF0C;&#x5B8C;&#x6210;&#x4E2D;&#x65AD;&#x5411;&#x91CF;&#x3002;IO&#x6A21;&#x5757;&#x4E2D;&#x7684;&#x4E2D;&#x65AD;&#x63A7;&#x5236;&#x53EF;&#x4EE5;&#x7EA7;&#x8054;&#x3002;</p>

    
    </div>
    
    
</article>






    <script src='https://unpkg.com/mermaid@8.8.0/dist/mermaid.min.js'></script>
    <script>
      if (window.mermaid) {
        mermaid.initialize({theme: 'forest'});
      }
    </script>
  

  
    
        <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/cpu%E5%86%85%E9%83%A8%E5%8F%AA%E9%87%87%E7%94%A8%E4%B8%80%E4%B8%AA%E6%97%B6%E9%92%9F%EF%BC%8C%E5%AF%B9%E4%BA%8E%E4%B8%8D%E5%90%8C%E9%80%9F%E5%BA%A6%E7%9A%84%E7%BB%84%E4%BB%B6%E5%B0%86%E9%87%87%E7%94%A8clock-enabler/" itemprop="url">cpu内部只采用一个时钟，对于不同速度的组件将采用clock enabler</a>
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            
                <time datetime="2020-09-29T00:41:46.000Z" itemprop="datePublished">9月 29 2020</time>
            
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/home-brew-computer-system/">home brew computer system</a>
        </span>
        
        
        <span class="column is-narrow">
            
            
            2 分钟 read (About 232 words)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <p>&#x51E0;&#x4E4E;&#x6240;&#x6709;&#x4EBA;&#x90FD;&#x4E0D;&#x5EFA;&#x8BAE;&#xFF0C;&#x5728;FPGA&#x4E2D;&#x4F7F;&#x7528;&#x591A;&#x4E8E;&#x4E00;&#x4E2A;&#x65F6;&#x949F;&#x3002;&#x5728;FPGA&#x4E2D;&#x4F7F;&#x7528;&#x4E0D;&#x540C;&#x7684;&#x65F6;&#x949F;&#xFF0C;&#x6D89;&#x53CA;&#x5230;&#x5728;&#x4E0D;&#x540C;&#x7684;&#x65F6;&#x949F;&#x57DF;&#xFF08;clock domain&#xFF09;&#x8FDB;&#x884C;&#x540C;&#x6B65;&#xFF0C;&#x6570;&#x636E;&#x7684;&#x540C;&#x6B65;&#x901A;&#x5E38;&#x4F7F;&#x7528;&#x4E24;&#x4E2A;&#x4E32;&#x8054;&#x7684;&#x89E6;&#x53D1;&#x5668;&#xFF0C;flag&#xFF08;&#x4E00;&#x4E2A;&#x5468;&#x671F;&#x7684;&#x4FE1;&#x53F7;&#xFF09;&#x901A;&#x5E38;&#x8F6C;&#x6362;&#x6210;&#x7535;&#x5E73;&#x8F6C;&#x6362;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x5230;&#x53E6;&#x4E00;&#x4E2A;&#x57DF;&#x8FDB;&#x884C;&#x540C;&#x6B65;&#xFF0C;&#x8BE6;&#x7EC6;&#x7684;&#x8BBE;&#x8BA1;&#x53EF;&#x4EE5;&#x770B;<a target="_blank" rel="noopener" href="https://www.fpga4fun.com/CrossClockDomain.html">&#x8FD9;&#x91CC;</a>&#x3002;</p>
<p>&#x56E0;&#x6B64;&#xFF0C;&#x6211;&#x4E5F;&#x51B3;&#x5B9A;&#x5728;&#x6211;&#x7684;&#x8BBE;&#x8BA1;&#x4E2D;&#x64A4;&#x9500;&#x5F02;&#x6B65;&#x7684;&#x6E05;&#x96F6;&#x3001;&#x4E0B;&#x8FB9;&#x6CBF;&#x7684;&#x6E05;&#x96F6;&#x3002;&#x5728;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x4E0D;&#x540C;&#x901F;&#x5EA6;&#x7684;&#x7EC4;&#x4EF6;&#xFF0C;&#x5982;&#x8BBE;&#x8BA1;&#x76EE;&#x6807;&#x4E2D;&#x7684;&#x53EF;&#x4EE5;&#x6682;&#x505C;&#x7684;&#xFF0C;&#x53EF;&#x4EE5;&#x8C03;&#x901F;&#x7684;cpu&#xFF0C;&#x91C7;&#x7528;&#x8BA1;&#x6570;&#x5668;&#x6FC0;&#x6D3B;&#x7684;clock enabler&#xFF0C;&#x8BE6;&#x7EC6;&#x8BBE;&#x8BA1;&#x53EF;&#x4EE5;&#x770B;<a target="_blank" rel="noopener" href="https://zipcpu.com/blog/2017/06/02/generating-timing.html">&#x8FD9;&#x91CC;</a>&#x3002;&#x8FD9;&#x6837;&#x5BF9;&#x6211;&#x73B0;&#x6709;&#x7684;&#x8BBE;&#x8BA1;&#x7684;&#x4FEE;&#x6539;&#x4EA7;&#x751F;&#x4E86;&#x4E00;&#x5B9A;&#x7684;&#x5DE5;&#x4F5C;&#x91CF;&#x3002;</p>

    
    </div>
    
    
</article>






    <script src='https://unpkg.com/mermaid@8.8.0/dist/mermaid.min.js'></script>
    <script>
      if (window.mermaid) {
        mermaid.initialize({theme: 'forest'});
      }
    </script>
  

  
    
        <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/%E4%B8%8B%E4%B8%80%E6%AD%A5%E7%9A%84%E8%AE%A1%E5%88%92/" itemprop="url">下一步的计划</a>
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            
                <time datetime="2020-09-26T09:49:27.000Z" itemprop="datePublished">9月 26 2020</time>
            
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/home-brew-computer-system/">home brew computer system</a>
        </span>
        
        
        <span class="column is-narrow">
            
            
            6 分钟 read (About 945 words)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <p>&#x73B0;&#x5728;lcc&#x7684;&#x4EE3;&#x7801;&#x5DF2;&#x8BFB;&#x5B8C;&#xFF0C;&#x4E0B;&#x4E00;&#x6B65;&#x8981;&#x505A;&#x7684;&#x662F;soc&#x7684;&#x8BBE;&#x8BA1;&#x548C;&#x9A8C;&#x8BC1;&#xFF0C;&#x4EE5;&#x53CA;lcc&#x7684;&#x79FB;&#x690D;&#x3001;&#x6C47;&#x7F16;&#x5668;&#x7684;&#x79FB;&#x690D;&#x3002;<br>&#x5BF9;&#x4E8E;&#x6C47;&#x7F16;&#x5668;&#xFF0C;&#x6211;&#x51C6;&#x5907;&#x4F7F;&#x7528;<a target="_blank" rel="noopener" href="https://github.com/hlorenzi/customasm">customasm</a>.<br>&#x5982;&#x679C;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x6C47;&#x7F16;&#x5668;&#xFF0C;&#x53EF;&#x80FD;&#x5728;&#x79FB;&#x690D;lcc&#x65F6;&#x9700;&#x8981;&#x4FEE;&#x6539;lcc&#x6A21;&#x677F;&#x4E2D;&#x7684;&#x4E00;&#x4E9B;&#x4F2A;&#x6307;&#x4EE4;&#x5982;ld,lcomm&#x7B49;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;soc&#x7684;&#x8BBE;&#x8BA1;&#xFF0C;&#x8FD9;&#x4E9B;&#x5929;&#x4E00;&#x76F4;&#x5728;&#x601D;&#x8003;&#x7684;&#x95EE;&#x9898;&#x662F;&#x5F02;&#x6B65;&#x901A;&#x8BAF;&#x7684;&#x95EE;&#x9898;&#x3002;&#x6211;&#x6240;&#x5E0C;&#x671B;&#x7684;&#x7CFB;&#x7EDF;&#xFF0C;cpu&#x8FD0;&#x884C;&#x7684;&#x901F;&#x5EA6;&#x5E94;&#x8BE5;&#x662F;&#x53EF;&#x53D8;&#x7684;&#xFF0C;&#x751A;&#x81F3;&#x53EF;&#x4EE5;&#x662F;&#x5355;&#x6B65;&#x7684;&#x3002;&#x800C;&#x6211;&#x53C8;&#x5E0C;&#x671B;&#x80FD;&#x4F7F;&#x7528;de0 nao&#x677F;&#x8F7D;&#x7684;SDRAM&#xFF0C;&#x56E0;&#x6B64;&#x5185;&#x5B58;&#x63A7;&#x5236;&#x7CFB;&#x7EDF;&#x4E0E;cpu&#x7684;&#x901A;&#x8BAF;&#x4E00;&#x5B9A;&#x662F;&#x5F02;&#x6B65;&#x7684;&#x3002;&#x5F02;&#x6B65;&#x901A;&#x8BAF;&#x8981;&#x6709;ready&#x4FE1;&#x53F7;&#xFF0C;&#x7531;&#x4E8E;&#x6211;&#x5E0C;&#x671B;cpu&#x8FD0;&#x884C;&#x7684;&#x901F;&#x5EA6;&#x53EF;&#x53D8;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x9700;&#x8981;&#x5728;cache&#x63A7;&#x5236;&#x5668;&#x4E2D;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x53CC;&#x89E6;&#x53D1;&#x7684;&#x89E6;&#x53D1;&#x5668;&#xFF0C;&#x5728;ready&#x4FE1;&#x53F7;&#x53D8;&#x5316;&#x65F6;&#x8BB0;&#x5F55;&#x5E76;&#x4FDD;&#x6301;ready&#x4FE1;&#x53F7;&#xFF0C;&#x76F4;&#x81F3;cpu&#x7684;&#x4E0B;&#x4E00;&#x4E2A;&#x5468;&#x671F;&#x5230;&#x6765;&#xFF0C;&#x7528;&#x8FD9;&#x4E2A;&#x4FE1;&#x53F7;&#x63A7;&#x5236;cpu&#x4E2D;cache&#x63A7;&#x5236;&#x5668;&#x548C;ram&#x63A7;&#x5236;&#x5668;&#x7684;&#x5F02;&#x6B65;&#x901A;&#x8BAF;&#x3002;</p>
<p>&#x7CFB;&#x7EDF;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#x7684;&#x5212;&#x5206;&#xFF0C;&#x4E5F;&#x662F;&#x4E00;&#x4E2A;&#x9700;&#x8981;&#x786E;&#x5B9A;&#x7684;&#x8BBE;&#x8BA1;&#x3002;&#x76EE;&#x524D;&#x6211;&#x8BA1;&#x5212;&#x5C06;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#x6309;&#x7167;| ROM | IO | RAM |&#x5212;&#x5206;&#xFF0C;&#x5177;&#x4F53;&#x5404;&#x533A;&#x57DF;&#x5C3A;&#x5BF8;&#x5C1A;&#x672A;&#x786E;&#x5B9A;&#x3002;&#x7CFB;&#x7EDF;cache&#x53EA;&#x5BF9;RAM&#x533A;&#x57DF;&#x6709;&#x6548;&#x3002;&#x76EE;&#x524D;&#x6211;&#x7684;&#x60F3;&#x6CD5;&#x662F;&#xFF0C;&#x6839;&#x636E;&#x6307;&#x4EE4;&#x548C;&#x6570;&#x636E;&#x9700;&#x6C42;&#x7684;&#x4E0D;&#x540C;&#xFF0C;&#x5728;cache&#x63A7;&#x5236;&#x5668;&#x4E0A;&#x589E;&#x52A0;&#x7247;&#x9009;&#x3001;&#x63A7;&#x5236;&#x4FE1;&#x53F7;mux&#xFF0C;&#x4EE5;&#x5B9E;&#x73B0;&#x4E0D;&#x540C;&#x533A;&#x57DF;&#x5BF9;cache&#x7684;&#x4E0D;&#x540C;&#x64CD;&#x4F5C;&#x3002;&#x5BF9;&#x4E8E;&#x6307;&#x4EE4;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x8BFB;&#x53D6;ROM&#x548C;RAM&#xFF0C;&#x6240;&#x4EE5;I cache&#x53EA;&#x9700;&#x8981;&#x5728;&#x539F;&#x6709;I cache&#x4E0A;&#x589E;&#x52A0;&#x5BF9;ROM&#x7684;&#x591A;&#x8DEF;&#x590D;&#x7528;&#xFF08;&#x76F4;&#x901A;&#xFF09;&#xFF0C;&#x7531;&#x4E8E;&#x8FD9;&#x4E2A;ROM&#x662F;&#x7528;&#x4F5C;bootloader&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x4E0D;&#x9700;&#x8981;&#x5F88;&#x5927;&#x4F53;&#x79EF;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x540C;&#x6B65;&#x7684;&#x65B9;&#x5F0F;&#x4E0E;I cache&#x94FE;&#x63A5;&#xFF0C;&#x56E0;&#x6B64;I cache&#x7684;&#x6539;&#x52A8;&#x5F88;&#x5C0F;&#x3002;&#x5BF9;&#x4E8E;&#x6570;&#x636E;&#xFF0C;&#x5219;&#x4E09;&#x4E2A;&#x533A;&#x57DF;&#x90FD;&#x9700;&#x8981;&#x8BFB;&#x53D6;&#x3002;<br>&#x663E;&#x7136;&#xFF0C;io&#x4E0E;cpu&#x4E4B;&#x95F4;&#x7684;&#x901A;&#x8BAF;&#x4E5F;&#x662F;&#x5F02;&#x6B65;&#x7684;&#xFF0C;&#x4F46;&#x6211;&#x5C1A;&#x672A;&#x6784;&#x601D;&#x5B8C;&#x6BD5;&#x6574;&#x4E2A;io&#x63A7;&#x5236;&#x5668;&#x7684;&#x7ED3;&#x6784;&#xFF0C;&#x56E0;&#x6B64;io&#x63A7;&#x5236;&#x5668;&#x7684;&#x8BBE;&#x8BA1;&#x5E94;&#x8BE5;&#x662F;&#x63A5;&#x4E0B;&#x6765;&#x7684;&#x5DE5;&#x4F5C;&#x4E4B;&#x4E00;&#x3002;</p>
<p>IO&#x63A7;&#x5236;&#x5668;&#x5E94;&#x8BE5;&#x5305;&#x62EC;&#x4E00;&#x4E9B;&#x603B;&#x7EBF;&#xFF08;I2C&#xFF0C;SPI&#xFF0C;etc&#xFF09;&#xFF0C;&#x4E00;&#x4E9B;&#x901A;&#x8BAF;&#x7AEF;&#x53E3;&#xFF08;GPIO&#xFF0C;Uart&#xFF0C;etc&#xFF09;&#xFF0C;&#x4EE5;&#x53CA;&#x5411;&#x91CF;&#x4E2D;&#x65AD;&#x548C;&#x5F02;&#x6B65;&#x901A;&#x8BAF;&#x7684;&#x652F;&#x6301;&#x3002;&#x9700;&#x8981;&#x4ED4;&#x7EC6;&#x8003;&#x8651;&#x3002;</p>
<p>&#x6211;&#x76EE;&#x524D;&#x5DF2;&#x6709;cpu&#x90E8;&#x5206;&#x7684;Verilog&#x4EE3;&#x7801;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x90E8;&#x5206;&#x4EE3;&#x7801;&#x7F3A;&#x4E4F;&#x6D4B;&#x8BD5;&#xFF0C;&#x6CA1;&#x6709;&#x7CBE;&#x786E;&#x4E2D;&#x65AD;&#x652F;&#x6301;&#xFF0C;&#x6CA1;&#x6709;&#x4E0E;cache&#x96C6;&#x6210;&#xFF0C;&#x800C;&#x4E14;&#x4E00;&#x4E9B;&#x6307;&#x4EE4;&#x8FD8;&#x9700;&#x8981;&#x4FEE;&#x6539;&#xFF0C;&#x4F8B;&#x5982;&#xFF1A;&#x6211;&#x6253;&#x7B97;&#x5220;&#x9664;&#x4E58;&#x6CD5;&#x548C;&#x9664;&#x6CD5;&#x7684;&#x786C;&#x4EF6;&#x652F;&#x6301;&#xFF0C;&#x539F;&#x56E0;&#x662F;&#x539F;&#x6709;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#x5BF9;&#x4E58;&#x6CD5;&#x548C;&#x9664;&#x6CD5;&#x7684;&#x786C;&#x4EF6;&#x652F;&#x6301;&#x6765;&#x81EA;Altera&#x7684;IP&#xFF0C;&#x8FD9;&#x4E0E;&#x672C;&#x9879;&#x76EE;&#x7684;&#x8BBE;&#x8BA1;&#x76EE;&#x6807;&#x51B2;&#x7A81;&#xFF0C;&#x800C;&#x4E14;&#x5728;sparc&#x5E73;&#x53F0;&#x7684;lcc&#x540E;&#x7AEF;&#x4E2D;&#xFF0C;&#x6709;&#x4F7F;&#x7528;&#x8F6F;&#x4EF6;&#x652F;&#x6301;&#x4E58;&#x6CD5;&#x9664;&#x6CD5;&#x7684;&#x53C2;&#x8003;&#x6837;&#x4F8B;&#xFF1B;&#x6211;&#x8FD8;&#x9700;&#x8981;&#x8003;&#x8651;&#x662F;&#x5426;&#x589E;&#x52A0;&#x4E0D;&#x540C;&#x957F;&#x5EA6;&#x7684;&#x53D6;&#x6570;&#x64CD;&#x4F5C;&#xFF0C;&#x8003;&#x8651;&#x5982;&#x679C;&#x5728;lcc&#x79FB;&#x690D;&#x8FC7;&#x7A0B;&#x4E2D;&#x5C06;&#x6240;&#x6709;&#x6574;&#x6570;&#x7C7B;&#x578B;&#x7684;&#x5C3A;&#x5BF8;&#x6216;&#x8005;&#x5BF9;&#x9F50;&#x90FD;&#x8BBE;&#x7F6E;&#x4E3A;4&#x5B57;&#x8282;&#x4F1A;&#x600E;&#x6837;&#x3002;</p>
<p>&#x4F46;&#x662F;&#x8FD9;&#x4E9B;&#x5DE5;&#x4F5C;&#x7684;&#x987A;&#x5E8F;&#x5F88;&#x96BE;&#x786E;&#x5B9A;&#xFF0C;&#x8FD9;&#x662F;&#x6211;&#x9996;&#x5148;&#x8981;&#x8003;&#x8651;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x76EE;&#x524D;&#x6211;&#x60F3;&#x5230;&#x7684;&#x5408;&#x7406;&#x7684;&#x987A;&#x5E8F;&#x662F;&#xFF1A;</p>
<ul>
<li>&#x8003;&#x8651;&#x662F;&#x5426;&#x589E;&#x52A0;&#x4E0D;&#x540C;&#x957F;&#x5EA6;&#x7684;&#x53D6;&#x6570;&#x64CD;&#x4F5C;</li>
<li>&#x56DE;&#x987E;&#x5DF2;&#x6709;&#x7684;cpu&#x4EE3;&#x7801;&#xFF0C;&#x5206;&#x6790;&#x90A3;&#x4E9B;&#x4EE3;&#x7801;&#x53EF;&#x4EE5;&#x4E0E;cache&#x3001;IO&#x3001;&#x4E2D;&#x65AD;&#x7B49;&#x72EC;&#x7ACB;&#xFF0C;&#x5E76;&#x5BF9;&#x8FD9;&#x4E9B;&#x4EE3;&#x7801;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;&#x3002;</li>
<li>&#x5B9A;&#x4E49;&#x5B58;&#x50A8;&#x63A7;&#x5236;&#x548C;io&#x63A7;&#x5236;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x4E0E;cpu&#x5BF9;&#x63A5;&#xFF0C;&#x6D4B;&#x8BD5;cpu&#x7684;&#x4E2D;&#x65AD;</li>
<li>&#x8BBE;&#x8BA1;&#x5B58;&#x50A8;&#x63A7;&#x5236;</li>
<li>&#x8BBE;&#x8BA1;io&#x63A7;&#x5236;</li>
<li>&#x5DE5;&#x5177;&#x94FE;&#x7684;&#x79FB;&#x690D;</li>
</ul>

    
    </div>
    
    
</article>






    <script src='https://unpkg.com/mermaid@8.8.0/dist/mermaid.min.js'></script>
    <script>
      if (window.mermaid) {
        mermaid.initialize({theme: 'forest'});
      }
    </script>
  

  
    
        <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/%E8%AF%BB%E5%AE%8CLCC%E5%AE%8C%E6%95%B4%E6%BA%90%E4%BB%A3%E7%A0%81/" itemprop="url">读完LCC完整源代码</a>
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            
                <time datetime="2020-09-26T07:31:08.000Z" itemprop="datePublished">9月 26 2020</time>
            
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/home-brew-computer-system/">home brew computer system</a>
        </span>
        
        
        <span class="column is-narrow">
            
            
            17 分钟 read (About 2618 words)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <p>&#x7ECF;&#x8FC7;&#x4E86;&#x51E0;&#x4E2A;&#x6708;&#xFF0C;&#x7EC8;&#x4E8E;&#x5B8C;&#x6574;&#x7684;&#x8BFB;&#x5B8C;&#x4E86;lcc 3.6 &#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x8FD9;&#x4E00;&#x9636;&#x6BB5;&#x5DE5;&#x4F5C;&#x57FA;&#x672C;&#x544A;&#x4E00;&#x6BB5;&#x843D;&#x3002;&#x5BF9;&#x4E8E;&#x6211;&#x6765;&#x8BF4;&#xFF0C;lcc&#x662F;&#x4E00;&#x4E2A;&#x5341;&#x5206;&#x590D;&#x6742;&#x7684;&#x8F6F;&#x4EF6;&#xFF0C;&#x867D;&#x7136;&#x6211;&#x80FD;&#x611F;&#x53D7;&#x5230;&#x4F5C;&#x8005;&#x5728;&#x89E3;&#x91CA;&#x5176;&#x5B9E;&#x73B0;&#x6240;&#x7528;&#x7684;&#x6781;&#x5927;&#x52AA;&#x529B;&#xFF0C;&#x4F46;&#x7406;&#x89E3;&#x8D77;&#x6765;&#x4ECD;&#x7136;&#x5341;&#x5206;&#x56F0;&#x96BE;&#x3002;&#x4F46;&#x662F;&#x5F53;&#x6211;&#x5B8C;&#x6574;&#x7684;&#x770B;&#x5B8C;lcc&#x7684;&#x4EE3;&#x7801;&#x5305;&#x62EC;&#x5176;&#x540E;&#x7AEF;&#x540E;&#xFF0C;&#x5F97;&#x5230;&#x7684;&#x6536;&#x83B7;&#x786E;&#x5B9E;&#x5F88;&#x5927;&#x3002;&#x901A;&#x8FC7;&#x9605;&#x8BFB;&#xFF0C;&#x57FA;&#x672C;&#x53EF;&#x4EE5;&#x786E;&#x5B9A;&#x5BF9;&#xFF0C;&#x4E8E;&#x6211;&#x6765;&#x8BF4;&#xFF0C;lcc&#x7684;&#x79FB;&#x690D;&#x5DE5;&#x4F5C;&#x6280;&#x672F;&#x4E0A;&#x662F;&#x53EF;&#x884C;&#x7684;&#x3002;</p>
<h1 id="LCC&#x7684;&#x7ED3;&#x6784;"><a href="#LCC&#x7684;&#x7ED3;&#x6784;" class="headerlink" title="LCC&#x7684;&#x7ED3;&#x6784;"></a>LCC&#x7684;&#x7ED3;&#x6784;</h1><p>&#x5148;&#x8C08;&#x4E00;&#x4E0B;lcc&#x7684;&#x7ED3;&#x6784;&#x3002;&#x539F;&#x4E66;&#x4E2D;&#x7684;&#x53D9;&#x8FF0;&#x65B9;&#x6CD5;&#xFF0C;&#x66F4;&#x591A;&#x7684;&#x662F;&#x4ECE;&#x529F;&#x80FD;&#x6A21;&#x5757;&#x7684;&#x89D2;&#x5EA6;&#x8FDB;&#x884C;&#x53D9;&#x8FF0;&#x7684;&#xFF0C;&#x8BE6;&#x7EC6;&#x7684;&#x63CF;&#x8FF0;&#x4E86;&#x6BCF;&#x4E00;&#x4E2A;&#x6A21;&#x5757;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x4F46;&#x662F;&#x4ECE;&#x7EB5;&#x6DF1;&#x7684;&#x89D2;&#x5EA6;&#x6765;&#x770B;&#xFF0C;&#x7F3A;&#x4E4F;&#x5BF9;&#x6A21;&#x5757;&#x4E4B;&#x95F4;&#x76F8;&#x4E92;&#x8C03;&#x7528;&#x76F8;&#x4E92;&#x914D;&#x5408;&#x7684;&#x63CF;&#x8FF0;&#xFF0C;&#x56E0;&#x6B64;&#x9700;&#x8981;&#x9605;&#x8BFB;&#x65F6;&#x7279;&#x522B;&#x7559;&#x610F;&#x6574;&#x4E2A;&#x7F16;&#x8BD1;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x8FC7;&#x7A0B;&#x4E2D;&#x51FD;&#x6570;&#x4E4B;&#x95F4;&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x624D;&#x80FD;&#x628A;&#x63E1;&#x8FD9;&#x4E2A;&#x590D;&#x6742;&#x7684;&#x7F16;&#x8BD1;&#x7A0B;&#x5E8F;&#x7684;&#x6574;&#x4F53;&#x8109;&#x7EDC;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4ECE;&#x4F20;&#x7EDF;&#x7684;&#x524D;&#x7AEF;-&#x540E;&#x7AEF;&#x89D2;&#x5EA6;&#x53BB;&#x770B;&#x8FD9;&#x4E2A;&#x7F16;&#x8BD1;&#x5668;&#xFF0C;&#x5F88;&#x96BE;&#x53BB;&#x7406;&#x89E3;&#x3002;&#x6211;&#x8BA4;&#x4E3A;&#x524D;&#x7AEF;-&#x540E;&#x7AEF;&#x8FD9;&#x6837;&#x7684;&#x5206;&#x6CD5;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x4ECE;&#x529F;&#x80FD;&#x7684;&#x903B;&#x8F91;&#x5C42;&#x9762;&#x53BB;&#x8003;&#x8651;&#x7684;&#x3002;&#x867D;&#x7136;&#x6574;&#x4E2A;lcc&#x786E;&#x5B9E;&#x5728;&#x5B9E;&#x73B0;&#x4E0A;&#x533A;&#x5206;&#x4E86;&#x524D;&#x7AEF;&#x548C;&#x540E;&#x7AEF;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x8FD0;&#x884C;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x524D;&#x7AEF;&#x548C;&#x540E;&#x7AEF;&#x7684;&#x4EE3;&#x7801;&#x59CB;&#x7EC8;&#x5728;&#x76F8;&#x4E92;&#x914D;&#x5408;&#xFF0C;&#x96BE;&#x4EE5;&#x5728;&#x8FD0;&#x884C;&#x8FC7;&#x7A0B;&#x660E;&#x786E;&#x5206;&#x79BB;&#x3002;&#x5728;&#x6211;&#x5C1A;&#x672A;&#x610F;&#x8BC6;&#x5230;&#x8FD9;&#x4E00;&#x70B9;&#x65F6;&#xFF0C;&#x9605;&#x8BFB;&#x4EE3;&#x7801;&#x57FA;&#x672C;&#x662F;&#x5728;&#x5173;&#x6CE8;&#x67D0;&#x4E2A;&#x6A21;&#x5757;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x6BD4;&#x5982;&#x8BED;&#x6CD5;&#x5206;&#x6790;&#x3002;&#x800C;&#x8FD9;&#x4E9B;&#x6A21;&#x5757;&#x5982;&#x8BED;&#x6CD5;&#x8BED;&#x6CD5;&#x5206;&#x6790;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x8FD0;&#x884C;&#x8FC7;&#x7A0B;&#x4E2D;&#x6BD4;&#x8F83;&#x6DF1;&#x5F97;&#x4E00;&#x5C42;&#xFF0C;&#x4F46;&#x4ECE;&#x8FD9;&#x4E2A;&#x89D2;&#x5EA6;&#xFF0C;&#x5F88;&#x96BE;&#x770B;&#x5230;&#x9605;&#x8BFB;&#x7F16;&#x8BD1;&#x5668;&#x7684;&#x4EE3;&#x7801;&#x5982;&#x4F55;&#x5E26;&#x7ED9;&#x4EBA;&#x4E0E;&#x4EC5;&#x4E0A;&#x7F16;&#x8BD1;&#x539F;&#x7406;&#x8BFE;&#x7A0B;&#x4E0D;&#x540C;&#x7684;&#x597D;&#x5904;&#xFF0C;&#x586B;&#x8865;&#x7406;&#x8BBA;&#x548C;&#x5B9E;&#x8DF5;&#x4E4B;&#x95F4;&#x7684;&#x9E3F;&#x6C9F;&#x3002;<br>&#x56E0;&#x4E3A;&#x8FD9;&#x4E9B;&#x4E00;&#x4E2A;&#x4E00;&#x4E2A;&#x7684;&#x6A21;&#x5757;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x8BED;&#x6CD5;&#x5206;&#x6790;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x4E0E;&#x7F16;&#x8BD1;&#x539F;&#x7406;&#x7684;&#x8BFE;&#x7A0B;&#x5185;&#x5BB9;&#x5F88;&#x76F8;&#x4F3C;&#xFF0C;&#x4E8B;&#x5B9E;&#x4E0A;&#xFF0C;&#x7F16;&#x8BD1;&#x539F;&#x7406;&#x8BFE;&#x7A0B;&#x4E0E;&#x8BED;&#x6CD5;&#x5206;&#x6790;&#x8FD9;&#x90E8;&#x5206;&#x7684;&#x5B9E;&#x73B0;&#x91CD;&#x53E0;&#x5F88;&#x5927;&#x3002;</p>
<p>&#x4ECE;&#x8BED;&#x6CD5;&#x5206;&#x6790;&#x5230;&#x8BED;&#x4E49;&#x5206;&#x6790;&#xFF0C;&#x8FD9;&#x90E8;&#x5206;&#x5185;&#x5BB9;&#x5C31;&#x5F00;&#x59CB;&#x663E;&#x73B0;&#x4E0E;&#x8BA1;&#x7B97;&#x673A;&#x8BFE;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x533A;&#x522B;&#x4E86;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x5B9E;&#x73B0;&#x4E86;ANSI C&#x5B8C;&#x6574;&#x7684;&#x8BED;&#x4E49;&#xFF0C;&#x9605;&#x8BFB;&#x8FD9;&#x90E8;&#x5206;&#xFF0C;&#x66F4;&#x50CF;&#x662F;&#x9605;&#x8BFB;C&#x8BED;&#x8A00;&#x6807;&#x51C6;&#xFF0C;&#x8FD9;&#x91CC;&#x9762;&#x53EF;&#x4EE5;&#x63D0;&#x70BC;&#x51FA;&#x4E00;&#x4E9B;&#x8BDD;&#x9898;&#x8FDB;&#x884C;&#x6DF1;&#x5165;&#x8BA8;&#x8BBA;&#xFF0C;&#x5982;C&#x8BED;&#x8A00;&#x4E2D;&#x7684;&#x7A7A;&#x6307;&#x9488;&#x5B9A;&#x4E49;&#xFF0C;&#x5F3A;&#x5236;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#xFF0C;&#x51FD;&#x6570;&#x8C03;&#x7528;&#xFF0C;&#x53EF;&#x53D8;&#x53C2;&#x6570;&#x51FD;&#x6570;&#xFF0C;&#x53C2;&#x6570;&#x7684;&#x4F30;&#x503C;&#x987A;&#x5E8F;&#xFF0C;&#x7ED3;&#x6784;&#x4F53;&#x4E2D;&#x6570;&#x636E;&#x7684;&#x5BF9;&#x9F50;&#xFF0C;C&#x8BED;&#x8A00;&#x4E2D;&#x590D;&#x6742;&#x7684;&#x58F0;&#x660E;&#x7B49;&#x7B49;&#x3002;&#x4ECE;&#x7F16;&#x8BD1;&#x5668;&#x89D2;&#x5EA6;&#x770B;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#xFF0C;&#x7684;&#x786E;&#x7ED9;&#x4EBA;&#x8033;&#x76EE;&#x4E00;&#x65B0;&#x7684;&#x611F;&#x89C9;&#xFF0C;&#x4F46;&#x662F;&#x4EC5;&#x4EC5;&#x8BFB;&#x5230;&#x8FD9;&#x91CC;&#xFF0C;&#x4ECD;&#x7136;&#x4F1A;&#x6709;&#x8BB8;&#x591A;&#x7591;&#x60D1;&#x5C1A;&#x672A;&#x88AB;&#x89E3;&#x91CA;&#x3002;&#x4F8B;&#x5982;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x3001;&#x53C2;&#x6570;&#x4F20;&#x9012;&#xFF0C;&#x8FD9;&#x4E9B;&#x90FD;&#x9700;&#x8981;&#x548C;&#x8BA1;&#x7B97;&#x5E73;&#x53F0;&#x914D;&#x5408;&#xFF0C;&#x8FD9;&#x4E9B;&#x529F;&#x80FD;&#x7684;&#x5177;&#x4F53;&#x5B9E;&#x73B0;&#xFF0C;&#x8FD8;&#x8981;&#x7EE7;&#x7EED;&#x6DF1;&#x5165;&#x4E86;&#x89E3;&#x3002;&#x6211;&#x8BFB;&#x5230;&#x8FD9;&#x91CC;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6700;&#x5927;&#x7684;&#x7591;&#x60D1;&#x5C31;&#x662F;&#x7A0B;&#x5E8F;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x662F;&#x5982;&#x4F55;&#x548C;&#x5404;&#x4E2A;&#x6807;&#x8BC6;&#x7B26;&#x76F8;&#x5173;&#x8054;&#x7684;&#xFF0C;&#x5185;&#x5B58;&#x7684;&#x5730;&#x5740;&#x662F;&#x5982;&#x4F55;&#x548C;&#x53D8;&#x91CF;&#x540D;&#x76F8;&#x5173;&#x8054;&#x7684;&#x3002;</p>
<p>&#x7EE7;&#x7EED;&#x6DF1;&#x5165;&#x4E0B;&#x53BB;&#xFF0C;lcc&#x7684;&#x7ED3;&#x6784;&#x5C31;&#x6E10;&#x6E10;&#x6D6E;&#x51FA;&#x6C34;&#x9762;&#x3002;&#x6309;&#x7167;c&#x8BED;&#x8A00;&#x7684;&#x6587;&#x6CD5;&#xFF0C;&#x4E00;&#x4E2A;translation unit&#x662F;c&#x8BED;&#x8A00;&#x7A0B;&#x5E8F;&#x7684;&#x57FA;&#x672C;&#x5904;&#x7406;&#x5355;&#x5143;&#xFF0C;translation unit &#x5305;&#x62EC;&#x58F0;&#x660E;&#xFF0C;&#x53EF;&#x4EE5;&#x662F;&#x53D8;&#x91CF;&#x6216;&#x8005;&#x662F;&#x51FD;&#x6570;&#x7684;&#x58F0;&#x660E;&#xFF0C;&#x4E00;&#x4E2A;c&#x8BED;&#x8A00;&#x6587;&#x4EF6;&#x53EF;&#x4EE5;&#x5305;&#x62EC;&#x82E5;&#x5E72;translation unit&#x3002;&#x53D8;&#x91CF;&#x7684;&#x58F0;&#x660E;&#xFF0C;&#x53EA;&#x662F;&#x5904;&#x7406;&#x4E86;&#x6807;&#x8BC6;&#x7B26;&#x3001;&#x7C7B;&#x578B;&#x3001;&#x503C;&#x5728;&#x7F16;&#x8BD1;&#x5668;&#x5185;&#x7684;&#x5185;&#x90E8;&#x8868;&#x793A;&#x3002;&#x5BF9;&#x4E8E;&#x53D8;&#x91CF;&#x7684;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x4E0D;&#x4EA7;&#x751F;&#x4EE3;&#x7801;&#xFF0C;&#x800C;&#x662F;&#x76F4;&#x63A5;&#x5C06;&#x7B26;&#x53F7;&#x548C;&#x503C;&#x76F8;&#x4E92;&#x5BF9;&#x5E94;&#x8D77;&#x6765;&#x3002;&#x53EA;&#x6709;&#x8FDB;&#x884C;&#x51FD;&#x6570;&#x5B9A;&#x4E49;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x624D;&#x4F1A;&#x751F;&#x6210;&#x4EE3;&#x7801;&#x3002;&#x6240;&#x4EE5;&#x5206;&#x6790;lcc&#x7684;&#x6574;&#x4F53;&#x8109;&#x7EDC;&#xFF0C;&#x9700;&#x8981;&#x77E5;&#x9053;&#x4E66;&#x4E2D;&#x8BA8;&#x8BBA;&#x7684;&#x5404;&#x79CD;&#x529F;&#x80FD;&#x6A21;&#x5757;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x4EE5;&#x51FD;&#x6570;&#x5B9A;&#x4E49;&#x4E3A;&#x5355;&#x5143;&#xFF0C;&#x5F80;&#x590D;&#x8FDB;&#x884C;&#x8C03;&#x7528;&#x3002;&#x6240;&#x4EE5;&#x5206;&#x6790;&#x5E94;&#x4ECE;&#x51FD;&#x6570;&#x5B9A;&#x4E49;&#x5F00;&#x59CB;&#xFF0C;&#x9010;&#x6B65;&#x6DF1;&#x5165;&#x3002;&#x4FBF;&#x53EF;&#x7406;&#x89E3;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;c&#x8BED;&#x8A00;&#x7A0B;&#x5E8F;&#x662F;&#x5982;&#x4F55;&#x88AB;lcc&#x5904;&#x7406;&#x7684;&#x3002;</p>
<p>&#x5904;&#x7406;&#x51FD;&#x6570;&#x5B9A;&#x4E49;&#x7684;&#x51FD;&#x6570;funcdefn&#x7B2C;&#x4E00;&#x90E8;&#x5206;&#x5904;&#x7406;&#x8981;&#x5B9A;&#x4E49;&#x7684;&#x51FD;&#x6570;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x53C2;&#x6570;&#x5217;&#x8868;&#xFF0C;&#x5904;&#x7406;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x548C;&#x53C2;&#x6570;&#xFF08;&#x4E3B;&#x8981;&#x662F;&#x901A;&#x8FC7;&#x540E;&#x7AEF;&#x6307;&#x5B9A;&#x540D;&#x5B57;&#xFF0C;&#x5C06;&#x540D;&#x5B57;&#x6307;&#x5B9A;&#x4E3A;&#x76F8;&#x5BF9;&#x4E8E;&#x6808;&#x7684;offset&#xFF09;&#xFF0C;&#x7136;&#x540E;&#x5BF9;&#x51FD;&#x6570;&#x5B9A;&#x4E49;&#x7684;compound statement&#x8FDB;&#x884C;&#x8BED;&#x6CD5;&#x8BED;&#x4E49;&#x5206;&#x6790;&#xFF0C;&#x4E00;&#x8FB9;&#x5206;&#x6790;&#xFF0C;&#x4E00;&#x8FB9;&#x751F;&#x6210;&#x4E2D;&#x95F4;&#x8BED;&#x8A00;&#xFF08;&#x68EE;&#x6797;&#x5F62;&#x5F0F;&#x7684;&#x4E2D;&#x95F4;&#x8BED;&#x8A00;&#xFF09;&#xFF0C;&#x751F;&#x6210;&#x4E2D;&#x95F4;&#x8BED;&#x8A00;&#x7684;&#x8FC7;&#x7A0B;&#x52A0;&#x4EE5;&#x4F18;&#x5316;&#xFF08;&#x5982;&#x6D88;&#x9664;&#x516C;&#x5171;&#x5B50;&#x5F0F;&#xFF0C;&#x5E38;&#x91CF;&#x6298;&#x53E0;&#xFF09;&#x3002;&#x7136;&#x540E;&#x8C03;&#x7528;&#x540E;&#x7AEF;function&#x51FD;&#x6570;&#xFF0C;&#x5BF9;&#x4E2D;&#x95F4;&#x8BED;&#x8A00;&#x8FDB;&#x884C;&#x5904;&#x7406;&#x3002;</p>
<p>function&#x51FD;&#x6570;&#xFF0C;&#x9996;&#x5148;&#x6839;&#x636E;funcdefn&#x4F20;&#x9012;&#x8FC7;&#x6765;&#x7684;&#x53C2;&#x6570;&#x548C;&#x5C40;&#x90E8;&#x53D8;&#x91CF;offset&#x8BA1;&#x7B97;&#x6808;&#x504F;&#x79FB;&#xFF0C;&#x5982;&#x679C;&#x9700;&#x8981;&#xFF0C;&#x5219;&#x4E3A;&#x751F;&#x6210;&#x590D;&#x5236;&#x53C2;&#x6570;&#x7684;&#x4EE3;&#x7801;&#xFF08;&#x5982;&#x539F;&#x6765;&#x53C2;&#x6570;&#x7531;&#x5BC4;&#x5B58;&#x5668;&#x4F20;&#x5165;&#xFF0C;&#x9700;&#x8981;&#x7528;&#x53E6;&#x4E00;&#x4E2A;&#x5BC4;&#x5B58;&#x5668;&#x6216;&#x653E;&#x5165;&#x6808;&#x4E2D;&#xFF09;&#xFF0C;&#x4E3A;&#x751F;&#x6210;&#x4FDD;&#x5B58;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x7EA6;&#x5B9A;&#x4E2D;&#x8981;&#x4FDD;&#x5B58;&#x7684;&#x5BC4;&#x5B58;&#x5668;&#x7684;&#x4EE3;&#x7801;&#x505A;&#x51C6;&#x5907;&#xFF0C;&#x7136;&#x540E;&#x8C03;&#x7528;gencode&#xFF0C;&#x5BF9;&#x4E2D;&#x95F4;&#x8BED;&#x8A00;&#x8FDB;&#x884C;&#x5904;&#x7406;&#x3002;</p>
<p>gencode&#x9996;&#x5148;&#x751F;&#x6210;&#x5BF9;&#x53C2;&#x6570;&#x8FDB;&#x884C;&#x590D;&#x5236;&#x7684;&#x4E2D;&#x95F4;&#x8BED;&#x8A00;&#xFF0C;&#x7136;&#x540E;&#x6839;&#x636E;&#x4E2D;&#x95F4;&#x4EE3;&#x7801;&#x68EE;&#x6797;&#x4E2D;&#x6811;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x8C03;&#x7528;&#x76F8;&#x5E94;&#x7684;&#x540E;&#x7AEF;&#x51FD;&#x6570;&#x3002;Blockbeg&#x5BF9;&#x4E8E;compound statement&#x4E2D;&#x7684;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x4EE5;for&#x5FAA;&#x73AF;&#x7684;&#x5F62;&#x5F0F;&#x9010;&#x4E2A;&#x8C03;&#x7528;local&#xFF0C;&#x5206;&#x914D;&#x5BC4;&#x5B58;&#x5668;&#x53D8;&#x91CF;&#x6216;&#x5728;&#x6808;&#x4E2D;&#x5212;&#x5206;&#x7A7A;&#x95F4;&#xFF1B;Local&#xFF0C;address&#x8282;&#x70B9;&#x4E13;&#x95E8;&#x5904;&#x7406;&#x4E34;&#x65F6;&#x751F;&#x6210;&#x7684;local&#x53D8;&#x91CF;&#x3002;gen&#x8282;&#x70B9;&#x662F;&#x91CD;&#x4E2D;&#x4E4B;&#x91CD;&#xFF0C;&#x8D1F;&#x8D23;&#x751F;&#x6210;&#x4E3B;&#x8981;&#x7684;&#x4EE3;&#x7801;&#x3002;</p>
<p>gencode&#x2014;&gt;gen,&#x5904;&#x7406;&#x6811;&#x72B6;&#x7684;&#x4E2D;&#x95F4;&#x8BED;&#x8A00;&#x3002;&#x8FD9;&#x90E8;&#x5206;&#x4E66;&#x4E2D;&#x8868;13.1&#x63CF;&#x8FF0;&#x7684;&#x8F83;&#x4E3A;&#x6E05;&#x6670;&#xFF0C;prelabel&#x5904;&#x7406;&#x5DF2;&#x7ECF;&#x786E;&#x5B9A;&#x4E86;&#x5BC4;&#x5B58;&#x5668;&#x7684;&#x8282;&#x70B9;&#x7684;target&#xFF0C;_label&#x5728;&#x6811;&#x4E0A;&#x7528;&#x6811;&#x6587;&#x6CD5;&#x4E0E;&#x540E;&#x7AEF;&#x6A21;&#x677F;&#x8FDB;&#x884C;&#x5339;&#x914D;&#xFF0C;reduce&#x9009;&#x62E9;&#x6700;&#x597D;&#x7684;&#x6307;&#x4EE4;&#x8F93;&#x51FA;&#x3002;prune&#x5220;&#x53BB;&#x4E00;&#x4E9B;&#x4E0D;&#x751F;&#x6210;&#x6307;&#x4EE4;&#x7684;&#x5B50;&#x8282;&#x70B9;&#xFF0C;linerize&#x5BF9;&#x6307;&#x4EE4;&#x8FDB;&#x884C;&#x6392;&#x5E8F;&#xFF0C;&#x6700;&#x540E;ralloc&#x5BF9;&#x9700;&#x8981;&#x5BC4;&#x5B58;&#x5668;&#x7684;&#x8282;&#x70B9;&#x5206;&#x914D;&#x5BC4;&#x5B58;&#x5668;&#x3002;</p>
<p>&#x7136;&#x540E;function &#x51FD;&#x6570;&#x5F00;&#x59CB;&#x771F;&#x6B63;&#x751F;&#x6210;&#x4EE3;&#x7801;&#xFF0C;&#x9996;&#x5148;&#x5148;&#x8F93;&#x51FA;&#x51FD;&#x6570;&#x540D;&#x4F5C;&#x4E3A;label&#xFF0C;&#x4F5C;&#x4E3A;&#x51FD;&#x6570;&#x7684;&#x5165;&#x53E3;&#xFF0C;&#x7136;&#x540E;&#x8BA1;&#x7B97;framesize&#x548C;sp&#xFF0C;&#x5E76;&#x5C06;sp&#x79FB;&#x52A8;&#x7684;&#x6307;&#x4EE4;&#x8F93;&#x51FA;&#xFF08;&#x5212;&#x5206;&#x6808;&#x7A7A;&#x95F4;&#xFF09;&#xFF0C;&#x7136;&#x540E;&#x8F93;&#x51FA;&#x4FDD;&#x5B58;&#x5BC4;&#x5B58;&#x5668;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x662F;&#x79FB;&#x52A8;&#x53C2;&#x6570;&#x7684;&#x4EE3;&#x7801;&#x3002;&#x8FD9;&#x4E9B;&#x5DE5;&#x4F5C;&#x505A;&#x5B8C;&#xFF0C;function&#x8C03;&#x7528;emitcode&#x51FD;&#x6570;&#xFF0C;&#x751F;&#x6210;&#x51FD;&#x6570;&#x4E2D;&#x7684;&#x8BED;&#x53E5;&#x751F;&#x6210;&#x7684;&#x4EE3;&#x7801;&#xFF08;&#x4ECE;&#x5DF2;&#x7ECF;&#x88AB;&#x6807;&#x8BB0;&#x4FEE;&#x51CF;&#x7684;&#x4E2D;&#x95F4;&#x8BED;&#x8A00;&#x6811;&#x4E2D;&#xFF0C;&#x6309;&#x6A21;&#x677F;&#x751F;&#x6210;&#x6C47;&#x7F16;&#x6307;&#x4EE4;&#xFF09;&#x3002;&#x6700;&#x540E;&#x751F;&#x6210;&#x51FD;&#x6570;&#x7684;&#x51FA;&#x53E3;&#xFF0C;&#x5305;&#x62EC;&#x6062;&#x590D;&#x4FDD;&#x5B58;&#x7684;&#x5BC4;&#x5B58;&#x5668;&#xFF0C;&#x6808;&#x5F39;&#x51FA;&#xFF0C;&#x8DF3;&#x8F6C;&#x8FD4;&#x56DE;&#x6307;&#x4EE4;&#x3002;</p>
<h1 id="&#x53D8;&#x91CF;&#x7684;&#x6807;&#x8BC6;&#x7B26;&#x548C;&#x503C;"><a href="#&#x53D8;&#x91CF;&#x7684;&#x6807;&#x8BC6;&#x7B26;&#x548C;&#x503C;" class="headerlink" title="&#x53D8;&#x91CF;&#x7684;&#x6807;&#x8BC6;&#x7B26;&#x548C;&#x503C;"></a>&#x53D8;&#x91CF;&#x7684;&#x6807;&#x8BC6;&#x7B26;&#x548C;&#x503C;</h1><p>&#x6211;&#x5728;&#x9605;&#x8BFB;&#x4EE3;&#x7801;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5341;&#x5206;&#x5173;&#x6CE8;&#x6807;&#x8BC6;&#x7B26;&#x548C;&#x503C;&#x662F;&#x5982;&#x4F55;&#x5173;&#x8054;&#x7684;&#x3002;&#x5B9E;&#x9645;&#x4E0A;lcc&#x5C06;&#x4E8E;C&#x8BED;&#x8A00;&#x7684;&#x53D8;&#x91CF;&#x540D;&#xFF0C;&#x5904;&#x7406;&#x4E3A;&#x5728;&#x6570;&#x636E;&#x6BB5;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x6807;&#x7B7E;&#x3002;&#x5BF9;&#x4E8E;&#x672A;&#x521D;&#x59CB;&#x5316;&#x7684;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#xFF0C;lcc&#x5C06;&#x53D8;&#x91CF;&#x540D;&#x6807;&#x7B7E;&#x653E;&#x5165;bss&#x6BB5;&#xFF1B;&#x5BF9;&#x4E8E;&#x521D;&#x59CB;&#x5316;&#x7684;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#xFF0C;lcc&#x6839;&#x636E;&#x60C5;&#x51B5;&#x5C06;&#x3010;&#x53D8;&#x91CF;&#x540D;&#x6807;&#x7B7E;&#xFF1A;&#x503C;&#x3011;&#x5BF9;&#x653E;&#x5165;LIT&#xFF08;read only&#xFF09;&#x6216;data&#x6BB5;&#xFF0C;&#x5B9E;&#x9645;&#x7684;&#x5730;&#x5740;&#x751F;&#x6210;&#x662F;&#x6C47;&#x7F16;&#x5668;&#x7684;&#x5DE5;&#x4F5C;&#x3002;&#x5BF9;&#x4E8E;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#xFF0C;&#x5219;&#x5168;&#x90E8;&#x8868;&#x793A;&#x4E3A;&#x6808;&#x504F;&#x79FB;&#x7684;&#x5F62;&#x5F0F;&#x3002;&#x8FD9;&#x6837;&#x505A;&#x7684;&#x539F;&#x56E0;&#x662F;&#x663E;&#x800C;&#x6613;&#x89C1;&#x7684;&#xFF1A;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x65F6;&#x7684;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x662F;&#x52A8;&#x6001;&#x7684;&#xFF0C;&#x5F88;&#x96BE;&#x786E;&#x5B9A;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x7684;&#x7EDD;&#x5BF9;&#x5730;&#x5740;&#xFF0C;&#x6240;&#x4EE5;&#x4F7F;&#x7528;&#x76F8;&#x5BF9;&#x4E8E;&#x6808;&#x7684;&#x504F;&#x79FB;&#x6765;&#x89E3;&#x51B3;&#x95EE;&#x9898;&#x3002;&#x4E0D;&#x540C;&#x4E8E;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#xFF0C;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x7684;&#x521D;&#x59CB;&#x5316;&#x662F;&#x7528;&#x751F;&#x6210;&#x7684;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#x7684;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x4E00;&#x4E9B;&#x7279;&#x6B8A;&#x7684;&#x53D8;&#x91CF;&#xFF0C;&#x5982;&#x6570;&#x7EC4;&#x3001;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x9996;&#x5148;&#x5C06;&#x5E38;&#x91CF;&#x7684;&#x5185;&#x5BB9;&#x653E;&#x5165;LIT&#x6BB5;&#xFF0C;&#x7136;&#x540E;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x4E34;&#x65F6;&#x53D8;&#x91CF;&#x4FDD;&#x5B58;&#x8FD9;&#x4E2A;&#x5E38;&#x91CF;&#x5185;&#x5BB9;&#x7684;&#x6807;&#x7B7E;&#x3002;</p>
<h1 id="lcc&#x4E2D;mips&#x540E;&#x7AEF;&#x7684;&#x5E27;&#x7ED3;&#x6784;"><a href="#lcc&#x4E2D;mips&#x540E;&#x7AEF;&#x7684;&#x5E27;&#x7ED3;&#x6784;" class="headerlink" title="lcc&#x4E2D;mips&#x540E;&#x7AEF;&#x7684;&#x5E27;&#x7ED3;&#x6784;"></a>lcc&#x4E2D;mips&#x540E;&#x7AEF;&#x7684;&#x5E27;&#x7ED3;&#x6784;</h1><pre><code>&#x9AD8;&#x5730;&#x5740;
    --------------------------------
    | &#x8C03;&#x7528;&#x8005;&#x7684;&#x5E27;                    |
    --------------------------------
    |&#x8C03;&#x7528;&#x8005;&#x4F20;&#x9012;&#x7684;&#x53C2;&#x6570;               |
    --------------------------------        &#x2014;&#x2014;
    |&#x5C40;&#x90E8;&#x53D8;&#x91CF;                       |        |
    --------------------------------
    |&#x88AB;&#x8C03;&#x7528;&#x8005;&#x4FDD;&#x5B58;&#x7684;&#x73B0;&#x573A;             |       Framesize
    -------------------------------
    |&#x88AB;&#x8C03;&#x7528;&#x8005;&#x8C03;&#x7528;&#x5176;&#x4ED6;&#x51FD;&#x6570;&#x65F6;&#x4F20;&#x9012;&#x7684;&#x53C2;&#x6570;|         |
    -------------------------------         &#x2014;&#x2014;-----&gt;sp
    |&#x53E6;&#x4E00;&#x4E2A;&#x5E27;                       |
&#x4F4E;&#x5730;&#x5740;        </code></pre><p>&#x8FD9;&#x91CC;&#x503C;&#x5F97;&#x4E00;&#x63D0;&#x7684;&#x662F;&#xFF0C;&#x53C2;&#x6570;&#x7684;&#x504F;&#x79FB;&#x662F;&#x76F8;&#x5BF9;&#x4E8E;sp+framesize&#x7684;&#x6B63;&#x504F;&#x79FB;&#xFF0C;&#x56E0;&#x6B64;&#x662F;&#x4ECE;&#x8C03;&#x7528;&#x8005;&#x7684;&#x5E27;&#x4E2D;&#x83B7;&#x53D6;&#x53C2;&#x6570;&#x7684;&#x503C;&#xFF08;&#x53C2;&#x6570;&#x4F20;&#x9012;&#xFF09;&#xFF0C;&#x800C;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x7684;&#x504F;&#x79FB;&#x662F;&#x76F8;&#x5BF9;&#x4E8E;sp+framesize&#x7684;&#x8D1F;&#x504F;&#x79FB;&#x3002;</p>
<p>&#x53E6;&#x4E00;&#x5904;&#x503C;&#x5F97;&#x8BF4;&#x660E;&#x7684;&#x662F;&#xFF0C;&#x88AB;&#x8C03;&#x7528;&#x8005;&#x5982;&#x679C;&#x8C03;&#x7528;&#x4E86;&#x5176;&#x4ED6;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x9700;&#x8981;&#x5728;&#x5F53;&#x524D;&#x6808;&#x4E2D;&#x5F00;&#x8F9F;&#x5B58;&#x653E;outgoing argument&#x7684;&#x7A7A;&#x95F4;&#xFF0C;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x8C03;&#x7528;&#x5F88;&#x591A;&#x4E2A;&#x5176;&#x4ED6;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x8FD9;&#x4E2A;&#x7A7A;&#x95F4;&#x5982;&#x4F55;&#x786E;&#x5B9A;&#xFF1F;&#x5728;&#x751F;&#x6210;&#x51FD;&#x6570;&#x7684;&#x4EE3;&#x7801;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x5BF9;&#x6240;&#x6709;&#x7684;&#x5B50;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x7684;&#x53C2;&#x6570;&#x8FDB;&#x884C;&#x7EDF;&#x8BA1;&#xFF0C;&#x5F97;&#x5230;&#x6700;&#x5927;&#x7684;outgoing argument&#x6570;&#x91CF;&#xFF0C;&#x8FD9;&#x91CC;&#x8FD9;&#x4E2A;&#x7A7A;&#x95F4;&#x662F;&#x8FD9;&#x6837;&#x786E;&#x5B9A;&#x7684;&#x3002;</p>
<h1 id="&#x5C0F;&#x7ED3;"><a href="#&#x5C0F;&#x7ED3;" class="headerlink" title="&#x5C0F;&#x7ED3;"></a>&#x5C0F;&#x7ED3;</h1><p>&#x4E86;&#x89E3;&#x4E86;lcc&#x7684;&#x7ED3;&#x6784;&#xFF0C;&#x7406;&#x89E3;&#x4E86;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;c&#x8BED;&#x8A00;&#x7A0B;&#x5E8F;&#x662F;&#x5982;&#x4F55;&#x7531;lcc&#x4E00;&#x6B65;&#x4E00;&#x6B65;&#x751F;&#x6210;&#x6C47;&#x7F16;&#x8BED;&#x8A00;&#x7684;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x79FB;&#x690D;&#x5DE5;&#x4F5C;&#x4E86;&#x3002;</p>
<p>&#x79FB;&#x690D;&#x5DE5;&#x4F5C;&#x4E3B;&#x8981;&#x5305;&#x62EC;&#xFF1A;&#x4FEE;&#x6539;&#x6307;&#x4EE4;&#x6A21;&#x677F;&#xFF0C;&#x4FEE;&#x6539;&#x5BC4;&#x5B58;&#x5668;&#x5206;&#x914D;&#x89C4;&#x5219;&#xFF0C;&#x4FEE;&#x6539;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x89C4;&#x5219;&#xFF0C;&#x4FEE;&#x6539;&#x5404;&#x4E2A;&#x57FA;&#x672C;&#x7C7B;&#x578B;&#x7684;&#x957F;&#x5EA6;&#x548C;&#x5BF9;&#x9F50;&#xFF0C;&#x4FEE;&#x6539;&#x5404;&#x79CD;&#x540D;&#x79F0;&#x7EA6;&#x5B9A;&#xFF08;&#x5982;&#x5404;&#x6570;&#x636E;&#x6BB5;&#x7684;&#x540D;&#x5B57;&#xFF09;&#x7B49;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x6211;&#x5373;&#x5C06;&#x8FDB;&#x884C;&#x7684;&#x5DE5;&#x4F5C;&#xFF0C;&#x4E3B;&#x8981;&#x7684;&#x4FEE;&#x6539;&#x5E94;&#x8BE5;&#x5305;&#x62EC;&#x4FEE;&#x6539;&#x7C7B;&#x578B;&#x7684;&#x957F;&#x5EA6;&#x548C;&#x5BF9;&#x9F50;&#xFF08;&#x7531;&#x4E8E;cpu&#x53D6;&#x6570;&#x64CD;&#x4F5C;&#x4E0E;mips&#x4E0D;&#x540C;&#xFF09;&#xFF0C;&#x5BF9;&#x4E8E;&#x4E58;&#x6CD5;&#x9664;&#x6CD5;&#x6307;&#x4EE4;&#x6A21;&#x677F;&#x5E94;&#x8BE5;&#x4E3A;&#x51FD;&#x6570;&#x8C03;&#x7528;&#xFF08;cpu&#x65E0;&#x4E58;&#x6CD5;&#x5668;&#x3001;&#x9664;&#x6CD5;&#x5668;&#xFF0C;&#x8FD9;&#x91CC;&#x8FD8;&#x9700;&#x4FEE;&#x6539;clobber&#x51FD;&#x6570;&#xFF09;&#xFF0C;&#x5BF9;&#x4E8E;&#x6D6E;&#x70B9;&#x64CD;&#x4F5C;&#xFF0C;&#x9700;&#x8981;&#x5148;&#x7528;&#x7F16;&#x8BD1;&#x5668;&#x7F16;&#x8BD1;&#x751F;&#x6210;&#x8BA1;&#x7B97;&#x51FD;&#x6570;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x6307;&#x4EE4;&#x6A21;&#x677F;&#x4FEE;&#x6539;&#x4E3A;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x3002;&#x4FEE;&#x6539;&#x4E2A;&#x6570;&#x636E;&#x6BB5;&#x540D;&#x5B57;&#x4E0E;&#x6C47;&#x7F16;&#x5668;&#x914D;&#x5408;&#x3002;</p>

    
    </div>
    
    
</article>






    <script src='https://unpkg.com/mermaid@8.8.0/dist/mermaid.min.js'></script>
    <script>
      if (window.mermaid) {
        mermaid.initialize({theme: 'forest'});
      }
    </script>
  

  
    
        <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/%E5%9C%A8MIPS-CPU%E4%B8%AD%E5%BC%95%E5%85%A5%E5%BE%AE%E4%BB%A3%E7%A0%81/" itemprop="url">在MIPS CPU中引入微代码</a>
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            
                <time datetime="2020-05-04T04:44:34.000Z" itemprop="datePublished">5月 4 2020</time>
            
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/home-brew-computer-system/">home brew computer system</a>
        </span>
        
        
        <span class="column is-narrow">
            
            
            28 分钟 read (About 4129 words)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <p>&#x672C;&#x9879;&#x76EE;&#x6240;&#x8BBE;&#x8BA1;&#x7684;CPU&#xFF0C;&#x4E0E;&#x674E;&#x4E9A;&#x6C11;&#x4E66;&#x4E2D;&#x6240;&#x63CF;&#x8FF0;&#x7684;CPU&#x4E3B;&#x8981;&#x533A;&#x522B;&#x662F;&#x5728;MIPS CPU&#x4E2D;&#x5F15;&#x5165;&#x4E86;&#x5FAE;&#x4EE3;&#x7801;&#xFF0C;&#x65B9;&#x4FBF;&#x6307;&#x4EE4;&#x96C6;&#x7684;&#x6269;&#x5C55;&#x3001;&#x7F16;&#x8BD1;&#x5668;&#x7684;&#x79FB;&#x690D;&#x548C;&#x7CFB;&#x7EDF;&#x7F16;&#x7A0B;&#x3002;</p>
<h2 id="&#x5E26;&#x6709;&#x5FAE;&#x6307;&#x4EE4;&#x7684;IF&#x7EA7;"><a href="#&#x5E26;&#x6709;&#x5FAE;&#x6307;&#x4EE4;&#x7684;IF&#x7EA7;" class="headerlink" title="&#x5E26;&#x6709;&#x5FAE;&#x6307;&#x4EE4;&#x7684;IF&#x7EA7;"></a>&#x5E26;&#x6709;&#x5FAE;&#x6307;&#x4EE4;&#x7684;IF&#x7EA7;</h2><p><img src="/%E5%9C%A8MIPS-CPU%E4%B8%AD%E5%BC%95%E5%85%A5%E5%BE%AE%E4%BB%A3%E7%A0%81/IF_with_micro_code.png" alt="&#x539F;&#x7406;&#x56FE;"></p>
<p>&#x7531;&#x539F;&#x7406;&#x56FE;&#x53EF;&#x77E5;&#xFF0C;&#x4E3B;&#x8981;&#x7684;&#x4FEE;&#x6539;&#x662F;&#x52A0;&#x5165;&#x4E86;&#xFF1A;</p>
<ul>
<li>&#x5FAE;&#x6307;&#x4EE4;&#x5B58;&#x50A8;&#x5668; uprog</li>
<li>&#x5FAE;&#x6307;&#x4EE4;&#x5BC4;&#x5B58;&#x5668; uPC</li>
<li>&#x4E0B;&#x4E00;&#x4E2A;&#x5FAE;&#x6307;&#x4EE4;&#x9009;&#x62E9;&#x5668;</li>
<li>IF&#x63A7;&#x5236;&#x5668; IF Control</li>
<li>&#x72B6;&#x6001;&#x5BC4;&#x5B58;&#x5668; State</li>
</ul>
<h2 id="&#x5FAE;&#x6307;&#x4EE4;&#x5B58;&#x50A8;&#x5668;&#x7684;&#x7ED3;&#x6784;"><a href="#&#x5FAE;&#x6307;&#x4EE4;&#x5B58;&#x50A8;&#x5668;&#x7684;&#x7ED3;&#x6784;" class="headerlink" title="&#x5FAE;&#x6307;&#x4EE4;&#x5B58;&#x50A8;&#x5668;&#x7684;&#x7ED3;&#x6784;"></a>&#x5FAE;&#x6307;&#x4EE4;&#x5B58;&#x50A8;&#x5668;&#x7684;&#x7ED3;&#x6784;</h2><p>&#x672C;&#x5E73;&#x53F0;&#x4F7F;&#x7528;&#x7684;&#x5FAE;&#x6307;&#x4EE4;&#x6709;&#x5982;&#x4E0B;&#x7ED3;&#x6784;&#xFF1A;</p>
<pre class="mermaid">classDiagram
class MicroCode{
    head 1
    head 2
    ......
    head n
    code1 ()
    code2 ()
    coden ()
}

class Head{
    a JUMP instruction
    first op in the code section-delay slot
}</pre>


<p>&#x5FAE;&#x6307;&#x4EE4;&#x5B58;&#x50A8;&#x5668;&#x5305;&#x62EC;&#x4E24;&#x4E2A;&#x90E8;&#x5206;,&#x5934;&#x90E8;&#x6309;&#x7167;&#x6307;&#x4EE4;&#x53F7;&#x5BFB;&#x5740;&#xFF0C;&#x6309;&#x987A;&#x5E8F;&#x5B58;&#x653E;&#x5728;&#x5B58;&#x50A8;&#x5668;&#x4E2D;&#x3002;&#x6BCF;&#x4E2A;&#x5934;&#x90E8;&#x57DF;&#x6709;&#x4E24;&#x884C;&#xFF0C;&#x7B2C;&#x4E00;&#x884C;&#x662F;&#x4E00;&#x4E2A;&#x8DF3;&#x8F6C;&#x6307;&#x4EE4;&#xFF0C;&#x8DF3;&#x8F6C;&#x5230;&#x5BF9;&#x5E94;&#x7684;&#x4EE3;&#x7801;&#x57DF;&#xFF0C;&#x7B2C;&#x4E8C;&#x884C;&#x662F;&#x4E3A;&#x4E86;&#x6EE1;&#x8DB3;&#x5EF6;&#x65F6;&#x69FD;&#x7684;&#x7279;&#x70B9;&#xFF0C;&#x5C06;&#x4EE3;&#x7801;&#x57DF;&#x7684;&#x7B2C;&#x4E00;&#x884C;&#x4EE3;&#x7801;&#x653E;&#x7F6E;&#x5728;&#x5EF6;&#x65F6;&#x69FD;&#x4E2D;&#x3002;</p>
<p>&#x7531;&#x4E8E;&#x5FAE;&#x6307;&#x4EE4;&#x7684;&#x5934;&#x90E8;&#x6709;&#x4E24;&#x884C;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x4F7F;&#x7528;&#x6307;&#x4EE4;&#x4E2D;&#x7684;&#x6307;&#x4EE4;&#x53F7;&#x4F5C;&#x4E3A;&#x5730;&#x5740;&#x5BF9;&#x5FAE;&#x4EE3;&#x7801;&#x5B58;&#x50A8;&#x5668;&#x5BFB;&#x5740;&#x65F6;&#xFF0C;&#x8981;&#x5148;&#x5411;&#x5DE6;&#x4F4D;&#x79FB;&#x4E00;&#x4F4D;&#x3002;</p>
<p>&#x5982;&#x6B64;&#x8BBE;&#x8BA1;&#x5FAE;&#x6307;&#x4EE4;&#x5B58;&#x50A8;&#x5668;&#xFF0C;&#x53EF;&#x4EE5;&#x65B9;&#x4FBF;&#x5BFB;&#x5740;&#xFF0C;&#x5E76;&#x4E14;&#x6700;&#x5927;&#x9650;&#x5EA6;&#x5730;&#x5229;&#x7528;&#x5FAE;&#x6307;&#x4EE4;&#x5B58;&#x50A8;&#x5668;&#x7684;&#x7A7A;&#x95F4;&#xFF0C;&#x5934;&#x90E8;&#x548C;&#x4EE3;&#x7801;&#x4E4B;&#x95F4;&#x6CA1;&#x6709;&#x5206;&#x5272;&#x3002;</p>
<p>&#x5FAE;&#x6307;&#x4EE4;&#x5B58;&#x50A8;&#x5668;&#x7684;&#x4EE3;&#x7801;&#x57DF;&#x7531;&#x4E00;&#x4E2A;&#x7EC8;&#x7ED3;&#x6307;&#x4EE4;&#x5206;&#x5272;&#x3002;&#x8FD9;&#x4E2A;&#x7EC8;&#x7ED3;&#x6307;&#x4EE4;&#x4F9B;IF&#x63A7;&#x5236;&#x5668;&#x5224;&#x65AD;&#x4E00;&#x4E2A;&#x5FAE;&#x6307;&#x4EE4;&#x662F;&#x5426;&#x7ED3;&#x675F;&#x3002;&#x4EE3;&#x7801;&#x57DF;&#x4E2D;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4EFB;&#x4F55;&#x4E00;&#x6761;&#x7528;&#x786C;&#x7EBF;&#x903B;&#x8F91;&#x5B9E;&#x73B0;&#x7684;&#x6307;&#x4EE4;&#xFF0C;&#x4E00;&#x65E6;&#x8FDB;&#x5165;&#x5FAE;&#x6307;&#x4EE4;&#x72B6;&#x6001;&#xFF0C;&#x5FAE;&#x6307;&#x4EE4;&#x4E2D;&#x7684;&#x8DF3;&#x8F6C;&#x6307;&#x4EE4;&#x5C06;&#x53EA;&#x4FEE;&#x6539;&#x5FAE;&#x6307;&#x4EE4;&#x8BA1;&#x6570;&#x5668;uPC&#x3002;&#x6BCF;&#x4E2A;&#x5FAE;&#x6307;&#x4EE4;&#x4EE3;&#x7801;&#x57DF;&#x7684;&#x6700;&#x540E;&#x4E00;&#x6761;&#x6307;&#x4EE4;&#xFF08;&#x7EC8;&#x6B62;&#x7B26;&#x524D;&#xFF09;&#x4E0D;&#x80FD;&#x662F;&#x8DF3;&#x8F6C;&#x6307;&#x4EE4;&#x3002;</p>
<h2 id="&#x5FAE;&#x6307;&#x4EE4;&#x5DE5;&#x4F5C;&#x8FC7;&#x7A0B;"><a href="#&#x5FAE;&#x6307;&#x4EE4;&#x5DE5;&#x4F5C;&#x8FC7;&#x7A0B;" class="headerlink" title="&#x5FAE;&#x6307;&#x4EE4;&#x5DE5;&#x4F5C;&#x8FC7;&#x7A0B;"></a>&#x5FAE;&#x6307;&#x4EE4;&#x5DE5;&#x4F5C;&#x8FC7;&#x7A0B;</h2><p>&#x5728;&#x4E0D;&#x8003;&#x8651;&#x4E2D;&#x65AD;&#x6216;&#x5F02;&#x5E38;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6574;&#x4E2A;IF&#x9636;&#x6BB5;&#x5B9E;&#x9645;&#x4E0A;&#x5206;&#x4E3A;&#x4E24;&#x4E2A;&#x4E2A;&#x72B6;&#x6001;&#xFF1A;</p>
<ol>
<li>&#x6B63;&#x5E38;&#x72B6;&#x6001;<ul>
<li>&#x8BE5;&#x72B6;&#x6001;&#x662F;&#x6307;&#x73B0;&#x5728;&#x6CA1;&#x6709;&#x5FAE;&#x6307;&#x4EE4;&#x5728;&#x6267;&#x884C;</li>
</ul>
</li>
<li>&#x4F2A;&#x6307;&#x4EE4;&#x72B6;&#x6001;<ul>
<li>&#x8BE5;&#x72B6;&#x6001;&#x6307;&#x73B0;&#x5728;&#x6B63;&#x5728;&#x6267;&#x884C;&#x5FAE;&#x6307;&#x4EE4;</li>
</ul>
</li>
</ol>
<p>&#x4E0E;&#x6B64;&#x540C;&#x65F6;&#xFF0C;&#x8FD8;&#x8981;&#x5224;&#x65AD;&#x4E24;&#x4E2A;&#x52A8;&#x4F5C;&#xFF1A;</p>
<ol>
<li>&#x6B63;&#x5E38;&#x72B6;&#x6001;&#x2013;&gt;&#x5FAE;&#x6307;&#x4EE4;&#x72B6;&#x6001;&#xFF08;enter&#xFF09;</li>
<li>&#x5FAE;&#x6307;&#x4EE4;&#x72B6;&#x6001;&#x2013;&gt;&#x6B63;&#x5E38;&#x72B6;&#x6001;&#xFF08;exit&#xFF09;</li>
</ol>
<p>IF&#x7684;&#x72B6;&#x6001;&#x7531;State Register&#x8BB0;&#x5F55;&#xFF0C;&#x52A8;&#x4F5C;&#x7531;state&#x548C;&#x6B63;&#x5728;&#x8F93;&#x5165;&#x7684;&#x6307;&#x4EE4;&#xFF08;INS_in, uINS_in&#xFF09;&#x5224;&#x65AD;&#x3002;</p>
<table>
<thead>
<tr>
<th>&#x72B6;&#x6001;&#x8F6C;&#x6362;</th>
<th>State</th>
<th>nState</th>
<th>INS_in</th>
<th>uINS_in</th>
<th>wpc</th>
<th>wupc</th>
<th>enter</th>
<th>out_sl</th>
</tr>
</thead>
<tbody><tr>
<td>n-&gt;n</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>x</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>n-&gt;u</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>x</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>u-&gt;u</td>
<td>1</td>
<td>1</td>
<td>x</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>u-&gt;n</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>u-&gt;u</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
</tbody></table>
<p>&#x4E0A;&#x8868;&#x4E2D;&#xFF0C;&#x8868;&#x5934;&#x5BF9;&#x5E94;&#x539F;&#x7406;&#x56FE;&#x4E2D;&#x7684;&#x4FE1;&#x53F7;&#x3002;state=0&#x8868;&#x793A;&#x6B63;&#x5E38;&#x72B6;&#x6001;&#xFF0C;state=1&#x8868;&#x793A;&#x8FDB;&#x5165;&#x5FAE;&#x6307;&#x4EE4;&#x72B6;&#x6001;&#x3002;nState&#x8868;&#x793A;&#x4E0B;&#x4E00;&#x4E2A;&#x72B6;&#x6001;&#x3002;INS_in=0 &#x8868;&#x793A;&#x5F53;&#x524D;&#x6307;&#x4EE4;&#x4EE5;&#x786C;&#x4EF6;&#x65B9;&#x6CD5;&#x5B9E;&#x73B0;&#xFF0C;INS_in=1 &#x8868;&#x793A;&#x5F53;&#x524D;&#x6307;&#x4EE4;&#x662F;&#x4EE5;&#x5FAE;&#x6307;&#x4EE4;&#x65B9;&#x5F0F;&#x5B9E;&#x73B0;&#x3002;uINS_in=0&#x8868;&#x793A;&#x5F53;&#x524D;&#x5FAE;&#x6307;&#x4EE4;&#x4E0D;&#x662F;&#x7ED3;&#x675F;&#x7B26;&#xFF0C;uINS_in=1&#x8868;&#x793A;&#x5F53;&#x524D;&#x5FAE;&#x6307;&#x4EE4;&#x662F;&#x7ED3;&#x675F;&#x7B26;&#x3002;wpc&#x548C;wupc&#x5206;&#x522B;&#x63A7;&#x5236;pc&#x548C;upc&#x7684;&#x5199;&#x5165;&#x4F7F;&#x80FD;&#x3002;</p>
<p>enter&#x4E3A;&#x8FDB;&#x5165;&#x5FAE;&#x6307;&#x4EE4;&#x72B6;&#x6001;&#x65F6;&#x7684;&#x6307;&#x793A;&#x4FE1;&#x53F7;&#xFF0C;&#x4E3A;&#x4E86;&#x63D0;&#x9AD8;ipc&#xFF0C;&#x4E00;&#x65E6;&#x53D1;&#x73B0;&#x4E00;&#x6761;&#x6307;&#x4EE4;&#x65F6;&#x4F7F;&#x7528;&#x5FAE;&#x6307;&#x4EE4;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x5C31;&#x5E94;&#x5F53;&#x76F4;&#x63A5;&#x8F93;&#x51FA;&#x5BF9;&#x5E94;&#x7684;&#x5FAE;&#x6307;&#x4EE4;&#xFF0C;&#x6240;&#x4EE5;&#x8FDB;&#x5165;&#x5FAE;&#x6307;&#x4EE4;&#x72B6;&#x6001;&#x9700;&#x8981;&#x989D;&#x5916;&#x5904;&#x7406;&#xFF1A;&#x5FAE;&#x6307;&#x4EE4;&#x5B58;&#x50A8;&#x5668;&#x7684;&#x5730;&#x5740;&#x76F4;&#x63A5;&#x7531;enter&#x4FE1;&#x53F7;&#x9009;&#x62E9;&#x4E3A;&#x6307;&#x4EE4;&#x4E2D;&#x7684;&#x5730;&#x5740;&#x4F4D;&#xFF0C;&#x5FAE;&#x6307;&#x4EE4;&#x5B58;&#x50A8;&#x5668;&#x8F93;&#x51FA;head&#x4E2D;&#x5BF9;&#x5E94;&#x7684;&#x8DF3;&#x8F6C;&#x6307;&#x4EE4;&#xFF0C;&#x4E0B;&#x4E2A;&#x65F6;&#x949F;&#x5468;&#x671F;&#x5230;&#x6765;&#x65F6;&#xFF0C;&#x8BE5;&#x5730;&#x5740;+4&#x653E;&#x5165;upc&#xFF0C;&#x5FAE;&#x6307;&#x4EE4;&#x72B6;&#x6001;&#x5EF6;&#x65F6;&#x69FD;&#x4ECD;&#x7136;&#x4FDD;&#x7559;&#x3002;&#x4E4B;&#x540E;&#x7684;upc&#x7531;ID&#x9636;&#x6BB5;&#x7684;upcSource&#x66F4;&#x65B0;&#x3002;</p>
<p>out_sl&#x6807;&#x5FD7;&#x8F93;&#x51FA;&#x662F;&#x5FAE;&#x6307;&#x4EE4;&#x5B58;&#x50A8;&#x5668;&#x5185;&#x7684;&#x5185;&#x5BB9;&#x8FD8;&#x662F;&#x6307;&#x4EE4;cache&#x4E2D;&#x7684;&#x5185;&#x5BB9;&#x3002;&#x5F53;&#x72B6;&#x6001;&#x53D1;&#x751F;&#x8F6C;&#x6362;&#x65F6;&#xFF0C;n-&gt;u&#x65F6;&#xFF0C;&#x82E5;&#x5C06;&#x6307;&#x4EE4;cache&#x4E2D;&#x7684;&#x6307;&#x4EE4;&#x76F4;&#x63A5;&#x4F20;&#x5165;ID&#xFF0C;ID&#x662F;&#x65E0;&#x6CD5;&#x8BC6;&#x522B;&#x7684;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x56E0;&#x4E3A;enter&#x4FE1;&#x53F7;&#x7684;&#x4F5C;&#x7528;&#xFF0C;&#x4F7F;&#x5F97;&#x8BE5;&#x6307;&#x4EE4;&#x5BF9;&#x5E94;&#x7684;&#x5FAE;&#x6307;&#x4EE4;&#x5DF2;&#x51C6;&#x5907;&#x597D;&#xFF0C;&#x6240;&#x4EE5;out_sl&#x4E3A;1&#xFF0C;&#x5373;&#x5F53;&#x5FAE;&#x6307;&#x4EE4;&#x5B9E;&#x73B0;&#x7684;&#x6307;&#x4EE4;&#x51FA;&#x73B0;&#x65F6;&#xFF0C;&#x76F4;&#x63A5;&#x4F20;&#x5165;&#x5176;&#x5BF9;&#x5E94;&#x7684;&#x5FAE;&#x6307;&#x4EE4;&#x3002;&#x540C;&#x7406;&#xFF0C;&#x5F53;u-&gt;n&#x65F6;&#xFF0C;&#x82E5;&#x5C06;&#x5FAE;&#x6307;&#x4EE4;&#x7ED3;&#x675F;&#x7B26;&#x4F20;&#x5165;ID&#xFF0C;ID&#x4E5F;&#x662F;&#x65E0;&#x6CD5;&#x8BC6;&#x522B;&#x7684;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x6025;&#x9700;&#x8981;&#x4F7F;out_sl=0&#x9009;&#x62E9;&#x8F93;&#x51FA;&#x4E0B;&#x4E00;&#x6761;&#x6307;&#x4EE4;&#x3002;&#x8FD9;&#x91CC;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x7279;&#x6B8A;&#x60C5;&#x51B5;&#xFF0C;&#x5C31;&#x662F;&#x5F53;&#x4E0B;&#x4E00;&#x4E2A;&#x8F93;&#x5165;&#x7684;&#x6307;&#x4EE4;&#x4E5F;&#x662F;&#x7531;&#x5FAE;&#x6307;&#x4EE4;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x5B9E;&#x9645;&#x4E0A;IF&#x9636;&#x6BB5;&#x518D;&#x4E00;&#x6B21;&#x8FDB;&#x5165;&#x4E86;&#x5FAE;&#x6307;&#x4EE4;&#x72B6;&#x6001;&#xFF08;reenter&#xFF09;&#xFF0C;&#x8FD9;&#x65F6;enter&#x4FE1;&#x53F7;&#x9009;&#x62E9;&#x4E86;&#x65B0;&#x7684;&#x5FAE;&#x6307;&#x4EE4;&#x5730;&#x5740;&#xFF0C;&#x5411;ID&#x7EA7;&#x8F93;&#x5165;&#x6B63;&#x786E;&#x7684;&#x6307;&#x4EE4;&#x3002;</p>
<p>&#x5173;&#x4E8E;pc&#x548C;upc&#x7684;&#x63A7;&#x5236;&#x6709;&#x4E9B;&#x590D;&#x6742;&#xFF0C;&#x7B80;&#x5355;&#x6765;&#x8BF4;&#xFF0C;&#x5C31;&#x662F;&#x6D88;&#x8017;&#x4E00;&#x6761;&#x6307;&#x4EE4;&#xFF0C;&#x5C31;&#x8981;&#x5199;&#x4E00;&#x6B21;pc&#xFF0C;&#x6D88;&#x8017;&#x4E00;&#x6761;&#x5FAE;&#x6307;&#x4EE4;&#x5C31;&#x8981;&#x5199;&#x4E00;&#x6B21;upc&#x3002;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5F53;enter&#x548C;reenter&#x7684;&#x60C5;&#x51B5;&#x53D1;&#x751F;&#x65F6;&#xFF0C;&#x7B49;&#x4E8E;&#x8BF4;&#x65E2;&#x6D88;&#x8017;&#x4E86;&#x4E00;&#x6761;&#x6307;&#x4EE4;&#xFF0C;&#x53C8;&#x6D88;&#x8017;&#x4E86;&#x4E00;&#x6761;&#x5FAE;&#x6307;&#x4EE4;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;pc&#x548C;upc&#x5747;&#x88AB;&#x5199;&#x5165;&#x3002;</p>
<p>&#x7531;&#x4E8E;&#x5EF6;&#x65F6;&#x69FD;&#x548C;&#x6D41;&#x6C34;&#x7EBF;&#x7684;&#x5B58;&#x5728;&#xFF0C;&#x4F7F;&#x5F97;&#x4E0B;&#x4E00;&#x4E2A;pc&#x548C;upc&#x7684;&#x503C;&#x7684;&#x5224;&#x65AD;&#x53D8;&#x5F97;&#x590D;&#x6742;&#x3002;&#x800C;&#x6211;&#x7684;&#x8BBE;&#x8BA1;&#x53C8;&#x5E0C;&#x671B;&#x5C3D;&#x53EF;&#x80FD;&#x5730;&#x5C06;&#x4FEE;&#x6539;&#x505C;&#x7559;&#x5728;IF&#x7EA7;&#xFF0C;&#x6240;&#x4EE5;&#x624D;&#x628A;pc&#x548C;upc&#x5730;&#x5199;&#x5165;&#x9650;&#x5236;&#x52A0;&#x5728;&#x4E86;IF&#x7EA7;&#x3002;&#x7531;&#x4E8E;ID&#x7EA7;&#x8981;&#x8BA1;&#x7B97;&#x8DF3;&#x8F6C;&#x6307;&#x4EE4;&#x7684;&#x76EE;&#x6807;&#x5730;&#x5740;&#xFF0C;&#x6240;&#x4EE5;&#x5F53;&#x524D;PC&#x6216;&#x8005;uPC&#x8981;&#x4F20;&#x5165;ID&#x7EA7;&#x3002;&#x6539;&#x8FDB;&#x7684;IF&#x7EA7;&#x4E2D;&#xFF0C;nPC&#x548C;nuPC&#x7684;&#x4E24;&#x4E2A;&#x591A;&#x8DEF;&#x590D;&#x7528;&#x5668;&#xFF0C;&#x9664;&#x4E86;+4&#x8FD9;&#x4E00;&#x9879;&#x8F93;&#x5165;&#x5206;&#x522B;&#x5BF9;&#x5E94;pc&#x548C;upc&#x81EA;&#x8EAB;&#x5916;&#xFF0C;&#x5176;&#x4F59;&#x4E09;&#x4E2A;&#x8F93;&#x5165;&#x662F;&#x76F8;&#x540C;&#x7684;&#xFF0C;&#x5747;&#x7531;ID&#x7EA7;&#x76F4;&#x63A5;&#x7ED9;&#x51FA;&#xFF0C;&#x9009;&#x62E9;&#x4FE1;&#x53F7;&#x4E5F;&#x662F;&#x76F8;&#x540C;&#x7684;&#xFF0C;&#x4E5F;&#x7531;ID&#x7EA7;&#x76F4;&#x63A5;&#x7ED9;&#x51FA;&#x3002;&#x8FD9;&#x6837;&#x505A;&#x7684;&#x597D;&#x5904;&#x662F;&#x5BF9;&#x4E8E;ID&#x7EA7;&#x4E0D;&#x9700;&#x8981;&#x505A;&#x4EFB;&#x4F55;&#x4FEE;&#x6539;&#xFF0C;&#x5C31;&#x80FD;&#x5B9E;&#x73B0;&#x5728;&#x5FAE;&#x6307;&#x4EE4;&#x72B6;&#x6001;&#x4E2D;&#x7684;&#x8DF3;&#x8F6C;&#x4FEE;&#x6539;upc&#xFF0C;&#x800C;&#x5728;&#x6B63;&#x5E38;&#x72B6;&#x6001;&#x4E0B;&#x7684;&#x8DF3;&#x8F6C;&#x6307;&#x4EE4;&#x4FEE;&#x6539;pc&#x3002;&#x8003;&#x8651;&#x4E0B;&#x9762;&#x51E0;&#x79CD;&#x60C5;&#x51B5;&#x4E2D;pc&#x548C;upc&#x7684;&#x53D8;&#x5316;&#x3002;</p>
<table>
<thead>
<tr>
<th>&#x5B58;&#x50A8;&#x5668;&#x4F4D;&#x7F6E;</th>
<th>&#x60C5;&#x51B5;&#x4E00;</th>
<th>&#x60C5;&#x51B5;&#x4E8C;</th>
<th>&#x60C5;&#x51B5;&#x4E09;</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>&#x786C;&#x4EF6;&#x5B9E;&#x73B0;&#x6307;&#x4EE4;&#xFF08;&#x975E;&#x8DF3;&#x8F6C;&#xFF09;</td>
<td>&#x8DF3;&#x8F6C;&#x6307;&#x4EE4;</td>
<td>&#x786C;&#x4EF6;&#x5B9E;&#x73B0;&#x6307;&#x4EE4;&#xFF08;&#x975E;&#x8DF3;&#x8F6C;&#xFF09;</td>
</tr>
<tr>
<td>02</td>
<td>&#x5FAE;&#x6307;&#x4EE4;&#x5B9E;&#x73B0;&#x6307;&#x4EE4;</td>
<td>&#x5FAE;&#x6307;&#x4EE4;&#x5B9E;&#x73B0;&#x6307;&#x4EE4;</td>
<td>&#x5FAE;&#x6307;&#x4EE4;&#x5B9E;&#x73B0;&#x6307;&#x4EE4;</td>
</tr>
<tr>
<td>03</td>
<td>&#x786C;&#x4EF6;&#x5B9E;&#x73B0;&#x6CBB;&#x6307;&#x4EE4;</td>
<td>&#x8DF3;&#x8F6C;&#x6307;&#x4EE4;&#x7684;&#x76EE;&#x6807;</td>
<td>&#x5FAE;&#x6307;&#x4EE4;&#x5B9E;&#x73B0;&#x6307;&#x4EE4;</td>
</tr>
</tbody></table>
<p>&#x60C5;&#x51B5;&#x4E00;&#x662F;&#x6BD4;&#x8F83;&#x6B63;&#x5E38;&#x7684;&#x60C5;&#x51B5;&#xFF0C;pc=01&#xFF0C;&#x8BE5;&#x6307;&#x4EE4;&#x662F;&#x4E00;&#x4E2A;&#x786C;&#x4EF6;&#x5B9E;&#x73B0;&#x6307;&#x4EE4;&#xFF0C;&#x6240;&#x4EE5;&#x76F4;&#x63A5;&#x8F93;&#x51FA;&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#x5411;&#x4E0B;&#x4E00;&#x7EA7;&#x8F93;&#x51FA;PC&#x3002;&#x4E0B;&#x4E00;&#x4E2A;&#x65F6;&#x949F;&#x5230;&#x6765;&#xFF0C;&#x82E5;&#x5F53;&#x524D;&#x6307;&#x4EE4;&#x662F;&#x5EF6;&#x65F6;&#x69FD;&#x4E2D;&#x7684;&#x6307;&#x4EE4;&#xFF0C;pc&#x7B49;&#x4E8E;&#x5176;&#x76EE;&#x6807;&#xFF1B;&#x82E5;&#x5F53;&#x524D;&#x6307;&#x4EE4;&#x4E0D;&#x5904;&#x4E8E;&#x5EF6;&#x65F6;&#x69FD;&#x4E2D;&#xFF0C;&#x5219;pc=pc+4&#x3002;&#x82E5;&#x8DF3;&#x8F6C;&#x7684;&#x76EE;&#x6807;&#x662F;&#x4E00;&#x6761;&#x666E;&#x901A;&#x6307;&#x4EE4;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x6BD4;&#x8F83;&#x6B63;&#x5E38;&#xFF0C;&#x4E0D;&#x6D89;&#x53CA;&#x5230;&#x72B6;&#x6001;&#x5207;&#x6362;&#xFF0C;&#x5728;&#x8FD9;&#x91CC;&#x4E0D;&#x8003;&#x8651;&#x3002;</p>
<p>&#x5F53;pc=pc+4 &#x6216;&#x8005;&#x5F53;&#x524D;&#x6307;&#x4EE4;&#x662F;&#x5EF6;&#x65F6;&#x69FD;&#x4E2D;&#x7684;&#x6307;&#x4EE4;&#xFF0C;&#x5E76;&#x4E14;&#x8DF3;&#x8F6C;&#x7684;&#x76EE;&#x6807;&#x521A;&#x597D;&#x662F;02&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#x8981;&#x53D1;&#x751F;&#x72B6;&#x6001;&#x5207;&#x6362;&#x3002;&#x6B64;&#x65F6;01&#x6307;&#x4EE4;&#x5DF2;&#x5728;ID&#x7EA7;&#xFF0C;&#x5B83;&#x4E0D;&#x662F;&#x8DF3;&#x8F6C;&#x6307;&#x4EE4;&#xFF0C;&#x6240;&#x4EE5;pc_source&#x88AB;ID&#x7EA7;&#x8BBE;&#x7F6E;&#x6210;pc+4&#x3002;&#x800C;&#x6B64;&#x65F6;&#x662F;enter&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x6240;&#x4EE5;upc&#x88AB;&#x8BBE;&#x7F6E;&#x6210;&#x6307;&#x4EE4;&#x4E2D;&#x6240;&#x77E5;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x800C;upc_source&#x548C;pc_source&#x516C;&#x7528;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#xFF0C;&#x6240;&#x4EE5;upc_source&#x4E5F;&#x88AB;&#x8BBE;&#x7F6E;&#x6210;upc+4.&#x5F53; &#x4E0B;&#x4E00;&#x4E2A;&#x65F6;&#x949F;&#x5468;&#x671F;&#x5230;&#x6765;&#x65F6;&#xFF0C;&#x7531;&#x5FAE;&#x6307;&#x4EE4;&#x5B58;&#x50A8;&#x5668;&#x6307;&#x51FA;&#x7684;&#x5FAE;&#x6307;&#x4EE4;&#x88AB;&#x9001;&#x5165;ID&#xFF0C;&#x800C;pc&#x548C;upc&#x5206;&#x522B;&#x88AB;&#x5199;&#x5165;&#x4E3A;03&#x548C;&#x5FAE;&#x6307;&#x4EE4;&#x5934;&#x90E8;&#x5EF6;&#x65F6;&#x69FD;&#x7684;&#x5730;&#x5740;&#x3002;&#x5E76;&#x4E14;IF&#x7EA7;&#x5411;ID&#x7EA7;&#x9001;&#x5165;upc&#xFF0C;&#x4F9B;&#x5FAE;&#x6307;&#x4EE4;&#x4E2D;&#x7684;&#x8DF3;&#x8F6C;&#x6307;&#x4EE4;&#x53C2;&#x8003;&#x3002;</p>
<p>&#x5F53;&#x5FAE;&#x6307;&#x4EE4;&#x6267;&#x884C;&#x7ED3;&#x675F;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;upc&#x6307;&#x5411;&#x4E86;&#x4E00;&#x4E2A;&#x7EC8;&#x6B62;&#x7B26;&#x3002;&#x8FD9;&#x65F6;&#x4E0A;&#x4E00;&#x6761;&#x6307;&#x4EE4;&#xFF08;ID&#x7EA7;&#x4E2D;&#x7684;&#x6307;&#x4EE4;&#xFF09;&#xFF0C;&#x7531;&#x4E8E;&#x4E00;&#x5B9A;&#x4E0D;&#x662F;&#x8DF3;&#x8F6C;&#x6307;&#x4EE4;&#xFF0C;&#x6240;&#x4EE5;&#x4F1A;&#x628A;pc_source&#x8BBE;&#x7F6E;&#x6210;pc+4&#xFF0C;&#x51C6;&#x5907;&#x5411;ID&#x7EA7;&#x8F93;&#x51FA;pc&#x6240;&#x6307;&#x7684;&#x6307;&#x4EE4;03&#x3002;&#x4E0B;&#x4E00;&#x4E2A;&#x65F6;&#x949F;&#x5230;&#x6765;&#xFF0C;upc+4&#xFF0C;pc+4=04&#xFF0C;&#x800C;upc&#x6307;&#x5411;&#x7ED3;&#x675F;&#x7B26;&#x7684;&#x4E0B;&#x4E00;&#x4E2A;&#x6307;&#x4EE4;&#xFF0C;&#x8131;&#x79BB;&#x7ED3;&#x675F;&#x7B26;&#x7684;&#x72B6;&#x6001;&#x3002;</p>
<p>&#x60C5;&#x51B5;&#x4E8C;&#x6BD4;&#x8F83;&#x7279;&#x6B8A;&#xFF0C;02&#x4F4D;&#x7F6E;&#x7684;&#x6307;&#x4EE4;&#x662F;&#x4E00;&#x4E2A;&#x5EF6;&#x65F6;&#x69FD;&#x3002;&#x6211;&#x4EEC;&#x8003;&#x8651;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;upc&#x548C;pc&#x5982;&#x4F55;&#x53D8;&#x5316;&#x3002;pc=01&#xFF0C;&#x8BE5;&#x6307;&#x4EE4;&#x662F;&#x4E00;&#x4E2A;&#x786C;&#x4EF6;&#x6307;&#x4EE4;&#xFF0C;&#x6240;&#x4EE5;&#x76F4;&#x63A5;&#x8F93;&#x51FA;&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#x5411;&#x4E0B;&#x4E00;&#x7EA7;&#x8F93;&#x51FA;pc&#xFF0C;&#x6B64;&#x65F6;&#x65F6;&#x949F;&#x5230;&#x6765;&#xFF0C;pc+4=02&#x6307;&#x5411;&#x5FAE;&#x6307;&#x4EE4;&#x5B9E;&#x73B0;&#x7684;&#x6307;&#x4EE4;&#x3002;&#x7531;&#x4E8E;ID&#x7EA7;&#x662F;&#x8DF3;&#x8F6C;&#x6307;&#x4EE4;&#xFF0C;&#x6240;&#x4EE5;ID&#x7EA7;&#x5C06;pc_source&#x8BBE;&#x7F6E;&#x6210;&#x54CD;&#x5E94;&#x7684;&#x8DF3;&#x8F6C;&#x76EE;&#x6807;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;03&#x3002;&#x6240;&#x4EE5;&#x65F6;&#x949F;&#x5230;&#x6765;&#x540E;&#xFF0C;pc=03&#xFF0C;upc&#x4E3A;&#x6307;&#x4EE4;&#x4E2D;&#x6240;&#x6307;&#x793A;&#x7684;&#x5730;&#x5740;+4&#x3002;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x5B9E;&#x9645;&#x4E0A;&#x548C;&#x4E0A;&#x4E00;&#x79CD;&#x60C5;&#x51B5;&#x662F;&#x7B49;&#x4EF7;&#x7684;&#xFF0C;&#x53EA;&#x662F;&#x770B;&#x8D77;&#x6765;&#x6BD4;&#x8F83;&#x7279;&#x6B8A;&#x3002;&#x5728;&#x5FAE;&#x6307;&#x4EE4;&#x6267;&#x884C;&#x7ED3;&#x675F;&#x540E;&#xFF0C;exit&#x60C5;&#x51B5;&#x4E5F;&#x540C;&#x4E0A;&#x4E00;&#x79CD;&#x60C5;&#x51B5;&#x7B49;&#x4EF7;&#x3002;</p>
<p>&#x60C5;&#x51B5;&#x4E09;&#x8003;&#x8651;&#x91CD;&#x8FDB;&#x5165;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x3002;pc=01&#x8BE5;&#x6307;&#x4EE4;&#x662F;&#x4E00;&#x4E2A;&#x6B63;&#x5E38;&#x7684;&#x6307;&#x4EE4;&#xFF0C;&#x4E0E;&#x60C5;&#x51B5;&#x4E00;&#x76F8;&#x540C;&#xFF0C;&#x5728;&#x8FD9;&#x5C31;&#x4E0D;&#x8BE6;&#x7EC6;&#x5206;&#x6790;&#x4E86;&#x3002;&#x8003;&#x8651;&#x91CD;&#x8FDB;&#x5165;&#x7684;&#x65F6;&#x523B;&#xFF0C;&#x5C06;02&#x6240;&#x4EE3;&#x8868;&#x7684;&#x5FAE;&#x6307;&#x4EE4;&#x9001;&#x5165;ID&#x65F6;&#xFF0C;pc&#x5DF2;&#x88AB;&#x8BBE;&#x7F6E;&#x4E3A;03&#xFF0C;&#x6B64;&#x65F6;02&#x4E2D;&#x7684;&#x5FAE;&#x6307;&#x4EE4;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#xFF0C;upc&#x6307;&#x5411;&#x7EC8;&#x6B62;&#x7B26;&#xFF0C;&#x7531;&#x4E8E;&#x6B64;&#x65F6;ID&#x7EA7;&#x4E00;&#x5B9A;&#x4E0D;&#x662F;&#x8DF3;&#x8F6C;&#x6307;&#x4EE4;&#xFF0C;&#x56E0;&#x6B64;pc_source&#x88AB;&#x8BBE;&#x7F6E;&#x6210;pc+4&#xFF0C;&#x7531;&#x4E8E;&#x662F;&#x91CD;&#x8FDB;&#x5165;&#xFF0C;&#x5F53;&#x65F6;&#x949F;&#x5230;&#x6765;&#x65F6;&#xFF0C;IF&#x4F1A;&#x9009;&#x51FA;03&#x6240;&#x6307;&#x7684;&#x5FAE;&#x6307;&#x4EE4;&#x4E2D;&#x7684;&#x8DF3;&#x8F6C;&#x6307;&#x4EE4;&#xFF0C;&#x5E76;&#x5C06;upc&#x8BBE;&#x7F6E;&#x4E3A;03&#x4E2D;&#x6307;&#x4EE4;&#x6240;&#x6307;&#x7684;&#x4F4D;&#x7F6E;+4&#xFF08;&#x5FAE;&#x6307;&#x4EE4;&#x5934;&#x90E8;&#x7684;&#x5EF6;&#x65F6;&#x69FD;&#xFF09;&#xFF0C;&#x540C;&#x65F6;&#x4F1A;&#x5C06;pc&#x8BBE;&#x7F6E;&#x4E3A;04.</p>
<p>&#x7531;&#x5BF9;&#x4E0A;&#x8FF0;&#x4E09;&#x79CD;&#x60C5;&#x51B5;&#x7684;&#x5206;&#x6790;&#x53EF;&#x4EE5;&#x77E5;&#x9053;&#xFF0C;&#x6211;&#x6240;&#x8BBE;&#x8BA1;&#x7684;&#x5FAE;&#x6307;&#x4EE4;&#x7CFB;&#x7EDF;&#x65F6;&#x53EF;&#x4EE5;&#x6B63;&#x5E38;&#x5DE5;&#x4F5C;&#x7684;&#x3002;&#x5BF9;&#x8FD9;&#x4E9B;&#x60C5;&#x51B5;&#x7684;&#x5206;&#x6790;&#x662F;&#x591A;&#x4F59;&#x7684;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;npc&#x548C;nupc&#x7684;&#x503C;&#x662F;&#x7531;ID&#x7EA7;&#x7684;&#x6307;&#x4EE4;&#x51B3;&#x5B9A;&#x7684;&#x3002;ID&#x7EA7;&#x662F;&#x786C;&#x4EF6;&#x6307;&#x4EE4;&#xFF0C;IF&#x6B63;&#x5728;&#x5904;&#x7406;&#x5FAE;&#x6307;&#x4EE4;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#xFF08;enter&#xFF09;upc&#x662F;&#x7279;&#x6B8A;&#x5904;&#x7406;&#x7684;&#xFF0C;&#x5E76;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;pc&#x7684;&#x66F4;&#x65B0;&#x3002;&#x540C;&#x7406;ID&#x7EA7;&#x65F6;&#x5FAE;&#x6307;&#x4EE4;&#xFF0C;IF&#x7EA7;&#x6B63;&#x5728;&#x5904;&#x7406;&#x786C;&#x4EF6;&#x6307;&#x4EE4;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;upc&#x548C;pc&#x90FD;&#x76F4;&#x63A5;&#x52A0;4&#xFF0C;upc+4&#x540E;&#x8DE8;&#x8D8A;&#x4E86;&#x7EC8;&#x7ED3;&#x7B26;&#xFF0C;&#x5176;&#x503C;&#x5728;&#x4E0B;&#x4E00;&#x6B21;&#x8FDB;&#x5165;&#x65F6;&#x5728;&#x88AB;&#x66F4;&#x65B0;&#x3002;&#x5176;&#x4F59;&#x7684;&#x60C5;&#x51B5;ID&#x7EA7;&#x65F6;&#x786C;&#x4EF6;&#x6307;&#x4EE4;&#xFF0C;IF&#x7EA7;&#x4E5F;&#x662F;&#x786C;&#x4EF6;&#x6307;&#x4EE4;&#x6216;&#x8005;ID&#x7EA7;&#x662F;&#x5FAE;&#x6307;&#x4EE4;&#xFF0C;IF&#x7EA7;&#x4E5F;&#x662F;&#x5FAE;&#x6307;&#x4EE4;&#xFF0C;&#x8FD9;&#x4E24;&#x79CD;&#x60C5;&#x51B5;&#x4E0E;&#x672A;&#x52A0;&#x5165;&#x5FAE;&#x6307;&#x4EE4;&#x7CFB;&#x7EDF;&#x7684;&#x60C5;&#x51B5;&#x76F8;&#x540C;&#xFF0C;&#x53EA;&#x662F;&#x9009;&#x62E9;&#x6027;&#x7684;&#x5BF9;pc&#x548C;upc&#x7684;&#x5199;&#x5165;&#x8FDB;&#x884C;&#x4F7F;&#x80FD;&#x63A7;&#x5236;&#x3002;</p>
<h2 id="&#x5FAE;&#x6307;&#x4EE4;&#x7CFB;&#x7EDF;&#x5BF9;&#x7CBE;&#x786E;&#x4E2D;&#x65AD;&#x7684;&#x5F71;&#x54CD;"><a href="#&#x5FAE;&#x6307;&#x4EE4;&#x7CFB;&#x7EDF;&#x5BF9;&#x7CBE;&#x786E;&#x4E2D;&#x65AD;&#x7684;&#x5F71;&#x54CD;" class="headerlink" title="&#x5FAE;&#x6307;&#x4EE4;&#x7CFB;&#x7EDF;&#x5BF9;&#x7CBE;&#x786E;&#x4E2D;&#x65AD;&#x7684;&#x5F71;&#x54CD;"></a>&#x5FAE;&#x6307;&#x4EE4;&#x7CFB;&#x7EDF;&#x5BF9;&#x7CBE;&#x786E;&#x4E2D;&#x65AD;&#x7684;&#x5F71;&#x54CD;</h2><p>&#x5728;&#x6D41;&#x6C34;&#x7EBF;&#x4E2D;&#x5B9E;&#x73B0;&#x7CBE;&#x786E;&#x4E2D;&#x65AD;&#x5E76;&#x4E0D;&#x662F;&#x4E00;&#x4EF6;&#x5BB9;&#x6613;&#x7684;&#x4E8B;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x5728;&#x6709;&#x5206;&#x652F;&#x3001;&#x6709;&#x5EF6;&#x65F6;&#x69FD;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x3002;&#x6240;&#x4EE5;&#x7B14;&#x8005;&#x4E0D;&#x6253;&#x7B97;&#x91C7;&#x7528;&#x5217;&#x4E3E;&#x5404;&#x79CD;&#x60C5;&#x51B5;&#x6765;&#x5206;&#x6790;&#x5F15;&#x5165;&#x5FAE;&#x6307;&#x4EE4;&#x5BF9;&#x7CBE;&#x786E;&#x4E2D;&#x65AD;&#x7684;&#x5F71;&#x54CD;&#xFF0C;&#x800C;&#x662F;&#x8BD5;&#x56FE;&#x4ECE;&#x66F4;&#x9AD8;&#x7684;&#x5C42;&#x9762;&#x53BB;&#x601D;&#x8003;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x4EE5;&#x5BF9;&#x7EC8;&#x7AEF;&#x7CFB;&#x7EDF;&#x8FDB;&#x884C;&#x9488;&#x5BF9;&#x6027;&#x7684;&#x4FEE;&#x6539;&#x3002;</p>
<p>&#x4E2D;&#x65AD;&#x548C;&#x5F02;&#x5E38;&#x4F1A;&#x5728;ID&#x7EA7;&#x6216;&#x8005;EXE&#x7EA7;&#x5230;&#x6765;&#x3002;ID&#x7EA7;&#x7684;&#x5F02;&#x5E38;&#xFF0C;&#x53EF;&#x4EE5;&#x662F;&#x786C;&#x4EF6;&#x4E2D;&#x65AD;&#xFF0C;&#x672A;&#x5B9E;&#x73B0;&#x7684;&#x6307;&#x4EE4;&#x6216;&#x8005;&#x662F;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;systemcall&#x3002;EXE&#x7EA7;&#x7684;&#x5F02;&#x5E38;&#x53EF;&#x4EE5;&#x662F;&#x7B97;&#x672F;&#x6307;&#x4EE4;&#x7684;&#x6EA2;&#x51FA;&#x3002;</p>
<h3 id="&#x8BE5;&#x5FAE;&#x6307;&#x4EE4;&#x7CFB;&#x7EDF;&#x5BF9;&#x539F;&#x6709;&#x7CBE;&#x786E;&#x4E2D;&#x65AD;&#x7684;&#x517C;&#x5BB9;&#x6027;&#x5206;&#x6790;"><a href="#&#x8BE5;&#x5FAE;&#x6307;&#x4EE4;&#x7CFB;&#x7EDF;&#x5BF9;&#x539F;&#x6709;&#x7CBE;&#x786E;&#x4E2D;&#x65AD;&#x7684;&#x517C;&#x5BB9;&#x6027;&#x5206;&#x6790;" class="headerlink" title="&#x8BE5;&#x5FAE;&#x6307;&#x4EE4;&#x7CFB;&#x7EDF;&#x5BF9;&#x539F;&#x6709;&#x7CBE;&#x786E;&#x4E2D;&#x65AD;&#x7684;&#x517C;&#x5BB9;&#x6027;&#x5206;&#x6790;"></a>&#x8BE5;&#x5FAE;&#x6307;&#x4EE4;&#x7CFB;&#x7EDF;&#x5BF9;&#x539F;&#x6709;&#x7CBE;&#x786E;&#x4E2D;&#x65AD;&#x7684;&#x517C;&#x5BB9;&#x6027;&#x5206;&#x6790;</h3><p>&#x5206;&#x6790;&#x5F15;&#x5165;&#x5FAE;&#x6307;&#x4EE4;&#x5BF9;&#x7CBE;&#x786E;&#x4E2D;&#x65AD;&#x7684;&#x5F71;&#x54CD;&#xFF0C;&#x8981;&#x5206;&#x6790;IF&#x9636;&#x6BB5;&#x7684;&#x53D6;&#x6307;&#x7ED3;&#x679C;&#xFF0C;&#x548C;&#x90A3;&#x4E9B;&#x56E0;&#x7D20;&#x6709;&#x5173;&#x3002;&#x5982;&#x679C;&#x4E2D;&#x65AD;&#x5230;&#x6765;&#xFF0C;&#x6240;&#x4FDD;&#x5B58;&#x7684;&#x73B0;&#x573A;&#x80FD;&#x591F;&#x5728;&#x6062;&#x590D;&#x65F6;&#x786E;&#x4FDD;&#x53D6;&#x51FA;&#x7684;&#x6307;&#x4EE4;&#x662F;&#x6B63;&#x786E;&#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x5F15;&#x5165;&#x5FAE;&#x6307;&#x4EE4;&#x5BF9;&#x4E2D;&#x65AD;&#x5C31;&#x662F;&#x517C;&#x5BB9;&#x7684;&#x3002;</p>
<p>&#x65F6;&#x949F;&#x5230;&#x6765;&#x65F6;&#xFF0C;&#x5B58;&#x5165;IR&#x7684;&#x6307;&#x4EE4;&#x4E0E;&#x4E0B;&#x9762;&#x56E0;&#x7D20;&#x6709;&#x5173;&#xFF1A;</p>
<ol>
<li>pc&#x7684;&#x503C;</li>
<li>upc&#x7684;&#x503C;</li>
<li>IF&#x7684;&#x72B6;&#x6001;state</li>
</ol>
<p>&#x521D;&#x770B;&#x4E0A;&#x4E00;&#x5F20;&#x7684;&#x771F;&#x503C;&#x8868;&#xFF0C;&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x5B58;&#x5165;IR&#x7684;&#x6307;&#x4EE4;&#x8FD8;&#x548C;&#x5F53;&#x524D;&#x6307;&#x4EE4;&#x662F;&#x5426;&#x662F;&#x786C;&#x4EF6;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x548C;&#x5F53;&#x524D;&#x5FAE;&#x6307;&#x4EE4;&#x662F;&#x5426;&#x662F;&#x7ED3;&#x675F;&#x7B26;&#x6709;&#x5173;&#x3002;&#x4F46;&#x5982;&#x679C;&#x8003;&#x8651;&#x5B58;&#x50A8;&#x5668;&#x4E2D;&#x7684;&#x5185;&#x5BB9;&#x5728;&#x662F;&#x56FA;&#x5B9A;&#x7684;&#xFF08;&#x5BF9;&#x4E8E;&#x6307;&#x4EE4;&#x548C;&#x5FAE;&#x6307;&#x4EE4;&#x800C;&#x8A00;&#xFF0C;&#x5B58;&#x50A8;&#x5668;&#x7684;&#x5185;&#x5BB9;&#x90FD;&#x662F;&#x56FA;&#x5B9A;&#x7684;&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x5F53;&#x524D;&#x6307;&#x4EE4;&#x548C;&#x5F53;&#x524D;&#x5FAE;&#x6307;&#x4EE4;&#x5747;&#x662F;&#x7531;pc&#x548C;upc&#x51B3;&#x5B9A;&#x7684;&#x3002;</p>
<p>&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x53EA;&#x8981;&#x4FDD;&#x5B58;pc&#x3001;upc&#x548C;state&#xFF0C;&#x5728;&#x6062;&#x590D;&#x65F6;&#x5C31;&#x53EF;&#x4EE5;&#x6062;&#x590D;&#x8FD9;&#x4E00;&#x4E2A;&#x65F6;&#x949F;&#x5230;&#x6765;&#x65F6;&#x6240;&#x53D6;&#x7684;&#x6307;&#x4EE4;&#x3002;</p>
<p>&#x800C;&#x7CBE;&#x786E;&#x4E2D;&#x65AD;&#x7684;&#x673A;&#x5236;&#xFF0C;&#x5C31;&#x662F;&#x6839;&#x636E;&#x53D1;&#x751F;&#x5F02;&#x5E38;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x4FDD;&#x5B58;&#x4E2D;&#x65AD;&#x8FD4;&#x56DE;&#x5730;&#x5740;&#x53D6;&#x6307;&#x65F6;&#x7684;IF&#x72B6;&#x6001;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x5BF9;&#x539F;&#x6709;&#x7EC8;&#x7AEF;&#x7CFB;&#x7EDF;&#x7684;&#x4FEE;&#x6539;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x5C06;&#x8FC7;&#x53BB;&#x53EA;&#x4FDD;&#x5B58;PC&#xFF0C;&#x6539;&#x4E3A;&#x540C;&#x65F6;&#x4FDD;&#x5B58;PC&#x3001;uPC&#x548C;state&#x5373;&#x53EF;&#x3002;</p>
<h3 id="&#x4E2D;&#x65AD;&#x5230;&#x6765;&#x5BF9;&#x53D6;&#x6307;&#x7684;&#x5F71;&#x54CD;"><a href="#&#x4E2D;&#x65AD;&#x5230;&#x6765;&#x5BF9;&#x53D6;&#x6307;&#x7684;&#x5F71;&#x54CD;" class="headerlink" title="&#x4E2D;&#x65AD;&#x5230;&#x6765;&#x5BF9;&#x53D6;&#x6307;&#x7684;&#x5F71;&#x54CD;"></a>&#x4E2D;&#x65AD;&#x5230;&#x6765;&#x5BF9;&#x53D6;&#x6307;&#x7684;&#x5F71;&#x54CD;</h3><p>&#x5982;&#x679C;&#x6CA1;&#x6709;&#x4E2D;&#x65AD;&#x673A;&#x5236;&#xFF0C;IF&#x7EA7;&#x7684;&#x72B6;&#x6001;&#x8F6C;&#x79FB;&#x5982;&#x4E0A;&#x4E00;&#x8282;&#x7684;&#x8868;&#x683C;&#x6240;&#x793A;&#x3002;&#x4F46;&#x662F;&#x4E2D;&#x65AD;&#x673A;&#x5236;&#x7684;&#x5F15;&#x5165;&#x4F7F;IF&#x7EA7;&#x53D8;&#x5F97;&#x66F4;&#x52A0;&#x590D;&#x6742;&#x3002;</p>
<p>&#x4E2D;&#x65AD;&#x76F8;&#x5F53;&#x4E8E;&#x5F3A;&#x5236;&#x8DF3;&#x8F6C;&#x5E76;&#x4FDD;&#x5B58;&#x73B0;&#x573A;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x4E2D;&#x65AD;&#x5230;&#x6765;&#x65F6;&#x5E94;&#x5F53;&#x5F3A;&#x5236;&#x66F4;&#x65B0;pc&#x7684;&#x503C;&#x3002;&#x4F46;&#x662F;IF&#x7EA7;&#x6240;&#x53D6;&#x7684;&#x4E0B;&#x4E00;&#x6761;&#x6307;&#x4EE4;&#x662F;&#x7531;&#x4E0A;&#x6587;&#x6240;&#x8BF4;&#x7684;pc,upc&#x4EE5;&#x53CA;state&#x51B3;&#x5B9A;&#x7684;&#xFF0C;&#x800C;ID&#x7ED9;&#x51FA;&#x7684;&#x4E2D;&#x65AD;&#x4FE1;&#x53F7;&#xFF0C;&#x53EA;&#x80FD;&#x6539;&#x53D8;PC_INT&#x591A;&#x8DEF;&#x5668;&#x7684;&#x9009;&#x62E9;&#x4FE1;&#x53F7;&#x3002;&#x7531;&#x6B64;&#x53EF;&#x77E5;&#xFF0C;&#x4E0A;&#x6587;&#x4E2D;&#x7684;&#x72B6;&#x6001;&#x8F6C;&#x79FB;&#x8FC7;&#x7A0B;&#xFF0C;&#x82E5;wpc&#x662F;1&#xFF0C;&#x5219;&#x4E2D;&#x65AD;&#x6765;&#x4E34;&#x65F6;&#xFF0C;pc&#x4F1A;&#x5728;&#x65F6;&#x949F;&#x5230;&#x6765;&#x65F6;&#x66F4;&#x65B0;&#x5230;&#x4E2D;&#x65AD;&#x5411;&#x91CF;&#x6240;&#x6307;&#x7684;&#x4F4D;&#x7F6E;&#x3002;</p>
<p>&#x4F46;&#x6709;&#x4E00;&#x79CD;&#x7279;&#x6B8A;&#x60C5;&#x51B5;&#xFF0C;&#x82E5;&#x6B64;&#x65F6;IF&#x7EA7;&#x5904;&#x4E8E;&#x5FAE;&#x6307;&#x4EE4;&#x72B6;&#x6001;&#xFF0C;state=1&#xFF0C;&#x5E76;&#x4E14;&#x4E0B;&#x4E00;&#x6761;&#x5FAE;&#x6307;&#x4EE4;&#x4E0D;&#x662F;&#x7EC8;&#x7ED3;&#x7B26;&#xFF0C;&#x90A3;&#x4E48;wpc=0&#xFF0C;&#x5219;pc&#x5728;&#x65F6;&#x949F;&#x5230;&#x6765;&#x65F6;&#x4E0D;&#x4F1A;&#x66F4;&#x65B0;&#x4E3A;&#x4E2D;&#x65AD;&#x5411;&#x91CF;&#x6240;&#x6307;&#x7684;&#x5730;&#x5740;&#x3002;&#x8FD9;&#x4F1A;&#x9020;&#x6210;&#x9519;&#x8BEF;&#x3002;</p>
<p>&#x518D;&#x8003;&#x8651;IF&#x7EA7;&#x7684;&#x8F93;&#x51FA;&#x3002;IF&#x7EA7;&#x8F93;&#x51FA;&#x4E5F;&#x7531;pc,upc&#x4EE5;&#x53CA;state&#x51B3;&#x5B9A;&#xFF0C;&#x5982;&#x679C;&#x53EA;&#x5BF9;pc&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#xFF0C;&#x4F7F;&#x5F97;pc&#x5728;&#x4E2D;&#x65AD;&#x6765;&#x4E34;&#x65F6;&#x5F3A;&#x5236;&#x4FEE;&#x6539;&#xFF0C;&#x4ECD;&#x7136;&#x4E0D;&#x80FD;&#x4F7F;&#x5F97;&#x4E2D;&#x65AD;&#x5411;&#x91CF;&#x6B63;&#x786E;&#x5411;ID&#x7EA7;&#x4F20;&#x9001;&#x3002;</p>
<p>&#x6240;&#x4EE5;&#x4F5C;&#x8005;&#x5728;&#x72B6;&#x6001;&#x5BC4;&#x5B58;&#x5668;&#x5411;IF&#x63A7;&#x5236;&#x5668;&#x7684;&#x8F93;&#x5165;&#x5904;&#x589E;&#x52A0;&#x4E86;&#x4E00;&#x4E2A;&#x591A;&#x8DEF;&#x5668;&#xFF0C;&#x5728;&#x4E2D;&#x65AD;&#x5230;&#x6765;&#x65F6;&#x5F3A;&#x5236;&#x8BBE;&#x7F6E;state=0&#xFF0C;&#x4F46;&#x53C8;&#x4E0D;&#x4FEE;&#x6539;state&#x5BC4;&#x5B58;&#x5668;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x8BA9;&#x539F;&#x6709;&#x7684;state&#x5BC4;&#x5B58;&#x5668;&#x5185;&#x5BB9;&#x53EF;&#x4EE5;&#x5411;&#x4E0B;&#x4F20;&#x9012;&#xFF0C;&#x4F7F;&#x4E2D;&#x65AD;&#x63A7;&#x5236;&#x7535;&#x8DEF;&#x53EF;&#x4EE5;&#x6B63;&#x786E;&#x7684;&#x4FDD;&#x5B58;&#x4E2D;&#x65AD;&#x524D;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x4E0E;&#x6B64;&#x540C;&#x65F6;&#x5236;&#x9020;enter&#x6216;&#x8005;normal&#x7684;&#x5047;&#x8C61;&#xFF0C;&#x6B63;&#x786E;&#x5904;&#x7406;&#x4E2D;&#x65AD;&#x65F6;&#x7684;&#x8DF3;&#x8F6C;&#x95EE;&#x9898;&#x3002;</p>
<h2 id="&#x5C0F;&#x7ED3;"><a href="#&#x5C0F;&#x7ED3;" class="headerlink" title="&#x5C0F;&#x7ED3;"></a>&#x5C0F;&#x7ED3;</h2><p>&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x63CF;&#x8FF0;&#x4E86;&#x8BE5;&#x81EA;&#x5236;&#x8BA1;&#x7B97;&#x673A;&#x7CFB;&#x7EDF;&#x4E2D;&#x5904;&#x7406;&#x5668;&#x4F7F;&#x5982;&#x4F55;&#x5904;&#x7406;&#x5FAE;&#x6307;&#x4EE4;&#x7684;&#x3002;&#x672C;&#x6587;&#x6240;&#x63CF;&#x8FF0;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x53EF;&#x4EE5;&#x5145;&#x5206;&#x5229;&#x7528;&#x786C;&#x7EBF;&#x903B;&#x8F91;&#x63A7;&#x5236;&#x5668;&#x7684;&#x901F;&#x5EA6;&#x4F18;&#x52BF;&#xFF0C;&#x53C8;&#x53EF;&#x4EE5;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x5B8C;&#x6574;&#x7684;&#x5FAE;&#x6307;&#x4EE4;&#x73AF;&#x5883;&#x5BF9;&#x6307;&#x4EE4;&#x96C6;&#x8FDB;&#x884C;&#x6269;&#x5145;&#x3002;&#x8BE5;&#x65B9;&#x6CD5;&#x533A;&#x522B;&#x4E8E;&#x5728;&#x5F88;&#x591A;&#x4E66;&#x4E2D;&#x8BB0;&#x8F7D;&#x7684;&#x5FAE;&#x6307;&#x4EE4;&#x5B9E;&#x73B0;&#x65B9;&#x6CD5;&#xFF0C;&#x4E0D;&#x4F7F;&#x7528;&#x5FAE;&#x6307;&#x4EE4;&#x89E3;&#x7801;&#x6765;&#x63A7;&#x5236;&#x5404;&#x4E2A;&#x529F;&#x80FD;&#x90E8;&#x4EF6;&#x5B9E;&#x73B0;&#x4E0D;&#x540C;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x800C;&#x662F;&#x76F4;&#x63A5;&#x4EE5;&#x786C;&#x4EF6;&#x5B9E;&#x73B0;&#x7684;&#x6307;&#x4EE4;&#x4F5C;&#x4E3A;&#x5FAE;&#x6307;&#x4EE4;&#x3002;&#x4E00;&#x6761;&#x7531;&#x5FAE;&#x6307;&#x4EE4;&#x5B9E;&#x73B0;&#x7684;&#x6307;&#x4EE4;&#xFF0C;&#x50CF;&#x4E00;&#x4E2A;&#x6C47;&#x7F16;&#x8BED;&#x8A00;&#x4E2D;&#x7684;&#x5B8F;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x8FD9;&#x4E2A;&#x5FAE;&#x6307;&#x4EE4;&#x6A21;&#x5757;&#xFF0C;&#x8FD9;&#x4E9B;&#x529F;&#x80FD;&#x81EA;&#x7136;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x6C47;&#x7F16;&#x8BED;&#x8A00;&#x7684;&#x5B8F;&#x6765;&#x5B9E;&#x73B0;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5FAE;&#x6307;&#x4EE4;&#x6A21;&#x5757;&#x7684;&#x610F;&#x4E49;&#x4ECD;&#x7136;&#x5B58;&#x5728;&#xFF0C;&#x7ECF;&#x8FC7;&#x7CBE;&#x5FC3;&#x8C03;&#x8BD5;&#x7684;&#x5FAE;&#x6307;&#x4EE4;&#xFF0C;&#x53EF;&#x4EE5;&#x5145;&#x5206;&#x5229;&#x7528;&#x5EF6;&#x65F6;&#x69FD;&#x3001;&#x6D41;&#x6C34;&#x7EBF;&#x51B2;&#x7A81;&#x907F;&#x514D;&#x7B49;&#x7279;&#x6027;&#x6765;&#x83B7;&#x5F97;&#x6BD4;&#x7528;&#x6237;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x5B8F;&#x66F4;&#x597D;&#x7684;&#x6027;&#x80FD;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x51CF;&#x5C11;&#x7CFB;&#x7EDF;&#x7F16;&#x7A0B;&#x65F6;&#x51FA;&#x9519;&#x7684;&#x6982;&#x7387;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x51CF;&#x5C11;&#x53EF;&#x6267;&#x884C;&#x4EE3;&#x7801;&#x7684;&#x4F53;&#x79EF;&#x3002;&#x5728;&#x67D0;&#x4E9B;&#x5FC5;&#x987B;&#x4F7F;&#x7528;&#x591A;&#x5468;&#x671F;&#x624D;&#x80FD;&#x5B9E;&#x73B0;&#x7684;&#x786C;&#x4EF6;&#x6307;&#x4EE4;&#xFF0C;&#x628A;&#x4ED6;&#x8F6C;&#x6362;&#x6210;&#x8FD9;&#x6837;&#x7684;&#x5FAE;&#x6307;&#x4EE4;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x4ED8;&#x51FA;&#x6781;&#x5C11;&#x7684;&#x786C;&#x4EF6;&#x4EE3;&#x4EF7;&#xFF0C;&#x5E76;&#x4E14;&#x5176;&#x6267;&#x884C;&#x53EF;&#x4EE5;&#x9AD8;&#x6548;&#x7684;&#x5229;&#x7528;&#x6D41;&#x6C34;&#x7EBF;&#x3002;</p>
<p>&#x8BE5;&#x7CFB;&#x7EDF;&#x5B9E;&#x73B0;&#x7684;&#x96BE;&#x70B9;&#x6709;&#x4E8C;&#xFF1A;</p>
<ol>
<li>IF&#x7EA7;&#x7684;&#x6307;&#x4EE4;&#x9009;&#x62E9;&#x8BBE;&#x8BA1;</li>
<li>IF&#x7EA7;&#x7684;&#x6307;&#x4EE4;&#x9009;&#x62E9;&#x4E0E;&#x4E2D;&#x65AD;&#x7CFB;&#x7EDF;&#x7684;&#x7ED3;&#x5408;&#x548C;&#x517C;&#x5BB9;&#x8BBE;&#x8BA1;</li>
</ol>
<p>&#x5173;&#x4E8E;&#x8BE5;&#x7CFB;&#x7EDF;&#x7684;&#x8FDB;&#x4E00;&#x6B65;&#x9A8C;&#x8BC1;&#xFF0C;&#x7B49;&#x5230;&#x5177;&#x4F53;&#x5B9E;&#x73B0;&#xFF0C;&#x4F1A;&#x7528;EDA&#x5DE5;&#x5177;&#x4EFF;&#x771F;&#x5B9E;&#x9A8C;&#xFF0C;&#x5C4A;&#x65F6;&#x7B14;&#x8005;&#x4F1A;&#x628A;&#x786C;&#x4EF6;&#x903B;&#x8F91;&#x63CF;&#x8FF0;&#x548C;&#x6D4B;&#x8BD5;&#x7528;&#x4F8B;&#x540C;&#x6B65;&#x66F4;&#x65B0;&#x5728;&#x6587;&#x7AE0;&#x4E2D;&#x3002;</p>

    
    </div>
    
    
</article>






    <script src='https://unpkg.com/mermaid@8.8.0/dist/mermaid.min.js'></script>
    <script>
      if (window.mermaid) {
        mermaid.initialize({theme: 'forest'});
      }
    </script>
  

  
    
        <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/%E8%BF%99%E5%8F%AA%E6%98%AF%E4%B8%80%E4%B8%AA%E8%87%AA%E5%88%B6%E7%B3%BB%E7%AE%97%E8%AE%A1%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A1%B9%E7%9B%AE/" itemprop="url">这只是一个自制计算机系统的项目</a>
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            
                <time datetime="2020-05-04T01:45:52.000Z" itemprop="datePublished">5月 4 2020</time>
            
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/home-brew-computer-system/">home brew computer system</a>
        </span>
        
        
        <span class="column is-narrow">
            
            
            17 分钟 read (About 2509 words)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <p>&#x8BE5;&#x9879;&#x76EE;&#x662F;&#x4E00;&#x4E2A;&#x81EA;&#x5236;<strong>&#x8BA1;&#x7B97;&#x673A;&#x7CFB;&#x7EDF;</strong>&#x7684;&#x9879;&#x76EE;&#xFF0C;&#x5176;&#x76EE;&#x6807;&#x5305;&#x62EC;cpu&#x8BBE;&#x8BA1;&#x3001;&#x5916;&#x56F4;&#x7684;&#x63A7;&#x5236;&#x5668;&#x5982;&#x5185;&#x5B58;&#x3001;cache&#x3001;IO&#x3001;&#x4E2D;&#x65AD;&#x7B49;&#x8BBE;&#x8BA1;&#x3001;&#x5916;&#x8BBE;&#x5982;&#x6253;&#x5370;&#x673A;&#x3001;&#x5B58;&#x50A8;&#x5668;&#x7B49;&#x7684;&#x8BBE;&#x8BA1;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x548C;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x79FB;&#x690D;&#x3002;&#x9879;&#x76EE;&#x672C;&#x8EAB;&#x5E76;&#x4E0D;&#x8FFD;&#x6C42;&#x6781;&#x9650;&#x6027;&#x80FD;&#xFF0C;&#x548C;&#x5B8C;&#x7F8E;&#x7684;&#x5B89;&#x5168;&#x6027;&#xFF0C;&#x53EA;&#x662F;&#x5728;&#x529B;&#x6240;&#x80FD;&#x53CA;&#x7684;&#x6761;&#x4EF6;&#x4E0B;&#x505A;&#x4E00;&#x4E9B;&#x4F18;&#x5316;&#x3002;&#x529F;&#x80FD;&#x5B8C;&#x5584;&#x3001;&#x6613;&#x4E8E;&#x6D4B;&#x8BD5;&#x548C;&#x6269;&#x5C55;&#x662F;&#x672C;&#x9879;&#x76EE;&#x7684;&#x9996;&#x8981;&#x76EE;&#x6807;&#x3002;</p>
<h3 id="&#x786C;&#x4EF6;&#x8BBE;&#x8BA1;&#x76EE;&#x6807;"><a href="#&#x786C;&#x4EF6;&#x8BBE;&#x8BA1;&#x76EE;&#x6807;" class="headerlink" title="&#x786C;&#x4EF6;&#x8BBE;&#x8BA1;&#x76EE;&#x6807;"></a>&#x786C;&#x4EF6;&#x8BBE;&#x8BA1;&#x76EE;&#x6807;</h3><p>&#x672C;&#x9879;&#x76EE;&#x6240;&#x4F7F;&#x7528;&#x7684;CPU&#x4E3A;&#x7C7B;MIPS&#x67B6;&#x6784;&#xFF0C;&#x786C;&#x7EBF;&#x903B;&#x8F91;&#x4EC5;&#x652F;&#x6301;&#x6574;&#x6570;&#x6307;&#x4EE4;&#xFF0C;&#x6CA1;&#x6709;&#x786C;&#x4EF6;&#x4E58;&#x6CD5;&#x5668;&#x3001;&#x9664;&#x6CD5;&#x5668;&#x3002;&#x5728;FPGA&#x4E2D;&#x7EFC;&#x5408;&#xFF0C;&#x4E0D;&#x4F7F;&#x7528;&#x4EFB;&#x4F55;&#x57FA;&#x4E8E;&#x5382;&#x5546;&#x7684;IP&#x3002;&#x91C7;&#x7528;5&#x7EA7;&#x6D41;&#x6C34;&#x7EBF;&#xFF0C;&#x7CBE;&#x786E;&#x4E2D;&#x65AD;&#xFF0C;&#x96C6;&#x6210;SDRAM&#x53CC;&#x7AEF;&#x53E3;&#x63A7;&#x5236;&#x5668;&#xFF0C;&#x5305;&#x542B;&#x4E00;&#x7EA7;&#x6307;&#x4EE4;&#x548C;&#x6570;&#x636E;cache&#x3002;</p>
<p>CPU&#x7684;&#x6574;&#x4F53;&#x7ED3;&#x6784;&#x4E0E;&#x674E;&#x4E9A;&#x6C11;&#x6240;&#x8457;&#x7684;&#x300A;&#x8BA1;&#x7B97;&#x673A;&#x539F;&#x7406;&#x4E0E;&#x8BBE;&#x8BA1;&#x300B;&#x4E2D;&#x7684;&#x76F8;&#x4F3C;&#xFF0C;&#x4F46;&#x8C03;&#x6574;&#x4E86;&#x4E00;&#x4E9B;&#x6307;&#x4EE4;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x5E76;&#x671F;&#x671B;&#x5F15;&#x5165;&#x5FAE;&#x4EE3;&#x7801;&#x6765;&#x589E;&#x52A0;CPU&#x7684;&#x53EF;&#x6269;&#x5C55;&#x6027;&#xFF0C;&#x964D;&#x4F4E;&#x7F16;&#x8BD1;&#x5668;&#x79FB;&#x690D;&#x548C;&#x7CFB;&#x7EDF;&#x7F16;&#x7A0B;&#x7684;&#x96BE;&#x5EA6;&#x3002;</p>
<h3 id="&#x7F16;&#x8BD1;&#x5668;&#x79FB;&#x690D;&#x76EE;&#x6807;"><a href="#&#x7F16;&#x8BD1;&#x5668;&#x79FB;&#x690D;&#x76EE;&#x6807;" class="headerlink" title="&#x7F16;&#x8BD1;&#x5668;&#x79FB;&#x690D;&#x76EE;&#x6807;"></a>&#x7F16;&#x8BD1;&#x5668;&#x79FB;&#x690D;&#x76EE;&#x6807;</h3><p>&#x672C;&#x9879;&#x76EE;&#x8BA1;&#x5212;&#x79FB;&#x690D;lcc&#x7F16;&#x8BD1;&#x5668;&#x5230;&#x8BE5;&#x5E73;&#x53F0;&#xFF0C;&#x4EE5;&#x5B9E;&#x73B0;&#x5DE5;&#x5177;&#x94FE;&#x8F6F;&#x4EF6;&#x3002;&#x7531;&#x4E8E;&#x672C;&#x9879;&#x76EE;&#x6240;&#x4F7F;&#x7528;&#x7684;CPU&#x4E0E;MIPS&#x7ED3;&#x6784;&#x76F8;&#x4F3C;&#xFF0C;&#x6240;&#x4EE5;&#x79FB;&#x690D;&#x57FA;&#x4E8E;lcc&#x7F16;&#x8BD1;&#x5668;&#x7684;MIPS&#x540E;&#x7AEF;md&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x3002;&#x7531;&#x4E8E;&#x672C;&#x9879;&#x76EE;&#x6240;&#x4F7F;&#x7528;&#x7684;CPU&#x4E0E;MIPS&#x7ED3;&#x6784;&#x4E0D;&#x5B8C;&#x5168;&#x76F8;&#x540C;&#xFF0C;&#x4FEE;&#x6539;lcc&#x7684;&#x540E;&#x7AEF;&#x7684;&#x5DE5;&#x4F5C;&#x53EF;&#x80FD;&#x5305;&#x62EC;&#xFF1A;</p>
<ul>
<li>&#x719F;&#x6089;lcc&#x7684;&#x6574;&#x4F53;&#x7ED3;&#x6784;,&#x5305;&#x62EC;&#x5176;&#x524D;&#x7AEF;&#x548C;&#x4E2D;&#x95F4;&#x4EE3;&#x7801;&#x751F;&#x6210;</li>
<li>&#x57FA;&#x4E8E;MIPS&#x540E;&#x7AEF;&#x9488;&#x5BF9;&#x8BE5;&#x5E73;&#x53F0;&#x8FDB;&#x884C;&#x79FB;&#x690D;</li>
<li>&#x8FDB;&#x884C;&#x4E00;&#x4E9B;&#x529B;&#x6240;&#x80FD;&#x53CA;&#x7684;&#x4F18;&#x5316;&#x548C;&#x6D4B;&#x8BD5;&#x5DE5;&#x4F5C;</li>
</ul>
<p>&#x7F16;&#x8BD1;&#x5668;&#x662F;&#x4E00;&#x4E2A;&#x5341;&#x5206;&#x590D;&#x6742;&#x7684;&#x7A0B;&#x5E8F;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x79FB;&#x690D;&#x5DE5;&#x4F5C;&#x53EF;&#x80FD;&#x662F;&#x6574;&#x4E2A;&#x9879;&#x76EE;&#x4E2D;&#x96BE;&#x5EA6;&#x6700;&#x5927;&#x7684;&#x90E8;&#x5206;&#x3002;</p>
<h3 id="&#x5176;&#x4ED6;&#x5DE5;&#x5177;&#x94FE;&#x8F6F;&#x4EF6;&#x7684;&#x8BBE;&#x8BA1;"><a href="#&#x5176;&#x4ED6;&#x5DE5;&#x5177;&#x94FE;&#x8F6F;&#x4EF6;&#x7684;&#x8BBE;&#x8BA1;" class="headerlink" title="&#x5176;&#x4ED6;&#x5DE5;&#x5177;&#x94FE;&#x8F6F;&#x4EF6;&#x7684;&#x8BBE;&#x8BA1;"></a>&#x5176;&#x4ED6;&#x5DE5;&#x5177;&#x94FE;&#x8F6F;&#x4EF6;&#x7684;&#x8BBE;&#x8BA1;</h3><ul>
<li>&#x5BF9;&#x4E8E;&#x8FDE;&#x63A5;&#x5668;&#xFF0C;&#x672C;&#x9879;&#x76EE;&#x8BA4;&#x4E3A;&#x5176;&#x5728;&#x9879;&#x76EE;&#x521D;&#x671F;&#x662F;&#x53EF;&#x9009;&#x7684;</li>
<li>&#x5BF9;&#x4E8E;&#x6C47;&#x7F16;&#x5668;&#xFF0C;&#x672C;&#x9879;&#x76EE;&#x62DF;&#x9009;&#x62E9;&#x4E00;&#x4E2A;&#x7EF4;&#x62A4;&#x826F;&#x597D;&#x7684;&#x5F00;&#x6E90;&#x6C47;&#x7F16;&#x5668;&#x4E3A;&#x57FA;&#x7840;&#xFF0C;&#x8FDB;&#x884C;&#x4FEE;&#x6539;</li>
<li>&#x5BF9;&#x4E8E;&#x9884;&#x5904;&#x7406;&#x5668;&#xFF0C;&#x672C;&#x9879;&#x76EE;&#x62DF;&#x76F4;&#x63A5;&#x4F7F;&#x7528;gcc&#x5DE5;&#x5177;&#x94FE;&#x7684;C&#x8BED;&#x8A00;&#x9884;&#x5904;&#x7406;&#x5668;</li>
</ul>
<h3 id="&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x79FB;&#x690D;&#x76EE;&#x6807;"><a href="#&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x79FB;&#x690D;&#x76EE;&#x6807;" class="headerlink" title="&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x79FB;&#x690D;&#x76EE;&#x6807;"></a>&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x79FB;&#x690D;&#x76EE;&#x6807;</h3><p>&#x9274;&#x4E8E;MINIX&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x6709;&#x8BE6;&#x7EC6;&#x7684;&#x8D44;&#x6599;&#xFF0C;&#x5E76;&#x4E14;&#x4EE3;&#x7801;&#x91CF;&#x5F88;&#x5C11;&#x53EA;&#x6709;&#x51E0;&#x4E07;&#x884C;&#xFF0C;&#x672C;&#x9879;&#x76EE;&#x6253;&#x7B97;&#x5728;&#x5DE5;&#x5177;&#x94FE;&#x8F6F;&#x4EF6;&#x8C03;&#x8BD5;&#x9002;&#x5F53;&#x65F6;&#xFF0C;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x79FB;&#x690D;&#x5DE5;&#x4F5C;&#xFF0C;&#x76EE;&#x6807;&#x662F;&#x5C06;MINIX&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x79FB;&#x690D;&#x5230;&#x8BE5;&#x81EA;&#x5236;&#x5E73;&#x53F0;&#x3002;&#x8FD9;&#x4E9B;&#x5DE5;&#x4F5C;&#x53EF;&#x80FD;&#x5305;&#x542B;&#xFF1A;</p>
<ul>
<li>Minix &#x6E90;&#x7801;&#x7684;&#x9605;&#x8BFB;</li>
<li>X86 &#x4FDD;&#x62A4;&#x6A21;&#x5F0F;&#x7684;&#x8003;&#x5BDF;</li>
<li>&#x5BF9;&#x4E8E;&#x8BE5;&#x81EA;&#x5236;&#x5E73;&#x53F0;&#x7684;&#x4FDD;&#x62A4;&#x6A21;&#x5F0F;&#x7684;&#x8BBE;&#x8BA1;&#x53D6;&#x820D;&#x7684;&#x601D;&#x8003;</li>
<li>&#x5728;&#x4E0D;&#x5F71;&#x54CD;&#x517C;&#x5BB9;&#x6027;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x52A0;&#x5165;&#x865A;&#x62DF;&#x5185;&#x5B58;&#xFF08;&#x6BB5;&#x5F0F;&#x6216;&#x9875;&#x5F0F;&#xFF09;</li>
<li>Minix &#x7684;&#x79FB;&#x690D;&#x5DE5;&#x4F5C;</li>
</ul>
<p>&#x4ECE;&#x76EE;&#x524D;&#x6765;&#x770B;&#xFF0C;minix&#x4E2D;&#x5E73;&#x53F0;&#x76F8;&#x5173;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x5927;&#x91CF;&#x662F;&#x5904;&#x7406;&#x4FDD;&#x62A4;&#x6A21;&#x5F0F;&#x3001;&#x4E2D;&#x65AD;&#x5411;&#x91CF;&#x7B49;&#x5185;&#x5BB9;&#xFF0C;&#x5728;&#x786C;&#x4EF6;&#x76F8;&#x5173;&#x7684;&#x8BBE;&#x8BA1;&#x4E0A;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x53D6;&#x820D;&#xFF0C;&#x4EE5;&#x7B80;&#x5316;&#x79FB;&#x690D;&#x5DE5;&#x4F5C;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x8BE5;&#x81EA;&#x5236;&#x5E73;&#x53F0;&#x7684;&#x4FDD;&#x62A4;&#x6A21;&#x5F0F;&#x7684;&#x8BBE;&#x8BA1;&#x76EE;&#x6807;&#xFF0C;&#x4E3B;&#x8981;&#x662F;&#x4E3A;&#x4E86;&#x4FDD;&#x62A4;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5185;&#x6838;&#x7684;&#x5B89;&#x5168;&#xFF0C;&#x4FDD;&#x969C;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x7A33;&#x5B9A;&#x8FD0;&#x884C;&#x3002;&#x5E76;&#x4E0D;&#x8FFD;&#x6C42;&#x5B8C;&#x7F8E;&#x7684;&#x8FDB;&#x7A0B;&#x95F4;&#x7684;&#x6570;&#x636E;&#x9694;&#x79BB;&#x3002;&#x56E0;&#x4E3A;Intel&#x7684;&#x5904;&#x7406;&#x5668;&#xFF0C;&#x82B1;&#x8D39;&#x4E86;&#x5DE8;&#x5927;&#x7684;&#x7CBE;&#x529B;&#xFF0C;&#x5B9E;&#x73B0;&#x4E86;&#x5176;&#x7CBE;&#x5999;&#x7684;&#x4FDD;&#x62A4;&#x6A21;&#x5F0F;&#xFF0C;&#x4ECD;&#x7136;&#x9003;&#x4E0D;&#x8FC7;&#x5E7D;&#x7075;&#x3001;&#x7194;&#x6BC1;&#x7B49;&#x65C1;&#x8DEF;&#x653B;&#x51FB;&#x3002;&#x6240;&#x4EE5;&#x5728;&#x4E00;&#x4E2A;&#x79D1;&#x7814;&#x6027;&#x8D28;&#x7684;&#x81EA;&#x5236;&#x5E73;&#x53F0;&#x4E0A;&#x8FFD;&#x6C42;&#x5B8C;&#x7F8E;&#x7684;&#x6570;&#x636E;&#x9694;&#x79BB;&#x662F;&#x4E0D;&#x81EA;&#x91CF;&#x529B;&#x7684;&#x884C;&#x4E3A;&#x3002;</p>
<p>Minix3 &#x5E76;&#x4E0D;&#x652F;&#x6301;&#x5206;&#x9875;&#xFF0C;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x6BB5;&#x5F0F;&#x5B58;&#x50A8;&#xFF0C;&#x8FD9;&#x9700;&#x8981;&#x5BF9;cpu&#x7684;&#x5185;&#x5B58;&#x63A7;&#x5236;&#x8FDB;&#x884C;&#x4E00;&#x4E9B;&#x4FEE;&#x6539;&#x3002;</p>
<p>&#x5E0C;&#x671B;&#x5411;CPU&#x4E2D;&#x52A0;&#x5165;&#x5FAE;&#x4EE3;&#x7801;&#xFF0C;&#x4E5F;&#x6709;&#x65B9;&#x4FBF;&#x7CFB;&#x7EDF;&#x7F16;&#x7A0B;&#x7684;&#x76EE;&#x7684;&#x3002;&#x53EF;&#x5C06;&#x5E38;&#x7528;&#x7684;&#x7CFB;&#x7EDF;&#x7F16;&#x7A0B;&#x6307;&#x4EE4;&#x5E8F;&#x5217;&#x8BBE;&#x8BA1;&#x6210;&#x82E5;&#x5E72;&#x7531;&#x5FAE;&#x6307;&#x4EE4;&#x89E3;&#x91CA;&#x7684;&#x6307;&#x4EE4;&#xFF0C;&#x5982;&#x5185;&#x5B58;&#x5757;&#x7684;&#x590D;&#x5236;&#xFF0C;&#x4E2D;&#x65AD;&#x3001;&#x5F02;&#x5E38;&#x53D1;&#x751F;&#x65F6;&#x73B0;&#x573A;&#x7684;&#x4FDD;&#x5B58;&#x3001;&#x4ECE;&#x4E2D;&#x65AD;&#x3001;&#x5F02;&#x5E38;&#x8FD4;&#x56DE;&#x65F6;&#x7684;&#x73B0;&#x573A;&#x6062;&#x590D;&#x7B49;&#x3002;</p>
<p>&#x56E0;&#x4E3A;&#x7CFB;&#x7EDF;&#x7F16;&#x7A0B;&#x8FD9;&#x4E00;&#x90E8;&#x5206;&#xFF0C;&#x5927;&#x90E8;&#x5206;&#x662F;&#x7528;&#x6C47;&#x7F16;&#x8BED;&#x8A00;&#x76F4;&#x63A5;&#x7F16;&#x5199;&#xFF0C;&#x6240;&#x4EE5;&#x7F16;&#x8BD1;&#x5668;&#x5E76;&#x4E0D;&#x80FD;&#x5E2E;&#x4E0A;&#x5FD9;&#xFF0C;&#x82E5;&#x76F4;&#x63A5;&#x5B9A;&#x4E49;&#x65B0;&#x6307;&#x4EE4;&#xFF0C;&#x53EF;&#x4EE5;&#x7B80;&#x5316;&#x8FD9;&#x90E8;&#x5206;&#x7F16;&#x7A0B;&#x7684;&#x96BE;&#x5EA6;&#xFF0C;&#x4E5F;&#x5229;&#x4E8E;&#x8C03;&#x8BD5;&#x3002;&#x800C;&#x4E14;&#x8FD9;&#x4E9B;&#x7CFB;&#x7EDF;&#x7F16;&#x7A0B;&#x6307;&#x4EE4;&#xFF0C;&#x5F80;&#x5F80;&#x4E0D;&#x662F;&#x7528;&#x6237;&#x7A0B;&#x5E8F;&#x6240;&#x4F7F;&#x7528;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x7F16;&#x8BD1;&#x5668;&#x53EF;&#x80FD;&#x6C38;&#x8FDC;&#x90FD;&#x4E0D;&#x77E5;&#x9053;&#x8FD9;&#x4E9B;&#x6307;&#x4EE4;&#x7684;&#x5B58;&#x5728;&#xFF0C;&#x6240;&#x4EE5;&#x5F15;&#x5165;&#x8FD9;&#x4E9B;&#x6307;&#x4EE4;&#x53EF;&#x80FD;&#x4E0D;&#x9700;&#x8981;&#x5BF9;&#x7F16;&#x8BD1;&#x5668;&#x7684;&#x4FEE;&#x6539;&#x3002;</p>
<h3 id="&#x53C2;&#x8003;&#x8D44;&#x6599;"><a href="#&#x53C2;&#x8003;&#x8D44;&#x6599;" class="headerlink" title="&#x53C2;&#x8003;&#x8D44;&#x6599;"></a>&#x53C2;&#x8003;&#x8D44;&#x6599;</h3><p>&#x8BE5;&#x9879;&#x76EE;&#x662F;&#x4E00;&#x4E2A;&#x957F;&#x671F;&#x9879;&#x76EE;&#xFF0C;&#x7B14;&#x8005;&#x5DF2;&#x7ECF;&#x4E3A;&#x5B9E;&#x65BD;&#x8BE5;&#x9879;&#x76EE;&#x6240;&#x9700;&#x8981;&#x7684;&#x77E5;&#x8BC6;&#x50A8;&#x5907;&#x51C6;&#x5907;&#x4E86;&#x591A;&#x5E74;&#xFF0C;&#x5E76;&#x641C;&#x96C6;&#x4E86;&#x4E00;&#x4E9B;&#x53C2;&#x8003;&#x8D44;&#x6599;&#x3002;</p>
<h4 id="&#x786C;&#x4EF6;&#x7CFB;&#x7EDF;&#x7684;&#x8BBE;&#x8BA1;"><a href="#&#x786C;&#x4EF6;&#x7CFB;&#x7EDF;&#x7684;&#x8BBE;&#x8BA1;" class="headerlink" title="&#x786C;&#x4EF6;&#x7CFB;&#x7EDF;&#x7684;&#x8BBE;&#x8BA1;"></a>&#x786C;&#x4EF6;&#x7CFB;&#x7EDF;&#x7684;&#x8BBE;&#x8BA1;</h4><ol>
<li>Verilog HDL &#x6570;&#x5B57;&#x8BBE;&#x8BA1;&#x4E0E;&#x7EFC;&#x5408;&#xFF0C; Samir Lalnitkar, &#x590F;&#x6587;&#x5B87;&#x7B49;&#x8BD1;&#x3002;</li>
<li>See MIPS Run, Dominic Sweetman. &#x8FD9;&#x672C;&#x4E66;&#x5F88;&#x597D;&#x770B;&#xFF0C;&#x89E3;&#x91CA;&#x4E86;&#x8BB8;&#x591A;&#x91CD;&#x8981;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x4F8B;&#x5982;MIPS&#x4E2D;&#x7684;&#x6307;&#x4EE4;&#x5EF6;&#x65F6;&#x69FD;&#xFF0C;&#x5185;&#x5B58;&#x7684;&#x4FDD;&#x62A4;&#x7B49;&#x3002;&#x5173;&#x4E8E;&#x8FD9;&#x672C;&#x4E66;&#x8FD8;&#x6709;&#x4E00;&#x4E9B;&#x5C0F;&#x6545;&#x4E8B;&#xFF0C;&#x4E4B;&#x524D;&#x6211;&#x4E00;&#x76F4;&#x5728;&#x8BFB;&#x8FD9;&#x672C;&#x4E66;&#xFF0C;&#x76F4;&#x5230;&#x6700;&#x8FD1;&#x6211;&#x624D;&#x53D1;&#x73B0;&#x8FD9;&#x672C;&#x4E66;&#x6709;&#x4E00;&#x672C;&#x4E2D;&#x6587;&#x8BD1;&#x672C;&#xFF0C;&#x800C;&#x4E14;&#x7FFB;&#x8BD1;&#x8D28;&#x91CF;&#x975E;&#x5E38;&#x597D;&#xFF0C;&#x6253;&#x5F00;&#x4E00;&#x770B;&#x7ADF;&#x7136;&#x662F;&#x6211;&#x81EA;&#x5DF1;&#x7684;&#x8001;&#x5E08;<strong>&#x5C48;&#x5EFA;&#x52E4;</strong>&#x7FFB;&#x8BD1;&#x7684;&#xFF0C;&#x76F8;&#x89C1;&#x6068;&#x665A;&#x5440;&#xFF01;<strong>&#x611F;&#x8C22;&#x5C48;&#x8001;&#x5E08;&#x80FD;&#x4E3A;&#x5927;&#x5BB6;&#x63D0;&#x4F9B;&#x8FD9;&#x4E48;&#x597D;&#x7684;&#x5B66;&#x4E60;&#x8D44;&#x6599;&#x7684;&#x7FFB;&#x8BD1;</strong>&#x3002;</li>
<li>Computer System Architecture, M.Morris Mano. &#x8FD9;&#x672C;&#x4E66;&#x662F;&#x5F88;&#x8001;&#x7684;&#x4E66;&#xFF0C;&#x4F46;&#x662F;&#x7B14;&#x8005;&#x662F;&#x4ECE;&#x8FD9;&#x672C;&#x4E66;&#x91CC;&#x5165;&#x95E8;&#x7684;&#x3002;&#x8FD9;&#x672C;&#x4E66;&#x662F;&#x7B14;&#x8005;&#x521A;&#x5F00;&#x59CB;&#x5B66;&#x4E60;&#x8BA1;&#x7B97;&#x673A;&#x7CFB;&#x7EDF;&#x8BBE;&#x8BA1;&#x65F6;&#xFF0C;&#x7ECF;&#x8FC7;&#x4E86;&#x5F88;&#x591A;&#x6B21;&#x8BD5;&#x9519;&#xFF0C;&#x6700;&#x7EC8;&#x9009;&#x5B9A;&#x7684;&#x4E00;&#x672C;&#x4E66;&#xFF0C;&#x5199;&#x7684;&#x975E;&#x5E38;&#x8BE6;&#x7EC6;&#x3002;&#x4E66;&#x4E2D;&#x4ECE;&#x6700;&#x57FA;&#x672C;&#x7684;&#x6570;&#x5B57;&#x903B;&#x8F91;&#x5F00;&#x59CB;&#xFF0C;&#x4E00;&#x76F4;&#x8BB2;&#x5230;&#x5916;&#x56F4;&#x7535;&#x8DEF;&#x7684;&#x8BBE;&#x8BA1;&#xFF0C;&#x6CA1;&#x6709;&#x4F7F;&#x7528;&#x4EFB;&#x4F55;&#x57FA;&#x4E8E;&#x5546;&#x4E1A;&#x8F6F;&#x4EF6;&#x7684;IP&#xFF0C;&#x800C;&#x4E14;&#x6700;&#x7EC8;&#x4E66;&#x91CC;&#x5B9E;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x5F88;&#x7B80;&#x5355;&#x7684;CPU&#x3002;</li>
<li>&#x8BA1;&#x7B97;&#x673A;&#x539F;&#x7406;&#x4E0E;&#x8BBE;&#x8BA1;,&#x674E;&#x4E9A;&#x6C11;&#x3002;&#x672C;&#x9879;&#x76EE;&#x8BBE;&#x8BA1;&#x7684;CPU&#x57FA;&#x4E8E;&#x8FD9;&#x672C;&#x4E66;&#x6240;&#x8BB0;&#x8F7D;&#x7684;&#x7C7B;MIPS CPU&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#x3002;&#x7B14;&#x8005;&#x975E;&#x5E38;&#x611F;&#x8C22;&#x8FD9;&#x672C;&#x4E66;&#x7684;&#x4F5C;&#x8005;&#xFF0C;&#x8FD9;&#x662F;&#x4E00;&#x672C;&#x4F1F;&#x5927;&#x7684;&#x8457;&#x4F5C;&#x3002;&#x8FD9;&#x672C;&#x4E66;&#x662F;&#x6211;&#x770B;&#x5230;&#x8FC7;&#x7684;&#x5BF9;&#x5904;&#x7406;&#x5668;&#x8BBE;&#x8BA1;&#x63CF;&#x8FF0;&#x6700;&#x8BE6;&#x5C3D;&#x7684;&#x8457;&#x4F5C;&#x3002;&#x5728;&#x5DE5;&#x7A0B;&#x4E0A;&#xFF0C;&#x7406;&#x8BBA;&#x548C;&#x5B9E;&#x8DF5;&#x7684;&#x5DEE;&#x8DDD;&#x4E4B;&#x5DE8;&#x5927;&#xFF0C;&#x65E0;&#x6CD5;&#x7528;&#x8BED;&#x8A00;&#x63CF;&#x8FF0;&#x3002;&#x9605;&#x8BFB;&#x8FD9;&#x672C;&#x4E66;&#xFF0C;&#x4ECE;&#x4F5C;&#x8005;&#x7CBE;&#x5999;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x586B;&#x8865;&#x7406;&#x8BBA;&#x548C;&#x5B9E;&#x8DF5;&#x4E4B;&#x95F4;&#x5DE8;&#x5927;&#x7684;&#x9E3F;&#x6C9F;&#xFF0C;&#x8FD9;&#x5BF9;&#x4E00;&#x4E2A;&#x5DE5;&#x7A0B;&#x5E08;&#x6765;&#x8BF4;&#x4F1A;&#x4EA7;&#x751F;&#x4E00;&#x79CD;&#x5DE8;&#x5927;&#x7684;&#x6EE1;&#x8DB3;&#x611F;&#x3002;</li>
<li>Fpga4Fun: <a target="_blank" rel="noopener" href="https://www.fpga4fun.com/">https://www.fpga4fun.com/</a>. &#x7B14;&#x8005;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x7F51;&#x7AD9;&#x5165;&#x95E8;FPGA&#x3002;</li>
<li>Computer Organization And Design  The Hardware/Software Interface. &#x8FD9;&#x662F;&#x4E00;&#x672C;&#x7ECF;&#x5178;&#x6559;&#x6750;&#x3002;</li>
</ol>
<h4 id="&#x8F6F;&#x4EF6;&#x7CFB;&#x7EDF;&#x7684;&#x8BBE;&#x8BA1;"><a href="#&#x8F6F;&#x4EF6;&#x7CFB;&#x7EDF;&#x7684;&#x8BBE;&#x8BA1;" class="headerlink" title="&#x8F6F;&#x4EF6;&#x7CFB;&#x7EDF;&#x7684;&#x8BBE;&#x8BA1;"></a>&#x8F6F;&#x4EF6;&#x7CFB;&#x7EDF;&#x7684;&#x8BBE;&#x8BA1;</h4><ol>
<li>Operating System Design and Implementation (the Minix Book), Andrew S. Tanenbaum. &#x8FD9;&#x672C;&#x4E66;&#x7B80;&#x76F4;&#x662F;&#x5B66;&#x4E60;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x5723;&#x7ECF;&#xFF0C;&#x5C31;&#x662F;&#x5982;&#x679C;&#x8BA4;&#x771F;&#x8BFB;&#x4EE3;&#x7801;&#x7684;&#x8BDD;&#xFF0C;&#x9700;&#x8981;&#x5927;&#x91CF;&#x7684;&#x7CBE;&#x529B;&#x3002;</li>
<li>Intel&#xAE; 64 and IA-32 Architectures Software Developer&#x2019;s Manual Volume 3A: System Programming Guide, Part 1. Minix&#x4E66;&#x4E2D;&#x7684;&#x4EE3;&#x7801;&#x662F;&#x57FA;&#x4E8E;X86&#x7684;&#xFF0C;&#x8981;&#x60F3;&#x8BFB;&#x660E;&#x767D;&#x5176;&#x5E73;&#x53F0;&#x76F8;&#x5173;&#x7684;&#x90E8;&#x5206;&#xFF0C;X86&#x7684;&#x7CFB;&#x7EDF;&#x7F16;&#x7A0B;&#x624B;&#x518C;&#x662F;&#x4E0D;&#x53EF;&#x7F3A;&#x5C11;&#x7684;&#x6750;&#x6599;&#x3002;&#x5173;&#x4E8E;X86&#x7684;&#x4FDD;&#x62A4;&#x6A21;&#x5F0F;&#xFF0C;&#x624B;&#x518C;&#x91CC;&#x6709;&#x4ECB;&#x7ECD;&#xFF0C;&#x4F46;&#x662F;&#x4ED6;&#x7684;&#x4ECB;&#x7ECD;&#x975E;&#x5E38;&#x7E41;&#x7410;&#xFF0C;&#x7B14;&#x8005;&#x4E5F;&#x662F;&#x82B1;&#x4E86;&#x5F88;&#x957F;&#x65F6;&#x95F4;&#x624D;&#x5F04;&#x660E;&#x767D;&#xFF0C;&#x6709;&#x673A;&#x4F1A;&#x7B14;&#x8005;&#x4F1A;&#x5199;&#x4E00;&#x7BC7;&#x535A;&#x6587;&#xFF0C;&#x8BE6;&#x7EC6;&#x4ECB;&#x7ECD;minix&#x5982;&#x4F55;&#x4F7F;&#x7528;X86&#x7684;&#x4FDD;&#x62A4;&#x6A21;&#x5F0F;&#x3002;</li>
<li>MOP: Minix Overdocumentation Project,<a target="_blank" rel="noopener" href="http://www.os-forum.com/minix/boot/index.php">http://www.os-forum.com/minix/boot/index.php</a>. &#x8FD9;&#x4E2A;&#x7F51;&#x7AD9;&#x7684;&#x4F5C;&#x8005;&#xFF0C;&#x82B1;&#x8D39;&#x4E86;&#x5927;&#x91CF;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x5BF9;minix&#x7684;&#x542F;&#x52A8;&#x4EE3;&#x7801;&#x8FDB;&#x884C;&#x4E86;&#x9010;&#x884C;&#x5206;&#x6790;&#x3002;&#x53EA;&#x8981;&#x5B8C;&#x6574;&#x7684;&#x9605;&#x8BFB;&#x5B8C;&#x8FD9;&#x4E2A;&#x7F51;&#x7AD9;&#xFF0C;&#x4F60;&#x5C31;&#x53EF;&#x4EE5;&#x77E5;&#x9053;&#x4E00;&#x53F0;X86 PC&#x5728;&#x6309;&#x4E0B;&#x7535;&#x6E90;&#x6309;&#x94AE;&#x540E;&#xFF0C;BIOS&#x8FD0;&#x884C;&#x7ED3;&#x675F;&#x540E;&#x5230;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x52A0;&#x8F7D;&#x4E4B;&#x95F4;&#x7684;&#x6240;&#x6709;&#x8FD0;&#x884C;&#x60C5;&#x51B5;&#x3002;&#x4F46;&#x662F;&#x8981;&#x505A;&#x597D;&#x5FC3;&#x7406;&#x51C6;&#x5907;&#xFF0C;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x5F88;&#x590D;&#x6742;&#xFF0C;&#x5E76;&#x4E14;&#x7406;&#x89E3;&#x4ED6;&#x9700;&#x8981;&#x4E86;&#x89E3;X86&#x7684;&#x4FDD;&#x62A4;&#x6A21;&#x5F0F;&#x3002;Minix&#x4E66;&#x4E2D;&#x5E76;&#x6CA1;&#x6709;&#x5BF9;&#x5176;boot monitor&#x7684;&#x4EE3;&#x7801;&#x8FDB;&#x884C;&#x6CE8;&#x91CA;&#xFF0C;&#x53EA;&#x662F;&#x5728;&#x4E66;&#x4E2D;&#x63D0;&#x4E86;&#x4E00;&#x53E5;&#xFF0C;&#x8BF4;boot monitor&#x5341;&#x5206;&#x590D;&#x6742;&#xFF0C;&#x4E0D;&#x4E9A;&#x4E8E;&#x4E00;&#x4E2A;&#x5C0F;&#x578B;&#x7684;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x3002;&#x4E8B;&#x5B9E;&#x4E0A;&#x4E5F;&#x786E;&#x5B9E;&#x5982;&#x6B64;&#xFF0C;&#x7B14;&#x8005;&#x4E0D;&#x624D;&#xFF0C;&#x5B8C;&#x6574;&#x9605;&#x8BFB;&#x8FD9;&#x4E2A;&#x7F51;&#x7AD9;&#x82B1;&#x8D39;&#x4E86;&#x4E24;&#x4E2A;&#x591A;&#x6708;&#x7684;&#x65F6;&#x95F4;&#x3002;&#x7B14;&#x8005;&#x53D1;&#x73B0;&#x8FD9;&#x4E2A;&#x7F51;&#x7AD9;&#xFF0C;&#x662F;&#x5728;&#x8BFB;minix&#x4E66;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x7531;&#x4E8E;&#x4E66;&#x4E2D;&#x5BF9;&#x5176;&#x542F;&#x52A8;&#x5668;&#x63CF;&#x8FF0;&#x7684;&#x7F3A;&#x4E4F;&#xFF0C;&#x4F7F;&#x5F97;&#x6211;&#x5BF9;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x521D;&#x59CB;&#x7684;&#x8FD0;&#x884C;&#x73AF;&#x5883;&#x6709;&#x7591;&#x60D1;&#xFF0C;&#x8FDB;&#x800C;&#x627E;&#x5230;&#x4E86;&#x8FD9;&#x4E2A;&#x7F51;&#x7AD9;&#xFF0C;&#x5B8C;&#x7F8E;&#x5730;&#x89E3;&#x7B54;&#x4E86;&#x7591;&#x60D1;&#x3002;&#x8FD9;&#x4E2A;&#x7F51;&#x7AD9;&#x7684;&#x4F5C;&#x8005;&#xFF0C;&#x5BF9;&#x7B14;&#x8005;&#x4E5F;&#x6709;&#x5F88;&#x6DF1;&#x7684;&#x5F71;&#x54CD;&#xFF0C;&#x6709;&#x65F6;&#x5019;&#x505A;&#x4E00;&#x4EF6;&#x4E8B;&#x4E0D;&#x9700;&#x8981;&#x8003;&#x8651;&#x592A;&#x591A;&#x7ED3;&#x679C;&#x3002;&#x5B66;&#x4E60;&#x672C;&#x8EAB;&#x5C31;&#x662F;&#x4E00;&#x4EF6;&#x6709;&#x610F;&#x4E49;&#x7684;&#x4E8B;&#x60C5;&#xFF0C;&#x5BF9;&#x4E8E;&#x4E2A;&#x4EBA;&#x5982;&#x6B64;&#xFF0C;&#x5BF9;&#x4E8E;&#x793E;&#x4F1A;&#x66F4;&#x662F;&#x5982;&#x6B64;&#x3002;&#x8FD9;&#x4E2A;&#x7F51;&#x7AD9;&#x4E5F;&#x662F;&#x6211;&#x51C6;&#x5907;&#x8FD9;&#x4E2A;&#x535A;&#x5BA2;&#x7684;&#x539F;&#x56E0;&#x4E4B;&#x4E00;&#xFF0C;&#x8981;&#x628A;&#x81EA;&#x5DF1;&#x7684;&#x5B66;&#x4E60;&#x8FC7;&#x7A0B;&#x793E;&#x4F1A;&#x5316;&#xFF0C;&#x53EA;&#x8981;&#x80FD;&#x6709;&#x4E00;&#x4E2A;&#x4EBA;&#x4ECE;&#x6211;&#x7684;&#x7ECF;&#x5386;&#x4E2D;&#x5F97;&#x5230;&#x5E2E;&#x52A9;&#xFF0C;&#x672C;&#x8EAB;&#x5C31;&#x662F;&#x4E00;&#x4EF6;&#x5F88;&#x6709;&#x610F;&#x4E49;&#x7684;&#x4E8B;&#x60C5;&#x3002;</li>
<li>Lcc-A Retargetable C Compiler: Design and Implementation. lcc&#x662F;&#x4E00;&#x4E2A;&#x5F88;&#x6709;&#x540D;&#x7684;&#x7F16;&#x8BD1;&#x5668;&#xFF0C;&#x5B83;&#x672C;&#x8EAB;&#x662F;&#x4E00;&#x4E2A;&#x6587;&#x672C;&#x7A0B;&#x5E8F;&#xFF0C;&#x8FD9;&#x672C;&#x4E66;&#x8BE6;&#x7EC6;&#x7684;&#x4ECB;&#x7ECD;&#x4E86;&#x5176;&#x5B9E;&#x73B0;&#x7684;&#x6BCF;&#x4E00;&#x4E2A;&#x7EC6;&#x8282;&#x3002;&#x53EA;&#x662F;&#x7B14;&#x8005;&#x6C34;&#x5E73;&#x6709;&#x9650;&#xFF0C;&#x8BFB;&#x8D77;&#x6765;&#x5341;&#x5206;&#x5403;&#x529B;&#xFF0C;&#x82B1;&#x4E86;&#x5C06;&#x8FD1;&#x56DB;&#x4E2A;&#x6708;&#x65F6;&#x95F4;&#x624D;&#x8BFB;&#x5B8C;&#xFF0C;&#x638C;&#x63E1;&#x4E86;&#x5BF9;&#x5176;&#x4FEE;&#x6539;&#x7684;&#x80FD;&#x529B;&#xFF0C;&#x4E5F;&#x6DF1;&#x5165;&#x4E86;&#x89E3;&#x4E86;ANSI C&#x6807;&#x51C6;&#x7684;&#x5B9E;&#x73B0;&#x3002;&#x503C;&#x5F97;&#x4E00;&#x63D0;&#x7684;&#x662F;&#xFF0C;&#x8FD9;&#x672C;&#x4E66;&#x6709;&#x4E00;&#x4E2D;&#x6587;&#x8BD1;&#x672C;&#xFF0C;&#x4F46;&#x662F;&#x5F88;&#x9057;&#x61BE;&#xFF0C;&#x4E0D;&#x540C;&#x7AE0;&#x8282;&#x7FFB;&#x8BD1;&#x7684;&#x8D28;&#x91CF;&#x6709;&#x5F88;&#x5927;&#x7684;&#x6CE2;&#x52A8;&#xFF0C;&#x800C;&#x4E14;&#x4E5F;&#x6709;&#x4E00;&#x4E9B;&#x7FFB;&#x8BD1;&#x4E0A;&#x7684;&#x9519;&#x8BEF;&#xFF0C;&#x5728;&#x8FD9;&#x91CC;&#x7B14;&#x8005;&#x5C31;&#x4E0D;&#x63A8;&#x8350;&#x4E86;&#x3002;</li>
</ol>

    
    </div>
    
    
</article>






    <script src='https://unpkg.com/mermaid@8.8.0/dist/mermaid.min.js'></script>
    <script>
      if (window.mermaid) {
        mermaid.initialize({theme: 'forest'});
      }
    </script>
  

  
    
    
    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2020 Thimble&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        target="_blank" rel="noopener" href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            <div class="column is-narrow">
                <div class="columns is-mobile is-multiline is-centered">
                
                    
                <a class="column is-narrow has-text-black" title="GitHub" target="_blank" rel="noopener" href="https://gpthimble.github.com">
                    
                    GitHub
                    
                </a>
                
                </div>
            </div>
            
            
<div class="column is-narrow has-text-centered">
    <div class="dropdown is-up is-right is-hoverable" style="margin-top: -0.2em;">
        <div class="dropdown-trigger">
            <button class="button is-small" aria-haspopup="true" aria-controls="dropdown-menu7">
                <span class="icon">
                    <i class="fas fa-globe"></i>
                </span>
                <span>zh-CN</span>
                <span class="icon is-small">
            <i class="fas fa-angle-down" aria-hidden="true"></i>
          </span>
            </button>
        </div>
        <div class="dropdown-menu has-text-left" role="menu">
            <div class="dropdown-content">
            
                <a href="/index.html" class="dropdown-item">
                    zh-CN
                </a>
            
                <a href="/en/index.html" class="dropdown-item">
                    English
                </a>
            
            </div>
        </div>
    </div>
</div>

        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        // plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
    moment.locale("zh-CN");
</script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        "HTML-CSS": {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
</script>

    
    
    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/js/jquery.justifiedGallery.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof($.fn.justifiedGallery) === 'function') {
                $('.justified-gallery').justifiedGallery();
            }
        });
    })(jQuery);
</script>

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <style>
        .hljs {
            position: relative;
        }

        .hljs .clipboard-btn {
            float: right;
            color: #9a9a9a;
            background: none;
            border: none;
            cursor: pointer;
        }

        .hljs .clipboard-btn:hover {
          color: #8a8a8a;
        }

        .hljs > .clipboard-btn {
            display: none;
            position: absolute;
            right: 4px;
            top: 4px;
        }

        .hljs:hover > .clipboard-btn {
            display: inline;
        }

        .hljs > figcaption > .clipboard-btn {
            margin-right: 4px;
        }
    </style>
    <script>
      $(document).ready(function () {
        $('figure.hljs').each(function(i, figure) {
          var codeId = 'code-' + i;
          var code = figure.querySelector('.code');
          var copyButton = $('<button>Copy <i class="far fa-clipboard"></i></button>');
          code.id = codeId;
          copyButton.addClass('clipboard-btn');
          copyButton.attr('data-clipboard-target-id', codeId);

          var figcaption = figure.querySelector('figcaption');

          if (figcaption) {
            figcaption.append(copyButton[0]);
          } else {
            figure.prepend(copyButton[0]);
          }
        })

        var clipboard = new ClipboardJS('.clipboard-btn', {
          target: function(trigger) {
            return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
          }
        });
        clipboard.on('success', function(e) {
          e.clearSelection();
        })
      })
    </script>

    
    

    



<script src="/js/script.js"></script>


    
    <div class="searchbox ins-search">
    <div class="searchbox-mask"></div>
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>

<script src="/js/insight.js"></script>

    
</body>
</html>